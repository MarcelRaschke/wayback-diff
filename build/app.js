function t(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(){return e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},e.apply(null,arguments)}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a,i,s,o={exports:{}},c={};function l(){if(i)return a;i=1;var t=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;return a=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(r,a){for(var i,s,o=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(r),c=1;c<arguments.length;c++){for(var l in i=Object(arguments[c]))e.call(i,l)&&(o[l]=i[l]);if(t){s=t(i);for(var u=0;u<s.length;u++)n.call(i,s[u])&&(o[s[u]]=i[s[u]])}}return o},a}
/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */o.exports=function(){if(s)return c;s=1;var t=l(),e=60103,n=60106;c.Fragment=60107,c.StrictMode=60108,c.Profiler=60114;var r=60109,a=60110,i=60112;c.Suspense=60113;var o=60115,u=60116;if("function"==typeof Symbol&&Symbol.for){var h=Symbol.for;e=h("react.element"),n=h("react.portal"),c.Fragment=h("react.fragment"),c.StrictMode=h("react.strict_mode"),c.Profiler=h("react.profiler"),r=h("react.provider"),a=h("react.context"),i=h("react.forward_ref"),c.Suspense=h("react.suspense"),o=h("react.memo"),u=h("react.lazy")}var f="function"==typeof Symbol&&Symbol.iterator;function p(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function g(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||d}function v(){}function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||d}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(p(85));this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=g.prototype;var _=y.prototype=new v;_.constructor=y,t(_,g.prototype),_.isPureReactComponent=!0;var b={current:null},w=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function E(t,n,r){var a,i={},s=null,o=null;if(null!=n)for(a in void 0!==n.ref&&(o=n.ref),void 0!==n.key&&(s=""+n.key),n)w.call(n,a)&&!x.hasOwnProperty(a)&&(i[a]=n[a]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(a in c=t.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:e,type:t,key:s,ref:o,props:i,_owner:b.current}}function S(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}var C=/\/+/g;function j(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function T(t,r,a,i,s){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var c=!1;if(null===t)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case e:case n:c=!0}}if(c)return s=s(c=t),t=""===i?"."+j(c,0):i,Array.isArray(s)?(a="",null!=t&&(a=t.replace(C,"$&/")+"/"),T(s,r,a,"",(function(t){return t}))):null!=s&&(S(s)&&(s=function(t,n){return{$$typeof:e,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}(s,a+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+t)),r.push(s)),1;if(c=0,i=""===i?".":i+":",Array.isArray(t))for(var l=0;l<t.length;l++){var u=i+j(o=t[l],l);c+=T(o,r,a,u,s)}else if(u=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"==typeof u)for(t=u.call(t),l=0;!(o=t.next()).done;)c+=T(o=o.value,r,a,u=i+j(o,l++),s);else if("object"===o)throw r=""+t,Error(p(31,"[object Object]"===r?"object with keys {"+Object.keys(t).join(", ")+"}":r));return c}function D(t,e,n){if(null==t)return t;var r=[],a=0;return T(t,r,"","",(function(t){return e.call(n,t,a++)})),r}function A(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var N={current:null};function O(){var t=N.current;if(null===t)throw Error(p(321));return t}var k={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:t};return c.Children={map:D,forEach:function(t,e,n){D(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return D(t,(function(){e++})),e},toArray:function(t){return D(t,(function(t){return t}))||[]},only:function(t){if(!S(t))throw Error(p(143));return t}},c.Component=g,c.PureComponent=y,c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,c.cloneElement=function(n,r,a){if(null==n)throw Error(p(267,n));var i=t({},n.props),s=n.key,o=n.ref,c=n._owner;if(null!=r){if(void 0!==r.ref&&(o=r.ref,c=b.current),void 0!==r.key&&(s=""+r.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(u in r)w.call(r,u)&&!x.hasOwnProperty(u)&&(i[u]=void 0===r[u]&&void 0!==l?l[u]:r[u])}var u=arguments.length-2;if(1===u)i.children=a;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];i.children=l}return{$$typeof:e,type:n.type,key:s,ref:o,props:i,_owner:c}},c.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:a,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:r,_context:t},t.Consumer=t},c.createElement=E,c.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},c.createRef=function(){return{current:null}},c.forwardRef=function(t){return{$$typeof:i,render:t}},c.isValidElement=S,c.lazy=function(t){return{$$typeof:u,_payload:{_status:-1,_result:t},_init:A}},c.memo=function(t,e){return{$$typeof:o,type:t,compare:void 0===e?null:e}},c.useCallback=function(t,e){return O().useCallback(t,e)},c.useContext=function(t,e){return O().useContext(t,e)},c.useDebugValue=function(){},c.useEffect=function(t,e){return O().useEffect(t,e)},c.useImperativeHandle=function(t,e,n){return O().useImperativeHandle(t,e,n)},c.useLayoutEffect=function(t,e){return O().useLayoutEffect(t,e)},c.useMemo=function(t,e){return O().useMemo(t,e)},c.useReducer=function(t,e,n){return O().useReducer(t,e,n)},c.useRef=function(t){return O().useRef(t)},c.useState=function(t){return O().useState(t)},c.version="17.0.2",c}();var u,h,f,p,d=o.exports,m=r(d),g={exports:{}};g.exports=function(){if(p)return f;p=1;var t=h?u:(h=1,u="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");function e(){}function n(){}return n.resetWarningCache=e,f=function(){function r(e,n,r,a,i,s){if(s!==t){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function a(){return r}r.isRequired=r;var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:e};return i.PropTypes=i,i}}()();var v=r(g.exports);function y(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}y(".inline-render,.side-by-side-render{display:flex;flex:1 0 auto}.inline-render>iframe,.side-by-side-render>div,.side-by-side-render>iframe{border:1px solid #ccc;border-radius:2px;width:100%}.side-by-side-render>iframe:first-of-type{margin-right:.5em}.diff-view__alert.alert.alert-warning{text-align:center}.loading{align-items:center;background:#0000;display:flex;justify-content:center}");const _={genericType:"*/*",mediaType:"*/*",type:"*",subType:"*",equals(t){return!!t&&this.mediaType===t.mediaType}};b("text","html");function b(t,e){return t=t||"*",e=e||"*",Object.assign(Object.create(_),{genericType:"".concat(t,"/*"),mediaType:"".concat(t,"/").concat(e||"*"),type:t,subtype:e})}b("application","pdf"),b("application","wsdl+xml"),b("application","xml"),b("text","*"),b("text","calendar"),b("text","plain"),b("application","rss+xml"),b("image","jpeg"),b("application","x-tgif"),b("application","msword"),b("application","zip"),b("application","atom+xml"),b("application","excel"),b("application","powerpoint"),b("image","gif"),b("application","rtf"),b("text","csv"),b("application","vnd.ms-excel"),b("application","vnd.openxmlformats-officedocument.spreadsheetml.sheet"),b("image","png"),b("application","vnd.openxmlformats-officedocument.wordprocessingml.document"),b("image","jpeg"),b("audio","mpeg"),b("application","postscript");const w={RAW_FROM_CONTENT:{description:"“From” Version"},RAW_TO_CONTENT:{description:"“To” Version"},RAW_SIDE_BY_SIDE:{description:"Side-by-side Content"},HIGHLIGHTED_TEXT:{description:"Highlighted Text",diffService:"html_text_dmp"},HIGHLIGHTED_SOURCE:{description:"Highlighted Source",diffService:"html_source_dmp"},HIGHLIGHTED_RENDERED:{description:"Highlighted Rendered",diffService:"html_token"},SIDE_BY_SIDE_RENDERED:{description:"Side-by-Side Rendered",diffService:"html_token",options:{include:"all"}},OUTGOING_LINKS:{description:"Outgoing Links",diffService:"links"},CHANGES_ONLY_TEXT:{description:"Changes Only Text",diffService:"html_text_dmp"},CHANGES_ONLY_SOURCE:{description:"Changes Only Source",diffService:"html_source_dmp"}};for(const t in w)w[t].value=t;class x extends m.Component{render(){const{data:t,onSelect:e}=this.props,n={};let r="unchanged";const[a,i]=t;return-1===a?(r="removed",n.background="#ffc0cb"):1===a&&(r="added",n.background="#90ee90"),m.createElement("span",{className:"diff item ".concat(r),style:n,onClick:e},i)}}t(x,"propTypes",{data:v.object,onSelect:v.func});class E extends m.Component{render(){const{data:t,onSelectItem:e,className:n}=this.props,r=(t,e,n)=>()=>{t&&t(n,e)},a=t.map(((t,n)=>m.createElement(this.props.component,{data:t,key:n,index:n,onSelect:r(e,t,n)})));return m.createElement("div",{className:n},a)}}t(E,"propTypes",{data:v.object,onSelectItem:v.func,className:v.string});class S extends m.Component{render(){return m.createElement(E,{data:this.props.diffData.diff,component:x,className:this.props.className})}}t(S,"propTypes",{diffData:v.object,className:v.string});var C=r((function(t){return null==t}));class j extends m.Component{render(){return m.createElement("span",null,"Loading...")}}class T extends m.PureComponent{constructor(t){super(t),this.state={loaderStyle:null}}render(){const t=()=>C(this.props.loader)?m.createElement(j,null):this.props.loader;return m.createElement("div",{style:this.state.loaderStyle},this.state.loaderStyle&&m.createElement(t,null))}setLoaderStyle(t){this.setState({loaderStyle:t})}}t(T,"propTypes",{loader:v.object});class D extends m.PureComponent{constructor(t){super(t),this.loaderRef=m.createRef(),this._frame=null}componentDidMount(){this._updateContent(),this.addLoaderImg()}componentDidUpdate(){this._updateContent()}render(){return m.createElement("div",null,m.createElement("iframe",{height:window.innerHeight,width:"100%",onLoad:()=>{this.handleHeight(),this.removeLoaderImg()},sandbox:"allow-same-origin allow-forms allow-scripts",ref:t=>{this._frame=t}}),m.createElement(T,{ref:this.loaderRef,loader:this.props.loader}))}_updateContent(){const t=function(t,e){let n=(new DOMParser).parseFromString(t,"text/html");return n=e(n),"<!doctype html>\n".concat(n.documentElement.outerHTML)}(this.props.html,(t=>(this.props.transform&&(t=this.props.transform(t)||t),function(t,e){if(e){const n=t.querySelector("base")||t.createElement("base");n.href=e;const r=t.querySelector("meta[charset]");let a=t.head.firstChild;r&&(a=r.nextSibling),a?a.parentNode.insertBefore(n,a):t.head.appendChild(n)}return t}(t,this.props.baseUrl))));this._frame.setAttribute("srcdoc",t)}handleHeight(){const t=this._frame.contentDocument.documentElement.scrollHeight;t>.1*this._frame.height?this._frame.height=t+.01*t:this._frame.height=.5*this._frame.height}removeLoaderImg(){this.loaderRef.current.setLoaderStyle(null)}addLoaderImg(){const t=this._frame.contentDocument.scrollingElement.offsetWidth,e=this._frame.offsetLeft+t/2;this.loaderRef.current.setLoaderStyle({position:"absolute",left:e+"px",top:"50%"})}}t(D,"propTypes",{loader:v.object,html:v.string,transform:v.func,baseUrl:v.string});class A extends m.Component{render(){const t=this.props.diffData.combined||this.props.diffData.diff;return m.createElement("div",{className:"inline-render"},m.createElement(D,{html:t,baseUrl:this.props.page.url}))}}t(A,"propTypes",{diffData:v.object,page:v.object});const N=M.bind(null,"removals"),O=M.bind(null,"additions");class k extends m.Component{render(){let t=t=>t,e=t;return this.props.diffData.deletions||(t=N,e=O),m.createElement("div",{className:"side-by-side-render"},m.createElement(D,{loader:this.props.loader,html:this.props.diffData.deletions||this.props.diffData.diff,baseUrl:this.props.page.url,transform:t}),m.createElement(D,{loader:this.props.loader,html:this.props.diffData.insertions||this.props.diffData.diff,baseUrl:this.props.page.url,transform:e}))}}function M(t,e){if("additions"!==t){const t=e.getElementById("wm-diff-old-head").content,n=e.getElementById("wm-diff-style"),r=e.querySelector('meta[name="wm-diff-title"]');e.head.innerHTML="",e.head.appendChild(t),e.head.appendChild(n),e.head.appendChild(r)}return function(t,e){function n(t){if(0===t.size)return;const e=new Set;return t.forEach((t=>{t.parentNode&&0===t.childElementCount&&/^[\s\n\r]*$/.test(t.textContent)&&(e.add(t.parentNode),t.parentNode.removeChild(t))})),n(e)}const r=new Set;e.querySelectorAll(t).forEach((t=>{r.add(t.parentNode),t.parentNode.removeChild(t)})),n(r)}("additions"===t?"del":"ins",e),function(t,e){if("additions"===t)return;e.querySelectorAll(".wm-diff-inserted-active").forEach((t=>t.remove())),e.querySelectorAll(".wm-diff-deleted-inert").forEach((t=>{const e=t.content;t.parentNode.insertBefore(e,t),t.remove()}))}(t,e),e}t(k,"propTypes",{diffData:v.object,page:v.object,loader:v.object});const R=300;class I extends m.Component{render(){const t=this.props.diffData.diff.reduce(P,[]);return m.createElement(E,{data:t,component:x,className:this.props.className})}}function P(t,e,n,r){const[a,i]=e;if(0!==a)return t.concat([e]);const s=i.split("\n"),o=1===s.length;if(!o&&s.length<=3)return t.concat([e]);const c=r[n-1]&&0!==r[n-1][0],l=r[n+1]&&0!==r[n+1][0];let u=o?R:3;if(c&&l&&(u*=2),(o?s[0]:s).length<=u)return t.concat([e]);const h=[];if(c){const t=[];if(o)t.push(s[0].slice(0,R));else{const e=s.slice(0,3).map((t=>t.length>R?t.slice(0,R)+"…":t));t.push(e.join("\n")+"\n")}h.push([a,t.join("")])}if(h.push([a,"…"]),l){const t=[];if(o)t.push(s[0].slice(-300));else{const e=s.slice(0,3).map(((t,e,n)=>t.length>R?null==n[e+1]?"…"+t.slice(-300):t.slice(0,R)+"…":t));t.push("\n"+e.join("\n"))}h.push([a,t.join("")])}return t.concat(h)}t(I,"propTypes",{diffData:v.object,className:v.string});class L extends m.Component{render(){return this.props.content&&/^[\s\n\r]*</.test(this.props.content)?m.createElement("div",{className:"inline-render"},m.createElement(D,{html:this.props.content,baseUrl:this.props.page.url})):m.createElement("div",{className:"inline-render"},m.createElement("iframe",{src:this.props.version}))}}t(L,"propTypes",{content:v.string,page:v.object,version:v.string});class $ extends m.Component{render(){return m.createElement("div",{className:"side-by-side-render"},H(this.props.page,this.props.a,this.props.diffData.rawA),H(this.props.page,this.props.b,this.props.diffData.rawB))}}function H(t,e,n){return n&&/^[\s\n\r]*</.test(n)?m.createElement(D,{html:n,baseUrl:t.url}):m.createElement("iframe",{src:e})}t($,"propTypes",{page:v.object,diffData:v.object,a:v.string,b:v.string});var U="object"==typeof n&&n&&n.Object===Object&&n,B=U,F="object"==typeof self&&self&&self.Object===Object&&self,z=B||F||Function("return this")(),q=z.Symbol,Y=q,V=Object.prototype,W=V.hasOwnProperty,G=V.toString,X=Y?Y.toStringTag:void 0;var J=function(t){var e=W.call(t,X),n=t[X];try{t[X]=void 0;var r=!0}catch(t){}var a=G.call(t);return r&&(e?t[X]=n:delete t[X]),a},K=Object.prototype.toString;var Z=J,Q=function(t){return K.call(t)},tt=q?q.toStringTag:void 0;var et=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":tt&&tt in Object(t)?Z(t):Q(t)};var nt=function(t){return null!=t&&"object"==typeof t},rt=et,at=nt;var it=function(t){return"symbol"==typeof t||at(t)&&"[object Symbol]"==rt(t)},st=it;var ot=function(t,e,n){for(var r=-1,a=t.length;++r<a;){var i=t[r],s=e(i);if(null!=s&&(void 0===o?s==s&&!st(s):n(s,o)))var o=s,c=i}return c};var ct=function(t){return t},lt=ot,ut=function(t,e){return t>e},ht=ct;var ft=function(t){return t&&t.length?lt(t,ht,ut):void 0},pt=r(ft);var dt=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},mt=Math.max;var gt=function(t,e,n){return e=mt(void 0===e?t.length-1:e,0),function(){for(var r=arguments,a=-1,i=mt(r.length-e,0),s=Array(i);++a<i;)s[a]=r[e+a];a=-1;for(var o=Array(e+1);++a<e;)o[a]=r[a];return o[e]=n(s),dt(t,this,o)}};var vt=function(t){return function(){return t}};var yt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},_t=et,bt=yt;var wt,xt=function(t){if(!bt(t))return!1;var e=_t(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Et=z["__core-js_shared__"],St=(wt=/[^.]+$/.exec(Et&&Et.keys&&Et.keys.IE_PROTO||""))?"Symbol(src)_1."+wt:"";var Ct=function(t){return!!St&&St in t},jt=Function.prototype.toString;var Tt=function(t){if(null!=t){try{return jt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Dt=xt,At=Ct,Nt=yt,Ot=Tt,kt=/^\[object .+?Constructor\]$/,Mt=Function.prototype,Rt=Object.prototype,It=Mt.toString,Pt=Rt.hasOwnProperty,Lt=RegExp("^"+It.call(Pt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var $t=function(t){return!(!Nt(t)||At(t))&&(Dt(t)?Lt:kt).test(Ot(t))},Ht=function(t,e){return null==t?void 0:t[e]};var Ut=function(t,e){var n=Ht(t,e);return $t(n)?n:void 0},Bt=Ut,Ft=function(){try{var t=Bt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),zt=vt,qt=Ft,Yt=qt?function(t,e){return qt(t,"toString",{configurable:!0,enumerable:!1,value:zt(e),writable:!0})}:ct,Vt=Date.now;var Wt=function(t){var e=0,n=0;return function(){var r=Vt(),a=16-(r-n);if(n=r,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}},Gt=Wt(Yt),Xt=ct,Jt=gt,Kt=Gt;var Zt=function(t,e){return Kt(Jt(t,e,Xt),t+"")};var Qt=function(t,e){for(var n=-1,r=null==t?0:t.length,a=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[a++]=s)}return i};var te=function(t,e){for(var n=-1,r=null==t?0:t.length,a=Array(r);++n<r;)a[n]=e(t[n],n,t);return a};var ee=function(t){return function(e){return null==e?void 0:e[t]}};var ne=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var re=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},ae=xt,ie=re;var se=function(t){return null!=t&&ie(t.length)&&!ae(t)},oe=se,ce=nt;var le=Qt,ue=te,he=ee,fe=ne,pe=function(t){return ce(t)&&oe(t)},de=Math.max;var me=function(t){if(!t||!t.length)return[];var e=0;return t=le(t,(function(t){if(pe(t))return e=de(t.length,e),!0})),fe(e,(function(e){return ue(t,he(e))}))},ge=r(Zt(me));function ve(t,e){if(Number.isInteger(t)&&Number.isInteger(e))return ye(t^e)/32;const n=8*atob(t).length,r=8*atob(e).length,a=pt([n,r]),i=function(t,e){return ge(t,e).map((t=>{let[e,n]=t;return ye(e^n)})).reduce(((t,e)=>t+e),0)}(je(t),je(e));return i/a}function ye(t){let e=0;for(;0!==t;)e++,t&=t-1;return e}function _e(t){if(t){if(!t.ok)throw Error(t.status);return t}}function be(t){if(t){if(!t.ok)throw Error(t.status);return t.json()}}function we(t,e){return new Promise((function(n,r){setTimeout((function(){r(new Error("timeout"))}),45e3),fetch(t,e).then(n,r)}))}function xe(t){return"string"==typeof t?t:t>9?""+t:"0"+t}function Ee(t,e){return Object.keys(t).find((n=>t[n]===e))}function Se(t){const e=parseInt(t.substring(0,4),10),n=parseInt(t.substring(4,6),10)-1,r=parseInt(t.substring(6,8),10),a=parseInt(t.substring(8,10),10),i=parseInt(t.substring(10,12),10),s=parseInt(t.substring(12,14),10);return new Date(Date.UTC(e,n,r,a,i,s)).toUTCString()}function Ce(t){const e=parseInt(t.substring(0,4),10),n=parseInt(t.substring(4,6),10)-1,r=parseInt(t.substring(6,8),10);return new Date(Date.UTC(e,n,r)).toUTCString().split(" ").slice(0,4).join(" ")}function je(t){const e=atob(t);return Uint8Array.from(e,(t=>t.charCodeAt(0)))}class Te extends m.Component{constructor(e){super(e),t(this,"isMountedNow",!1),this._abortController=new window.AbortController,this.state={diffData:null}}componentDidMount(){this.isMountedNow=!0;const{props:t}=this;this._canFetch(t)&&this._loadDiffData(t.page,t.a,t.b,t.diffType)}componentWillUnmount(){this.isMountedNow=!1,this._abortController.abort()}componentDidUpdate(t){const{props:e}=this;this._canFetch(e)&&!this._propsSpecifySameDiff(e,t)&&this._loadDiffData(e.page,e.a,e.b,e.diffType)}render(){if(!this.state.diffData){const t=()=>C(this.props.loader)?m.createElement(j,null):this.props.loader;return m.createElement("div",{className:"loading"},m.createElement(t,null))}return m.createElement("div",{className:"diff-view"},this.renderNoChangeMessage()||this.renderUndiffableMessage(),this.renderDiff())}renderNoChangeMessage(){return 0===this.state.diffData.change_count?m.createElement("div",{className:"diff-view__alert alert alert-warning"},"There were ",m.createElement("strong",null,"no changes for this diff type"),". (Other diff types may show changes.)"):null}renderUndiffableMessage(){return this.state.diffData.raw?m.createElement("div",{className:"diff-view__alert alert alert-info"},"We can’t compare the selected versions of page; you are viewing the content without deletions and insertions highlighted."):null}renderDiff(){switch(this.props.diffType){case w.RAW_SIDE_BY_SIDE.value:return m.createElement($,{page:this.props.page,a:this.props.a,b:this.props.b,diffData:this.state.diffData});case w.RAW_FROM_CONTENT.value:return m.createElement(L,{page:this.props.page,version:this.props.a,content:this.state.diffData.rawA});case w.RAW_TO_CONTENT.value:return m.createElement(L,{page:this.props.page,version:this.props.b,content:this.state.diffData.rawB});case w.HIGHLIGHTED_RENDERED.value:return m.createElement(A,{diffData:this.state.diffData,page:this.props.page});case w.SIDE_BY_SIDE_RENDERED.value:return m.createElement(k,{diffData:this.state.diffData,page:this.props.page,loader:this.props.loader});case w.OUTGOING_LINKS.value:return m.createElement(A,{diffData:this.state.diffData,page:this.props.page});case w.HIGHLIGHTED_TEXT.value:return m.createElement(S,{diffData:this.state.diffData,className:"diff-text-inline"});case w.HIGHLIGHTED_SOURCE.value:return m.createElement(S,{diffData:this.state.diffData,className:"diff-source-inline"});case w.CHANGES_ONLY_TEXT.value:return m.createElement(I,{diffData:this.state.diffData,className:"diff-text-inline"});case w.CHANGES_ONLY_SOURCE.value:return m.createElement(I,{diffData:this.state.diffData,className:"diff-source-inline"});default:return null}}_propsSpecifySameDiff(t,e){return(e=e||this.props).a===t.a&&e.b===t.b&&e.diffType===t.diffType}_canFetch(t){return t.diffType&&t.a&&t.b}_loadDiffData(t,e,n,r){if(this.setState({diffData:null}),!w[r].diffService)return Promise.all([we(e.uri,{mode:"cors"}),we(n.uri,{mode:"cors"})]).then((t=>{let[e,n]=t;return{raw:!0,rawA:e,rawB:n}})).catch((t=>t)).then((t=>this.setState({diffData:t})));const a=new URL(this.props.webMonitoringProcessingURL+"/"+w[r].diffService);a.searchParams.append("strict_urls","WBM"),a.searchParams.append("format","json"),a.searchParams.append("pass_headers","cookie"),a.searchParams.append("include","all"),a.searchParams.append("a",e),a.searchParams.append("b",n),we(a,{credentials:"include"}).then(_e).then((t=>t.json())).then((t=>{this.setState({diffData:t})})).catch((t=>{this._errorHandled(t.message)}))}_errorHandled(t){this.isMountedNow&&(this.props.errorHandledCallback(t),this.setState({showError:!0}))}}t(Te,"propTypes",{a:v.object,b:v.object,diffType:v.string,loader:v.object,webMonitoringProcessingURL:v.string,errorHandledCallback:v.func,page:v.object});y("#diff-select{margin-bottom:.7em}.timestamp-container-view{align-items:center;display:flex;justify-content:space-between}#diff-footer{text-align:center}yellow-diff-footer{background-color:#f7f417}blue-diff-footer{background-color:#1d9efd}.align-items-center>.col-auto{margin-left:auto;margin-right:auto}#year-select-left,#year-select-right,.month-select,.timestamp-select{padding-left:1px;padding-right:1px;width:auto}#explanation-middle{text-align:center}#timestamp-left{display:inline-block;float:left;margin-left:17.8%}#timestamp-right{display:inline-block;float:right;margin-right:17.8%}.wayback-ymd-timestamp{display:flex}.wayback-timestamps>*{margin-left:10px;margin-right:10px}.wayback-timestamps{display:flex;flex-flow:row wrap;justify-content:center;width:42.86%}.wayback-ymd-buttons>*{display:block;margin-left:auto;margin-right:auto}.wayback-ymd-buttons{display:flex;flex-flow:row wrap;justify-content:center;width:14.28%}");var De=Object.prototype;var Ae=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||De)};var Ne=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),Oe=Ae,ke=Ne,Me=Object.prototype.hasOwnProperty;var Re=function(t){if(!Oe(t))return ke(t);var e=[];for(var n in Object(t))Me.call(t,n)&&"constructor"!=n&&e.push(n);return e},Ie=Ut(z,"DataView"),Pe=Ut(z,"Map"),Le=Ie,$e=Pe,He=Ut(z,"Promise"),Ue=Ut(z,"Set"),Be=Ut(z,"WeakMap"),Fe=et,ze=Tt,qe="[object Map]",Ye="[object Promise]",Ve="[object Set]",We="[object WeakMap]",Ge="[object DataView]",Xe=ze(Le),Je=ze($e),Ke=ze(He),Ze=ze(Ue),Qe=ze(Be),tn=Fe;(Le&&tn(new Le(new ArrayBuffer(1)))!=Ge||$e&&tn(new $e)!=qe||He&&tn(He.resolve())!=Ye||Ue&&tn(new Ue)!=Ve||Be&&tn(new Be)!=We)&&(tn=function(t){var e=Fe(t),n="[object Object]"==e?t.constructor:void 0,r=n?ze(n):"";if(r)switch(r){case Xe:return Ge;case Je:return qe;case Ke:return Ye;case Ze:return Ve;case Qe:return We}return e});var en=tn,nn=et,rn=nt;var an=function(t){return rn(t)&&"[object Arguments]"==nn(t)},sn=nt,on=Object.prototype,cn=on.hasOwnProperty,ln=on.propertyIsEnumerable,un=an(function(){return arguments}())?an:function(t){return sn(t)&&cn.call(t,"callee")&&!ln.call(t,"callee")},hn=Array.isArray,fn={exports:{}};var pn=function(){return!1};!function(t,e){var n=z,r=pn,a=e&&!e.nodeType&&e,i=a&&t&&!t.nodeType&&t,s=i&&i.exports===a?n.Buffer:void 0,o=(s?s.isBuffer:void 0)||r;t.exports=o}(fn,fn.exports);var dn=fn.exports,mn=et,gn=re,vn=nt,yn={};yn["[object Float32Array]"]=yn["[object Float64Array]"]=yn["[object Int8Array]"]=yn["[object Int16Array]"]=yn["[object Int32Array]"]=yn["[object Uint8Array]"]=yn["[object Uint8ClampedArray]"]=yn["[object Uint16Array]"]=yn["[object Uint32Array]"]=!0,yn["[object Arguments]"]=yn["[object Array]"]=yn["[object ArrayBuffer]"]=yn["[object Boolean]"]=yn["[object DataView]"]=yn["[object Date]"]=yn["[object Error]"]=yn["[object Function]"]=yn["[object Map]"]=yn["[object Number]"]=yn["[object Object]"]=yn["[object RegExp]"]=yn["[object Set]"]=yn["[object String]"]=yn["[object WeakMap]"]=!1;var _n=function(t){return vn(t)&&gn(t.length)&&!!yn[mn(t)]};var bn=function(t){return function(e){return t(e)}},wn={exports:{}};!function(t,e){var n=U,r=e&&!e.nodeType&&e,a=r&&t&&!t.nodeType&&t,i=a&&a.exports===r&&n.process,s=function(){try{var t=a&&a.require&&a.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=s}(wn,wn.exports);var xn=wn.exports,En=_n,Sn=bn,Cn=xn&&xn.isTypedArray,jn=Cn?Sn(Cn):En,Tn=Re,Dn=en,An=un,Nn=hn,On=se,kn=dn,Mn=Ae,Rn=jn,In=Object.prototype.hasOwnProperty;var Pn=r((function(t){if(null==t)return!0;if(On(t)&&(Nn(t)||"string"==typeof t||"function"==typeof t.splice||kn(t)||Rn(t)||An(t)))return!t.length;var e=Dn(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(Mn(t))return!Tn(t).length;for(var n in t)if(In.call(t,n))return!1;return!0}));const Ln={1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"};class $n extends m.Component{constructor(e){var n,r;super(e),t(this,"_leftMonthIndex",-1),t(this,"_rightMonthIndex",-1);const{timestampA:a,timestampB:i}=this.props;this._abortController=new window.AbortController,this.timestampSelectLeft=m.createRef(),this.timestampSelectRight=m.createRef(),this.monthSelectLeft=m.createRef(),this.monthSelectRight=m.createRef(),this.state={timestampA:a,timestampB:i,leftYear:null!==(n=null==a?void 0:a.substring(0,4))&&void 0!==n?n:"",rightYear:null!==(r=null==i?void 0:i.substring(0,4))&&void 0!==r?r:"",showDiffBtn:!1,shouldValidateTimestamp:!0},this._handleLeftTimestampChange=this._handleLeftTimestampChange.bind(this),this._handleRightTimestampChange=this._handleRightTimestampChange.bind(this),this._showDiffs=this._showDiffs.bind(this),this._errorHandled=this._errorHandled.bind(this),this._showMonths=this._showMonths.bind(this),this._handleYearChange=this._handleYearChange.bind(this),this._handleMonthChange=this._handleMonthChange.bind(this)}componentDidMount(){this.state.showError||(this.state.leftSnaps||this.state.rightSnaps?this._areRequestedTimestampsSelected():this._fetchCDXData())}componentDidUpdate(){this.state.sparkline||this.state.showLoader||this._fetchSparklineData(),(this.state.leftSnaps||this.state.rightSnaps)&&(this.state.shouldValidateTimestamp&&this._checkTimestamps(),this.state.showLoader||(this._selectValues(),!this.state.sparkline||this.state.leftMonthOptions||this.state.rightMonthOptions||-1===this._leftMonthIndex&&-1===this._rightMonthIndex||this._showMonths(this.state.leftYear,this.state.rightYear)))}componentWillUnmount(){this._abortController.abort()}_handleRightTimestampChange(t){if(this.setState({timestampB:t.target.value}),!Pn(this.state.leftSnaps)){const t=this.state.rightSnaps[this.timestampSelectRight.current.selectedIndex-1][1],e=this.state.leftSnaps.filter((e=>e[1]!==t));this.setState({showDiffBtn:!0,leftSnaps:e})}}_handleLeftTimestampChange(t){if(this.setState({timestampA:t.target.value}),!Pn(this.state.rightSnaps)){const t=this.state.leftSnaps[this.timestampSelectLeft.current.selectedIndex-1][1],e=this.state.rightSnaps.filter((e=>e[1]!==t));this.setState({showDiffBtn:!0,rightSnaps:e})}}render(){const t=()=>C(this.props.loader)?m.createElement(j,null):this.props.loader;return this.state.showLoader&&!this.state.showError?m.createElement("div",{className:"loading"},m.createElement(t,null)):this.state.showError?void 0:this.state.yearOptions||this.state.leftSnaps||this.state.rightSnaps?m.createElement("div",{className:"timestamp-header-view"},m.createElement("div",null,this.state.headerInfo,m.createElement("div",{id:"timestamp-left"},"Please select a capture"),m.createElement("div",{id:"timestamp-right"},"Please select a capture"),m.createElement("br",null)),m.createElement("div",{className:"wayback-ymd-timestamp"},m.createElement("div",{className:"wayback-timestamps"},m.createElement("select",{className:"form-control input-sm mr-sm-1",id:"year-select-left",onChange:this._handleYearChange,title:"Years and available captures",value:this.state.leftYear},m.createElement("option",{value:"",disabled:!0},"Year"),this.state.yearOptions),m.createElement("select",{className:"form-control input-sm mr-sm-1 month-select",ref:this.monthSelectLeft,onChange:this._handleMonthChange,title:"Months and available captures",defaultValue:""},m.createElement("option",{value:"",disabled:!0},"Month"),this.state.leftMonthOptions),!Pn(this.state.leftSnaps)&&m.createElement("select",{className:"form-control input-sm mr-sm-1 timestamp-select",ref:this.timestampSelectLeft,onChange:this._handleLeftTimestampChange,defaultValue:""},m.createElement("option",{value:"",disabled:!0},"Available captures"),this.state.leftSnaps.map(((t,e)=>m.createElement("option",{key:e,value:t[0]},Se(t[0])))))),m.createElement("div",{className:"wayback-ymd-buttons"},this.state.showDiffBtn&&m.createElement("button",{className:"btn btn-default btn-sm",onClick:this._showDiffs},"Show differences")),m.createElement("div",{className:"wayback-timestamps"},!Pn(this.state.rightSnaps)&&m.createElement("select",{className:"form-control input-sm mr-sm-1 timestamp-select",ref:this.timestampSelectRight,onChange:this._handleRightTimestampChange,defaultValue:""},m.createElement("option",{value:"",disabled:!0},"Available captures"),this.state.rightSnaps.map(((t,e)=>m.createElement("option",{key:e,value:t[0]},Se(t[0]))))),m.createElement("select",{className:"form-control input-sm mr-sm-1 month-select",ref:this.monthSelectRight,onChange:this._handleMonthChange,title:"Months and available captures",defaultValue:""},m.createElement("option",{value:"",disabled:!0},"Month"),this.state.rightMonthOptions),m.createElement("select",{className:"form-control input-sm mr-sm-1",id:"year-select-right",onChange:this._handleYearChange,title:"Years and available captures",value:this.state.rightYear},m.createElement("option",{value:"",disabled:!0},"Year"),this.state.yearOptions))),m.createElement("div",null,this.state.timestampA&&m.createElement("a",{href:this.props.conf.snapshotsPrefix+this.state.timestampA+"/"+this.props.url,id:"timestamp-left",target:"_blank",rel:"noopener noreferrer"}," Open in new window"),this.state.timestampB&&m.createElement("a",{href:this.props.conf.snapshotsPrefix+this.state.timestampB+"/"+this.props.url,id:"timestamp-right",target:"_blank",rel:"noopener noreferrer"},"Open in new window"),m.createElement("br",null))):m.createElement(t,null)}_areRequestedTimestampsSelected(){if(this.state.finishedValidating){if(!isNaN(this.state.timestampA)){const t=this.state.leftSnaps.slice(-1)[0];this.state.timestampA>t&&this.setState({leftSnaps:[...this.state.leftSnaps,[this.state.timestampA,"0"]],finishedValidating:!1})}if(!isNaN(this.state.timestampB)){const t=this.state.rightSnaps.slice(-1)[0];this.state.timestampB>t&&this.setState({rightSnaps:[...this.state.rightSnaps,[this.state.timestampB,"1"]],finishedValidating:!1})}}}_checkTimestamps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const{timestampA:e,timestampB:n}=this.state;"left"===t&&C(e)?this.setState({leftSnaps:null}):"right"===t&&C(n)&&this.setState({rightSnaps:null}),this.setState({finishedValidating:!0,showLoader:!1,shouldValidateTimestamp:!1})}createCDXRequest(t){const e=new URL(this.props.conf.cdxServer,window.location.origin);return e.searchParams.append("url",this.props.url),e.searchParams.append("fl","timestamp,digest"),e.searchParams.append("output","json"),e.searchParams.append("from",t),e.searchParams.append("to",t),e.searchParams.append("limit",this.props.conf.limit),we(e,{signal:this._abortController.signal}).then(be)}fetchYearMonthCaptures(t,e){const{conf:n,url:r}=this.props,a=new URL(n.calendarURL,window.location.origin);return a.searchParams.append("url",r),a.searchParams.append("date",t+e),a.searchParams.append("digest",1),we(a,{signal:this._abortController.signal}).then(be).then((t=>t.items)).then((n=>n.map((n=>{return[t+e+(r=n[0],7==(r=r.toString()).length?"0"+r:r),n[2]];var r})))).catch((t=>{this._errorHandled(t.message)}))}_fetchCDXData(){if(this.setState({showLoader:!0}),-1!==this._leftMonthIndex){const t=this.monthSelectLeft.current.value;this._leftMonthIndex=parseInt(Ee(Ln,t))}else this.state.timestampA&&(this._leftMonthIndex=parseInt(this.state.timestampA.substring(4,6)));if(-1!==this._rightMonthIndex){const t=this.monthSelectRight.current.value;this._rightMonthIndex=parseInt(Ee(Ln,t))}else this.state.timestampB&&(this._rightMonthIndex=parseInt(this.state.timestampB.substring(4,6)));let t,e;-1!==this._leftMonthIndex&&(t=this.fetchYearMonthCaptures(this.state.leftYear,xe(this._leftMonthIndex))),-1!==this._rightMonthIndex&&(e=this.fetchYearMonthCaptures(this.state.rightYear,xe(this._rightMonthIndex))),t?t.then((t=>{if(t&&t.length>0)if(e){const n=t;e.then((t=>{t&&t.length>0?this._prepareCDXData(n,t):this._checkTimestamps("right")}))}else this._prepareCDXData(t,null);else this._checkTimestamps("left")})).catch((t=>{this._errorHandled(t.message)})):e&&e.then((t=>{t&&t.length>0?this._prepareCDXData(null,t):this._checkTimestamps("right")}))}_errorHandled(t){this.props.errorHandledCallback(t),this.setState({showError:!0})}_prepareCDXData(t,e){this.props.getTimestampsCallback(this.state.timestampA,this.state.timestampB),this.setState({leftSnaps:t,rightSnaps:e,showLoader:!1})}_showOptions(t){const e=parseInt(this.props.conf.limit);return t&&t.slice(0).reverse().map(((t,n)=>{const r=Math.min(t[1],e);return m.createElement("option",{key:n,value:t[0]},"".concat(t[0]," (").concat(r,")"))}))}_showDiffs(){const t=this.timestampSelectLeft.current.value,e=this.timestampSelectRight.current.value;this.props.getTimestampsCallback(t,e),this.setState({timestampA:t,timestampB:e})}_selectValues(){const{timestampA:t,timestampB:e,leftSnaps:n,rightSnaps:r}=this.state;!Pn(n)&&t&&(this.timestampSelectLeft.current.value=t),!Pn(r)&&e&&(this.timestampSelectRight.current.value=e);const a=this.monthSelectLeft.current,i=this.monthSelectRight.current;Array.from(a.options).some((t=>t.value===Ln[this._leftMonthIndex]))?a.value=Ln[this._leftMonthIndex]:a.selectedIndex=0,Array.from(i.options).some((t=>t.value===Ln[this._rightMonthIndex]))?i.value=Ln[this._rightMonthIndex]:i.selectedIndex=0}_getHeaderInfo(t,e,n){const r=Ce(t),a=Ce(e);return m.createElement("p",{id:"explanation-middle"},"Compare any two captures of ",this.props.url," from our collection of ",n.toLocaleString()," dating from ",r," to ",a,".")}_fetchSparklineData(){this.setState({showLoader:!0});const t=new URL(this.props.conf.sparklineURL,window.location.origin);t.searchParams.append("url",this.props.url),t.searchParams.append("collection","web"),t.searchParams.append("output","json"),we(t,{signal:this._abortController.signal}).then(be).then((t=>{t?this._prepareSparklineData(t):this._errorHandled("404")})).catch((t=>{this._errorHandled(t.message)}))}_prepareSparklineData(t){const e=t.years,n=new Array(e.length);let r=0,a=0;for(const t in e){n[r]=[t,0];for(let i=0;i<e[t].length;i++)n[r][1]=n[r][1]+e[t][i],a+=e[t][i];r++}this.setState({showLoader:!1,sparkline:e,yearOptions:this._showOptions(n),headerInfo:this._getHeaderInfo(t.first_ts,t.last_ts,a)})}_showMonths(t,e){if(!C(t)){const e=this.state.sparkline[t].filter((t=>t>0)).map(((t,e)=>[Ln[e+1],t]));this.setState({leftMonthOptions:this._showOptions(e)})}if(!C(e)){const t=this.state.sparkline[e].filter((t=>t>0)).map(((t,e)=>[Ln[e+1],t]));this.setState({rightMonthOptions:this._showOptions(t)})}}_handleMonthChange(t){this._fetchCDXData(),this.setState({showDiffBtn:!0,timestampA:null,timestampB:null})}_handleYearChange(t){"year-select-left"===t.target.id?(this._leftMonthIndex=0,this.setState({leftYear:t.target.value,leftSnaps:null,showDiffBtn:!1}),this._showMonths(t.target.value,null)):(this._rightMonthIndex=0,this.setState({rightYear:t.target.value,rightSnaps:null,showDiffBtn:!1}),this._showMonths(null,t.target.value))}}function Hn(){return m.createElement("p",{id:"diff-footer"},m.createElement("yellow-diff-footer",null,"Yellow")," indicates content deletion. ",m.createElement("blue-diff-footer",null,"Blue")," indicates content addition.")}t($n,"propTypes",{loader:v.object,errorHandledCallback:v.func,getTimestampsCallback:v.func,timestampA:v.string,timestampB:v.string,conf:v.object,url:v.string});class Un extends m.Component{render(){return m.createElement("h1",null,"No capture is selected, please pick one from the list.")}}const Bn=t=>{let{code:e,url:n,timestamp:r,conf:a,errorHandledCallback:i}=t,s="We are sorry but there is a problem comparing these captures. Please try two different ones.",o=!1,c=r?r.substring(0,4):"";const l=d.useCallback((()=>{we("".concat(a.waybackDiscoverDiff,"/calculate-simhash?url=").concat(encodeURIComponent(n),"&year=").concat(r.substring(0,4))).then(_e).then((()=>{setTimeout((function(){window.location.reload(!0)}),1e4)})).catch((t=>{i(t.message)}))}),[a,n,r]);switch(e){case"404":s="The Wayback Machine has not archived ".concat(n,"."),o=!1;break;case"422":s="The captures of ".concat(n," cannot be compared. Note that we support only HTML capture comparison."),o=!1;break;case"CAPTURE_NOT_FOUND":s="There are no data available for ".concat(n," at ").concat(r,"."),o=!0;break;case"NOT_CAPTURED":s="The Wayback Machine has no similarity data for ".concat(n," and year ").concat(c,"."),o=!0;break;case"NO_CAPTURES":s="The Wayback Machine has not archived ".concat(n," for year ").concat(c,"."),o=!1;break;case"NO_DIFFERENT_CAPTURES":s="There aren't any different captures for ".concat(n," for year ").concat(c," to display their similarity."),o=!1;break;case"_this4.errorHandled is not a function":case"NetworkError when attempting to fetch resource.":case"Load failed":s="The capture of ".concat(n," at ").concat(r," cannot be used for comparisons. Its possible it is a redirect."),o=!1}return m.createElement(m.Fragment,null,m.createElement("div",{className:"alert alert-warning",role:"alert"},s),o&&m.createElement("button",{className:"btn btn-sm",id:"calcButton",onClick:l},"Calculate now"),m.createElement("button",{className:"btn btn-sm",onClick:()=>window.history.back()},"« Go back"))};Bn.propTypes={code:v.string,url:v.string,timestamp:v.string,conf:v.object,errorHandledCallback:v.func};class Fn extends m.Component{constructor(e){super(e),t(this,"getTimestamps",((t,e)=>{if((void 0!==t||void 0!==e)&&(this.setState({fetchedRaw:null,error:null,showDiff:!0,timestampA:t||"",timestampB:e||""}),t!==this.state.timestampA||e!==this.state.timestampB)){const n=this.props.conf.urlPrefix+(t||"")+"/"+(e||"")+"/"+this.props.url;window.history.pushState({},"",n)}})),t(this,"errorHandled",(t=>{this.setState({error:t})})),t(this,"prepareDiffView",(()=>{const{timestampA:t,timestampB:e}=this.state,{conf:n,url:r,loader:a}=this.props;if(!this.state.error){const i=new URL(n.snapshotsPrefix+t+"/"+encodeURIComponent(r),window.location.origin),s=new URL(n.snapshotsPrefix+e+"/"+encodeURIComponent(r),window.location.origin),o=new URL(n.webMonitoringProcessingURL,window.location.origin);return m.createElement(Te,{webMonitoringProcessingURL:o.toString(),page:{url:encodeURIComponent(r)},diffType:"SIDE_BY_SIDE_RENDERED",a:i,b:s,loader:a,errorHandledCallback:this.errorHandled})}})),this.state={showDiff:!1,timestampA:this.props.timestampA,timestampB:this.props.timestampB},this._oneFrame=null}render(){const{url:t,noTimestamps:n,conf:r,loader:a}=this.props,{timestampA:i,timestampB:s,showDiff:o,error:c}=this.state;return c?m.createElement(Bn,{url:t,timestamp:i,code:c}):i||s?i&&s?m.createElement("div",{className:"diffcontainer-view"},m.createElement($n,e({},this.props,{getTimestampsCallback:this.getTimestamps,errorHandledCallback:this.errorHandled})),o&&this.prepareDiffView(),m.createElement(Hn,null)):i?m.createElement("div",{className:"diffcontainer-view"},m.createElement($n,e({},this.props,{getTimestampsCallback:this.getTimestamps,errorHandledCallback:this.errorHandled})),o&&this._showOneSnapshot(!0,i)):s?m.createElement("div",{className:"diffcontainer-view"},m.createElement($n,e({},this.props,{errorHandledCallback:this.errorHandled,getTimestampsCallback:this.getTimestamps})),o&&this._showOneSnapshot(!1,s)):void 0:m.createElement("div",{className:"diffcontainer-view"},m.createElement($n,e({},this.props,{getTimestampsCallback:this.getTimestamps,errorHandledCallback:this.errorHandled})),n&&this._showNoTimestamps())}_showNoTimestamps(){return m.createElement("div",{className:"side-by-side-render"},m.createElement(Un,null),m.createElement(Un,null))}_showOneSnapshot(t,e){const{fetchedRaw:n}=this.state,{conf:r,url:a,loader:i}=this.props;if(n){const e={height:window.innerHeight,onLoad:()=>this._handleHeight,srcDoc:n,ref:t=>{this._oneFrame=t}};return m.createElement("div",{className:"side-by-side-render"},t?m.createElement("iframe",e):m.createElement(Un,null),t?m.createElement(Un,null):m.createElement("iframe",e))}const s=new URL(r.snapshotsPrefix+e+"/"+encodeURIComponent(a),window.location.origin);this._handleSnapshotFetch(we(s.toString()));const o=()=>C(i)?m.createElement(j,null):i;return m.createElement("div",{className:"loading"},m.createElement(o,null))}_handleSnapshotFetch(t){t.then(_e).then((t=>{const e=t.headers.get("content-type");return e&&e.includes("text/html")?t.text():"<iframe src="+t.url+' style="width: 98%; position: absolute; height: 98%;" />'})).then((t=>{this.setState({fetchedRaw:t})})).catch((t=>{this.errorHandled(t.message)}))}_handleHeight(){const t=this._oneFrame.contentDocument.documentElement.scrollHeight,e=this._oneFrame.contentDocument.documentElement.scrollWidth;t>.1*this._oneFrame.height?this._oneFrame.height=t+.01*t:this._oneFrame.height=.5*this._oneFrame.height,e>this._oneFrame.clientWidth&&(this._oneFrame.width=e)}}Fn.propTypes={url:v.string.isRequired,timestampA:v.string,timestampB:v.string,conf:v.object.isRequired,loader:v.element,noTimestamps:(t,e,n)=>t.noTimestamps&&"boolean"!=typeof t.noTimestamps?new Error("noTimestamps specified in '".concat(n," should be boolean'.")):t.noTimestamps||t.timestampA||t.timestampB?void 0:new Error("At least one of props 'timestampA' or 'timestampB' or noTimestamps must be specified in '".concat(n,"'."))};var zn=/\s/;var qn=function(t){for(var e=t.length;e--&&zn.test(t.charAt(e)););return e},Yn=/^\s+/;var Vn=function(t){return t?t.slice(0,qn(t)+1).replace(Yn,""):t},Wn=yt,Gn=it,Xn=/^[-+]0x[0-9a-f]+$/i,Jn=/^0b[01]+$/i,Kn=/^0o[0-7]+$/i,Zn=parseInt;var Qn=function(t){if("number"==typeof t)return t;if(Gn(t))return NaN;if(Wn(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Wn(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Vn(t);var n=Jn.test(t);return n||Kn.test(t)?Zn(t.slice(2),n?2:8):Xn.test(t)?NaN:+t},tr=Qn;var er=function(t){return t?Infinity===(t=tr(t))||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var nr=function(t){var e=er(t),n=e%1;return e==e?n?e-n:e:0},rr=te,ar=hn,ir=it,sr=q?q.prototype:void 0,or=sr?sr.toString:void 0;var cr=function t(e){if("string"==typeof e)return e;if(ar(e))return rr(e,t)+"";if(ir(e))return or?or.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n},lr=cr;var ur=function(t){return null==t?"":lr(t)},hr=nr,fr=Qn,pr=ur,dr=z.isFinite,mr=Math.min;var gr=r(function(t){var e=Math[t];return function(t,n){if(t=fr(t),(n=null==n?0:mr(hr(n),292))&&dr(t)){var r=(pr(t)+"e").split("e"),a=e(r[0]+"e"+(+r[1]+n));return+((r=(pr(a)+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round")),vr="http://www.w3.org/1999/xhtml",yr={svg:"http://www.w3.org/2000/svg",xhtml:vr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _r(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),yr.hasOwnProperty(e)?{space:yr[e],local:t}:t}function br(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===vr&&e.documentElement.namespaceURI===vr?e.createElement(t):e.createElementNS(n,t)}}function wr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function xr(t){var e=_r(t);return(e.local?wr:br)(e)}function Er(){}function Sr(t){return null==t?Er:function(){return this.querySelector(t)}}function Cr(){return[]}function jr(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}function Tr(t){return function(e){return e.matches(t)}}var Dr=Array.prototype.find;function Ar(){return this.firstElementChild}var Nr=Array.prototype.filter;function Or(){return Array.from(this.children)}function kr(t){return new Array(t.length)}function Mr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Rr(t,e,n,r,a,i){for(var s,o=0,c=e.length,l=i.length;o<l;++o)(s=e[o])?(s.__data__=i[o],r[o]=s):n[o]=new Mr(t,i[o]);for(;o<c;++o)(s=e[o])&&(a[o]=s)}function Ir(t,e,n,r,a,i,s){var o,c,l,u=new Map,h=e.length,f=i.length,p=new Array(h);for(o=0;o<h;++o)(c=e[o])&&(p[o]=l=s.call(c,c.__data__,o,e)+"",u.has(l)?a[o]=c:u.set(l,c));for(o=0;o<f;++o)l=s.call(t,i[o],o,i)+"",(c=u.get(l))?(r[o]=c,c.__data__=i[o],u.delete(l)):n[o]=new Mr(t,i[o]);for(o=0;o<h;++o)(c=e[o])&&u.get(p[o])===c&&(a[o]=c)}function Pr(t){return t.__data__}function Lr(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function $r(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Hr(t){return function(){this.removeAttribute(t)}}function Ur(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Br(t,e){return function(){this.setAttribute(t,e)}}function Fr(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function zr(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function qr(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Yr(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Vr(t){return function(){this.style.removeProperty(t)}}function Wr(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Gr(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Xr(t){return function(){delete this[t]}}function Jr(t,e){return function(){this[t]=e}}function Kr(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Zr(t){return t.trim().split(/^|\s+/)}function Qr(t){return t.classList||new ta(t)}function ta(t){this._node=t,this._names=Zr(t.getAttribute("class")||"")}function ea(t,e){for(var n=Qr(t),r=-1,a=e.length;++r<a;)n.add(e[r])}function na(t,e){for(var n=Qr(t),r=-1,a=e.length;++r<a;)n.remove(e[r])}function ra(t){return function(){ea(this,t)}}function aa(t){return function(){na(this,t)}}function ia(t,e){return function(){(e.apply(this,arguments)?ea:na)(this,t)}}function sa(){this.textContent=""}function oa(t){return function(){this.textContent=t}}function ca(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function la(){this.innerHTML=""}function ua(t){return function(){this.innerHTML=t}}function ha(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function fa(){this.nextSibling&&this.parentNode.appendChild(this)}function pa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function da(){return null}function ma(){var t=this.parentNode;t&&t.removeChild(this)}function ga(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function va(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ya(t){return function(){var e=this.__on;if(e){for(var n,r=0,a=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?e.length=a:delete this.__on}}}function _a(t,e,n){return function(){var r,a=this.__on,i=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(a)for(var s=0,o=a.length;s<o;++s)if((r=a[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e);this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},a?a.push(r):this.__on=[r]}}function ba(t,e,n){var r=Yr(t),a=r.CustomEvent;"function"==typeof a?a=new a(e,n):(a=r.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function wa(t,e){return function(){return ba(this,t,e)}}function xa(t,e){return function(){return ba(this,t,e.apply(this,arguments))}}Mr.prototype={constructor:Mr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},ta.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Ea=[null];function Sa(t,e){this._groups=t,this._parents=e}function Ca(t){return"string"==typeof t?new Sa([[document.querySelector(t)]],[document.documentElement]):new Sa([[t]],Ea)}function ja(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Ta(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Aa)):void 0===e&&(e=Da);for(var n,r,a,i,s,o=new ka(t),c=[o];n=c.pop();)if((a=e(n.data))&&(s=(a=Array.from(a)).length))for(n.children=a,i=s-1;i>=0;--i)c.push(r=a[i]=new ka(a[i])),r.parent=n,r.depth=n.depth+1;return o.eachBefore(Oa)}function Da(t){return t.children}function Aa(t){return Array.isArray(t)?t[1]:null}function Na(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function Oa(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function ka(t){this.data=t,this.depth=this.height=0,this.parent=null}function Ma(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Ra(){var t=1,e=1,n=0,r=!1;function a(a){var i=a.height+1;return a.x0=a.y0=n,a.x1=t,a.y1=e/i,a.eachBefore(function(t,e){return function(r){r.children&&function(t,e,n,r,a){for(var i,s=t.children,o=-1,c=s.length,l=t.value&&(r-e)/t.value;++o<c;)(i=s[o]).y0=n,i.y1=a,i.x0=e,i.x1=e+=i.value*l}(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var a=r.x0,i=r.y0,s=r.x1-n,o=r.y1-n;s<a&&(a=s=(a+s)/2),o<i&&(i=o=(i+o)/2),r.x0=a,r.y0=i,r.x1=s,r.y1=o}}(e,i)),r&&a.eachBefore(Ma),a}return a.round=function(t){return arguments.length?(r=!!t,a):r},a.size=function(n){return arguments.length?(t=+n[0],e=+n[1],a):[t,e]},a.padding=function(t){return arguments.length?(n=+t,a):n},a}function Ia(t){return function(){return t}}Sa.prototype={constructor:Sa,select:function(t){"function"!=typeof t&&(t=Sr(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,s,o=e[a],c=o.length,l=r[a]=new Array(c),u=0;u<c;++u)(i=o[u])&&(s=t.call(i,i.__data__,u,o))&&("__data__"in i&&(s.__data__=i.__data__),l[u]=s);return new Sa(r,this._parents)},selectAll:function(t){t="function"==typeof t?jr(t):function(t){return null==t?Cr:function(){return this.querySelectorAll(t)}}(t);for(var e=this._groups,n=e.length,r=[],a=[],i=0;i<n;++i)for(var s,o=e[i],c=o.length,l=0;l<c;++l)(s=o[l])&&(r.push(t.call(s,s.__data__,l,o)),a.push(s));return new Sa(r,a)},selectChild:function(t){return this.select(null==t?Ar:function(t){return function(){return Dr.call(this.children,t)}}("function"==typeof t?t:Tr(t)))},selectChildren:function(t){return this.selectAll(null==t?Or:function(t){return function(){return Nr.call(this.children,t)}}("function"==typeof t?t:Tr(t)))},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,s=e[a],o=s.length,c=r[a]=[],l=0;l<o;++l)(i=s[l])&&t.call(i,i.__data__,l,s)&&c.push(i);return new Sa(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Pr);var n,r=e?Ir:Rr,a=this._parents,i=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=i.length,o=new Array(s),c=new Array(s),l=new Array(s),u=0;u<s;++u){var h=a[u],f=i[u],p=f.length,d=Lr(t.call(h,h&&h.__data__,u,a)),m=d.length,g=c[u]=new Array(m),v=o[u]=new Array(m);r(h,f,g,v,l[u]=new Array(p),d,e);for(var y,_,b=0,w=0;b<m;++b)if(y=g[b]){for(b>=w&&(w=b+1);!(_=v[w])&&++w<m;);y._next=_||null}}return(o=new Sa(o,a))._enter=c,o._exit=l,o},enter:function(){return new Sa(this._enter||this._groups.map(kr),this._parents)},exit:function(){return new Sa(this._exit||this._groups.map(kr),this._parents)},join:function(t,e,n){var r=this.enter(),a=this,i=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(a=e(a))&&(a=a.selection()),null==n?i.remove():n(i),r&&a?r.merge(a).order():a},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,a=n.length,i=r.length,s=Math.min(a,i),o=new Array(a),c=0;c<s;++c)for(var l,u=n[c],h=r[c],f=u.length,p=o[c]=new Array(f),d=0;d<f;++d)(l=u[d]||h[d])&&(p[d]=l);for(;c<a;++c)o[c]=n[c];return new Sa(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,a=t[e],i=a.length-1,s=a[i];--i>=0;)(r=a[i])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=$r);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var s,o=n[i],c=o.length,l=a[i]=new Array(c),u=0;u<c;++u)(s=o[u])&&(l[u]=s);l.sort(e)}return new Sa(a,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,i=r.length;a<i;++a){var s=r[a];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var a,i=e[n],s=0,o=i.length;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this},attr:function(t,e){var n=_r(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Ur:Hr:"function"==typeof e?n.local?qr:zr:n.local?Fr:Br)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Vr:"function"==typeof e?Gr:Wr)(t,e,null==n?"":n)):function(t,e){return t.style.getPropertyValue(e)||Yr(t).getComputedStyle(t,null).getPropertyValue(e)}(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Xr:"function"==typeof e?Kr:Jr)(t,e)):this.node()[t]},classed:function(t,e){var n=Zr(t+"");if(arguments.length<2){for(var r=Qr(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof e?ia:e?ra:aa)(n,e))},text:function(t){return arguments.length?this.each(null==t?sa:("function"==typeof t?ca:oa)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?la:("function"==typeof t?ha:ua)(t)):this.node().innerHTML},raise:function(){return this.each(fa)},lower:function(){return this.each(pa)},append:function(t){var e="function"==typeof t?t:xr(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:xr(t),r=null==e?da:"function"==typeof e?e:Sr(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ma)},clone:function(t){return this.select(t?va:ga)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,a,i=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),s=i.length;if(!(arguments.length<2)){for(o=e?_a:ya,r=0;r<s;++r)this.each(o(i[r],e,n));return this}var o=this.node().__on;if(o)for(var c,l=0,u=o.length;l<u;++l)for(r=0,c=o[l];r<s;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?xa:wa)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,a=t[e],i=0,s=a.length;i<s;++i)(r=a[i])&&(yield r)}},ka.prototype=Ta.prototype={constructor:ka,count:function(){return this.eachAfter(ja)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,a,i=this,s=[i],o=[],c=-1;i=s.pop();)if(o.push(i),n=i.children)for(r=0,a=n.length;r<a;++r)s.push(n[r]);for(;i=o.pop();)t.call(e,i,++c,this);return this},eachBefore:function(t,e){for(var n,r,a=this,i=[a],s=-1;a=i.pop();)if(t.call(e,a,++s,this),n=a.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,a=r&&r.length;--a>=0;)n+=r[a].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),a=null;t=n.pop(),e=r.pop();for(;t===e;)a=t,t=n.pop(),e=r.pop();return a}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var a=r.length;t!==n;)r.splice(a,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Ta(this).eachBefore(Na)},[Symbol.iterator]:function*(){var t,e,n,r,a=this,i=[a];do{for(t=i.reverse(),i=[];a=t.pop();)if(yield a,e=a.children)for(n=0,r=e.length;n<r;++n)i.push(e[n])}while(i.length)}};const Pa=Math.abs,La=Math.atan2,$a=Math.cos,Ha=Math.max,Ua=Math.min,Ba=Math.sin,Fa=Math.sqrt,za=1e-12,qa=Math.PI,Ya=qa/2,Va=2*qa;function Wa(t){return t>=1?Ya:t<=-1?-Ya:Math.asin(t)}const Ga=Math.PI,Xa=2*Ga,Ja=1e-6,Ka=Xa-Ja;function Za(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Qa{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Za:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Za;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,a,i){this._append`C${+t},${+e},${+n},${+r},${this._x1=+a},${this._y1=+i}`}arcTo(t,e,n,r,a){if(t=+t,e=+e,n=+n,r=+r,(a=+a)<0)throw new Error(`negative radius: ${a}`);let i=this._x1,s=this._y1,o=n-t,c=r-e,l=i-t,u=s-e,h=l*l+u*u;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>Ja)if(Math.abs(u*o-c*l)>Ja&&a){let f=n-i,p=r-s,d=o*o+c*c,m=f*f+p*p,g=Math.sqrt(d),v=Math.sqrt(h),y=a*Math.tan((Ga-Math.acos((d+h-m)/(2*g*v)))/2),_=y/v,b=y/g;Math.abs(_-1)>Ja&&this._append`L${t+_*l},${e+_*u}`,this._append`A${a},${a},0,0,${+(u*f>l*p)},${this._x1=t+b*o},${this._y1=e+b*c}`}else this._append`L${this._x1=t},${this._y1=e}`;else;}arc(t,e,n,r,a,i){if(t=+t,e=+e,i=!!i,(n=+n)<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(r),o=n*Math.sin(r),c=t+s,l=e+o,u=1^i,h=i?r-a:a-r;null===this._x1?this._append`M${c},${l}`:(Math.abs(this._x1-c)>Ja||Math.abs(this._y1-l)>Ja)&&this._append`L${c},${l}`,n&&(h<0&&(h=h%Xa+Xa),h>Ka?this._append`A${n},${n},0,1,${u},${t-s},${e-o}A${n},${n},0,1,${u},${this._x1=c},${this._y1=l}`:h>Ja&&this._append`A${n},${n},0,${+(h>=Ga)},${u},${this._x1=t+n*Math.cos(a)},${this._y1=e+n*Math.sin(a)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function ti(t){return t.innerRadius}function ei(t){return t.outerRadius}function ni(t){return t.startAngle}function ri(t){return t.endAngle}function ai(t){return t&&t.padAngle}function ii(t,e,n,r,a,i,s){var o=t-n,c=e-r,l=(s?i:-i)/Fa(o*o+c*c),u=l*c,h=-l*o,f=t+u,p=e+h,d=n+u,m=r+h,g=(f+d)/2,v=(p+m)/2,y=d-f,_=m-p,b=y*y+_*_,w=a-i,x=f*m-d*p,E=(_<0?-1:1)*Fa(Ha(0,w*w*b-x*x)),S=(x*_-y*E)/b,C=(-x*y-_*E)/b,j=(x*_+y*E)/b,T=(-x*y+_*E)/b,D=S-g,A=C-v,N=j-g,O=T-v;return D*D+A*A>N*N+O*O&&(S=j,C=T),{cx:S,cy:C,x01:-u,y01:-h,x11:S*(a/w-1),y11:C*(a/w-1)}}function si(){var t=ti,e=ei,n=Ia(0),r=null,a=ni,i=ri,s=ai,o=null,c=function(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new Qa(e)}(l);function l(){var l,u,h,f=+t.apply(this,arguments),p=+e.apply(this,arguments),d=a.apply(this,arguments)-Ya,m=i.apply(this,arguments)-Ya,g=Pa(m-d),v=m>d;if(o||(o=l=c()),p<f&&(u=p,p=f,f=u),p>za)if(g>Va-za)o.moveTo(p*$a(d),p*Ba(d)),o.arc(0,0,p,d,m,!v),f>za&&(o.moveTo(f*$a(m),f*Ba(m)),o.arc(0,0,f,m,d,v));else{var y,_,b=d,w=m,x=d,E=m,S=g,C=g,j=s.apply(this,arguments)/2,T=j>za&&(r?+r.apply(this,arguments):Fa(f*f+p*p)),D=Ua(Pa(p-f)/2,+n.apply(this,arguments)),A=D,N=D;if(T>za){var O=Wa(T/f*Ba(j)),k=Wa(T/p*Ba(j));(S-=2*O)>za?(x+=O*=v?1:-1,E-=O):(S=0,x=E=(d+m)/2),(C-=2*k)>za?(b+=k*=v?1:-1,w-=k):(C=0,b=w=(d+m)/2)}var M=p*$a(b),R=p*Ba(b),I=f*$a(E),P=f*Ba(E);if(D>za){var L,$=p*$a(w),H=p*Ba(w),U=f*$a(x),B=f*Ba(x);if(g<qa)if(L=function(t,e,n,r,a,i,s,o){var c=n-t,l=r-e,u=s-a,h=o-i,f=h*c-u*l;if(!(f*f<za))return[t+(f=(u*(e-i)-h*(t-a))/f)*c,e+f*l]}(M,R,U,B,$,H,I,P)){var F=M-L[0],z=R-L[1],q=$-L[0],Y=H-L[1],V=1/Ba(((h=(F*q+z*Y)/(Fa(F*F+z*z)*Fa(q*q+Y*Y)))>1?0:h<-1?qa:Math.acos(h))/2),W=Fa(L[0]*L[0]+L[1]*L[1]);A=Ua(D,(f-W)/(V-1)),N=Ua(D,(p-W)/(V+1))}else A=N=0}C>za?N>za?(y=ii(U,B,M,R,p,N,v),_=ii($,H,I,P,p,N,v),o.moveTo(y.cx+y.x01,y.cy+y.y01),N<D?o.arc(y.cx,y.cy,N,La(y.y01,y.x01),La(_.y01,_.x01),!v):(o.arc(y.cx,y.cy,N,La(y.y01,y.x01),La(y.y11,y.x11),!v),o.arc(0,0,p,La(y.cy+y.y11,y.cx+y.x11),La(_.cy+_.y11,_.cx+_.x11),!v),o.arc(_.cx,_.cy,N,La(_.y11,_.x11),La(_.y01,_.x01),!v))):(o.moveTo(M,R),o.arc(0,0,p,b,w,!v)):o.moveTo(M,R),f>za&&S>za?A>za?(y=ii(I,P,$,H,f,-A,v),_=ii(M,R,U,B,f,-A,v),o.lineTo(y.cx+y.x01,y.cy+y.y01),A<D?o.arc(y.cx,y.cy,A,La(y.y01,y.x01),La(_.y01,_.x01),!v):(o.arc(y.cx,y.cy,A,La(y.y01,y.x01),La(y.y11,y.x11),!v),o.arc(0,0,f,La(y.cy+y.y11,y.cx+y.x11),La(_.cy+_.y11,_.cx+_.x11),v),o.arc(_.cx,_.cy,A,La(_.y11,_.x11),La(_.y01,_.x01),!v))):o.arc(0,0,f,E,x,v):o.lineTo(I,P)}else o.moveTo(0,0);if(o.closePath(),l)return o=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-qa/2;return[$a(r)*n,Ba(r)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Ia(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Ia(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:Ia(+t),l):n},l.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Ia(+t),l):r},l.startAngle=function(t){return arguments.length?(a="function"==typeof t?t:Ia(+t),l):a},l.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Ia(+t),l):i},l.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:Ia(+t),l):s},l.context=function(t){return arguments.length?(o=null==t?null:t,l):o},l}function oi(){const t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let n;return n=e<t?.45*e:.45*t,function(t){const e=document.getElementById("root-cell-tooltip");e&&e.setAttribute("style","top:".concat(.4*t,"px; width:").concat(.4*t,"px; height:").concat(.22*t,"px; font-size: ").concat(.004*t,"em;"))}(n),n}function ci(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.captures?t.captures:[e,t.simhash]}function li(t){if(-1!==t.similarity)return"".concat(t.name," - Differences: ").concat(gr(t.similarity,2),"%")}class ui extends m.Component{constructor(e){super(e),t(this,"state",{hint:""}),this.chartRef=m.createRef()}componentDidMount(){const{simhashData:t,urlPrefix:e,url:n}=this.props,r=oi(),a=oi(),i=Math.min(r,a)/2,s=Ca(this.chartRef.current).attr("width",r).attr("height",a).append("g").attr("transform","translate("+r/2+","+a/2+")"),o=Ra().size([2*Math.PI,i]),c=Ta(t).sum((function(t){return 5}));o(c);const l=si().startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})).innerRadius((function(t){return t.y0})).outerRadius((function(t){return t.y1})),u=this;s.selectAll("path").data(c.descendants()).enter().append("path").attr("display",(function(t){return t.depth?null:"none"})).attr("d",l).style("stroke","#fff").style("fill",(function(t){return t.data.clr})).on("mouseover",(function(t,e){Ca(t.currentTarget).style("cursor","pointer").style("stroke","black"),u.setState({hint:li(e.data)})})).on("mouseleave",(function(t,e){Ca(t.currentTarget).style("cursor","default").style("stroke",""),u.setState({hint:""})})).on("click",(function(r,a){if(a.data.timestamp!==t.timestamp){const r=e+a.data.timestamp+"/"+t.timestamp+"/"+n;window.open(r,"_blank")}}))}render(){return m.createElement(m.Fragment,null,m.createElement("p",{className:"text-center",style:{marginTop:"10px"}},this.state.hint,"  "),m.createElement("div",{className:"text-center"},m.createElement("svg",{ref:this.chartRef})))}}t(ui,"propTypes",{simhashData:v.object,url:v.string,urlPrefix:v.string});var hi={exports:{}};hi.exports=function(){function t(t){return t.slice().sort((function(t,e){return t-e}))}function e(t){for(var e,n=0,r=0;r<t.length;r++)0!==r&&t[r]===e||(e=t[r],n++);return n}function n(t,e){for(var n=[],r=0;r<t;r++){for(var a=[],i=0;i<e;i++)a.push(0);n.push(a)}return n}function r(t,e,n,r){var a;if(t>0){var i=(n[e]-n[t-1])/(e-t+1);a=r[e]-r[t-1]-(e-t+1)*i*i}else a=r[e]-n[e]*n[e]/(e+1);return a<0?0:a}function a(t,e,n,i,s,o,c){if(!(t>e)){var l=Math.floor((t+e)/2);i[n][l]=i[n-1][l-1],s[n][l]=l;var u=n;t>n&&(u=Math.max(u,s[n][t-1]||0)),u=Math.max(u,s[n-1][l]||0);var h,f,p,d=l-1;e<i.length-1&&(d=Math.min(d,s[n][e+1]||0));for(var m=d;m>=u&&!((h=r(m,l,o,c))+i[n-1][u-1]>=i[n][l]);--m)(f=r(u,l,o,c)+i[n-1][u-1])<i[n][l]&&(i[n][l]=f,s[n][l]=u),u++,(p=h+i[n-1][m-1])<i[n][l]&&(i[n][l]=p,s[n][l]=m);a(t,l-1,n,i,s,o,c),a(l+1,e,n,i,s,o,c)}}function i(t,e,n){for(var i=e[0].length,s=new Array(i),o=new Array(i),c=t[Math.floor(i/2)],l=0;l<i;++l)0===l?(s[0]=t[0]-c,o[0]=(t[0]-c)*(t[0]-c)):(s[l]=s[l-1]+t[l]-c,o[l]=o[l-1]+(t[l]-c)*(t[l]-c)),e[0][l]=r(0,l,s,o),n[0][l]=0;for(var u=1;u<e.length;++u)a(u<e.length-1?u:i-1,i-1,u,e,n,s,o)}function s(r,a){if(a>r.length)throw new Error("Cannot generate more classes than there are data values");var s=r.length,o=t(r),c=e(o);if(1===c)return[o];var l=n(a=Math.min(c,a),s),u=n(a,s);i(o,l,u);for(var h=[],f=u[0].length-1,p=u.length-1;p>=0;p--){var d=u[p][f];h[p]=o[d],p>0&&(f=d-1)}return h}var o=s;function c(){var t=!1,e=[],n=[],r=[],a=function(e){if(t){for(var a=r.length-1;a>=0;a--)if(e>=r[a])return n[a];return n[0]}};function i(){if(!(n.length<=2)){var a=o(e,Math.min(e.length,n.length));t=0!==a.length,r=[];for(var i=0;i<a.length;i++)r.push(a[i])}}return a.domain=function(){return arguments.length?(e=arguments[0],i(),a):e},a.range=function(){if(arguments.length){var t=arguments[0],e=t.length!==n.length;return n=t,e&&i(),a}return n},a.invertExtent=function(t){for(var e=NaN,a=NaN,i=0;i<n.length;i++)if(n[i]===t){e=r[i],a=i+1<n.length?r[i+1]:NaN;break}return[e,a]},a.clusters=function(){return r.slice(1)},a.export=function(){return{isReady:t,domain:e,range:n,breakpoints:r}},a.import=function(i){if(!i)throw new Error("Import requires parameters");return t=i.isReady,e=i.domain,n=i.range,r=i.breakpoints,a},a.copy=function(){return c().domain(e).range(n)},a}return"object"==typeof d3&&(d3.scaleCluster=c),c}();var fi=r(hi.exports);y(".heat-map-legend-bar{margin:0 1px;transition:height .2s;width:10px}.heat-map-legend-summary{align-items:center;display:flex;height:20px}.heat-map-legend{align-items:baseline;align-self:flex-end;display:flex;float:right;font-size:12px}.heat-map-legend-summary-min-caption{text-align:right;width:32px}.heat-map-legend-caption{margin:0 8px}.heat-map-legend-summary-graphics{display:flex;height:20px;margin:0 8px}.sunburst-container{margin:auto;width:50%}.rv-sunburst{margin:0 auto}#calcButton{display:block;margin-left:auto;margin-right:auto}.rv-sunburst__series--radial__arc,.rv-xy-plot__series,.rv-xy-plot__series--arc-path{cursor:pointer}#root-cell-tooltip{display:inline-block;left:0;margin:auto;position:absolute;right:0;text-align:center;z-index:10}.rv-hint{z-index:10}");var pi=function(t,e){for(var n=-1,r=e.length,a=t.length;++n<r;)t[a+n]=e[n];return t},di=un,mi=hn,gi=q?q.isConcatSpreadable:void 0;var vi=pi,yi=function(t){return mi(t)||di(t)||!!(gi&&t&&t[gi])};var _i=function t(e,n,r,a,i){var s=-1,o=e.length;for(r||(r=yi),i||(i=[]);++s<o;){var c=e[s];n>0&&r(c)?n>1?t(c,n-1,r,a,i):vi(i,c):a||(i[i.length]=c)}return i},bi=hn,wi=it,xi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ei=/^\w*$/;var Si=function(t,e){if(bi(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!wi(t))||(Ei.test(t)||!xi.test(t)||null!=e&&t in Object(e))},Ci=Ut(Object,"create"),ji=Ci;var Ti=function(){this.__data__=ji?ji(null):{},this.size=0};var Di=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Ai=Ci,Ni=Object.prototype.hasOwnProperty;var Oi=function(t){var e=this.__data__;if(Ai){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Ni.call(e,t)?e[t]:void 0},ki=Ci,Mi=Object.prototype.hasOwnProperty;var Ri=Ci;var Ii=Ti,Pi=Di,Li=Oi,$i=function(t){var e=this.__data__;return ki?void 0!==e[t]:Mi.call(e,t)},Hi=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Ri&&void 0===e?"__lodash_hash_undefined__":e,this};function Ui(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ui.prototype.clear=Ii,Ui.prototype.delete=Pi,Ui.prototype.get=Li,Ui.prototype.has=$i,Ui.prototype.set=Hi;var Bi=Ui;var Fi=function(){this.__data__=[],this.size=0};var zi=function(t,e){return t===e||t!=t&&e!=e},qi=zi;var Yi=function(t,e){for(var n=t.length;n--;)if(qi(t[n][0],e))return n;return-1},Vi=Yi,Wi=Array.prototype.splice;var Gi=Yi;var Xi=Yi;var Ji=Yi;var Ki=Fi,Zi=function(t){var e=this.__data__,n=Vi(e,t);return!(n<0)&&(n==e.length-1?e.pop():Wi.call(e,n,1),--this.size,!0)},Qi=function(t){var e=this.__data__,n=Gi(e,t);return n<0?void 0:e[n][1]},ts=function(t){return Xi(this.__data__,t)>-1},es=function(t,e){var n=this.__data__,r=Ji(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function ns(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ns.prototype.clear=Ki,ns.prototype.delete=Zi,ns.prototype.get=Qi,ns.prototype.has=ts,ns.prototype.set=es;var rs=ns,as=Bi,is=rs,ss=Pe;var os=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var cs=function(t,e){var n=t.__data__;return os(e)?n["string"==typeof e?"string":"hash"]:n.map},ls=cs;var us=cs;var hs=cs;var fs=cs;var ps=function(){this.size=0,this.__data__={hash:new as,map:new(ss||is),string:new as}},ds=function(t){var e=ls(this,t).delete(t);return this.size-=e?1:0,e},ms=function(t){return us(this,t).get(t)},gs=function(t){return hs(this,t).has(t)},vs=function(t,e){var n=fs(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function ys(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ys.prototype.clear=ps,ys.prototype.delete=ds,ys.prototype.get=ms,ys.prototype.has=gs,ys.prototype.set=vs;var _s=ys,bs=_s;function ws(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,a=e?e.apply(this,r):r[0],i=n.cache;if(i.has(a))return i.get(a);var s=t.apply(this,r);return n.cache=i.set(a,s)||i,s};return n.cache=new(ws.Cache||bs),n}ws.Cache=bs;var xs=ws;var Es=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ss=/\\(\\)?/g,Cs=function(t){var e=xs(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Es,(function(t,n,r,a){e.push(r?a.replace(Ss,"$1"):n||t)})),e})),js=hn,Ts=Si,Ds=Cs,As=ur;var Ns=function(t,e){return js(t)?t:Ts(t,e)?[t]:Ds(As(t))},Os=it;var ks=function(t){if("string"==typeof t||Os(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},Ms=Ns,Rs=ks;var Is=function(t,e){for(var n=0,r=(e=Ms(e,t)).length;null!=t&&n<r;)t=t[Rs(e[n++])];return n&&n==r?t:void 0},Ps=rs;var Ls=rs,$s=Pe,Hs=_s;var Us=rs,Bs=function(){this.__data__=new Ps,this.size=0},Fs=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},zs=function(t){return this.__data__.get(t)},qs=function(t){return this.__data__.has(t)},Ys=function(t,e){var n=this.__data__;if(n instanceof Ls){var r=n.__data__;if(!$s||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Hs(r)}return n.set(t,e),this.size=n.size,this};function Vs(t){var e=this.__data__=new Us(t);this.size=e.size}Vs.prototype.clear=Bs,Vs.prototype.delete=Fs,Vs.prototype.get=zs,Vs.prototype.has=qs,Vs.prototype.set=Ys;var Ws=Vs;var Gs=_s,Xs=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Js=function(t){return this.__data__.has(t)};function Ks(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Gs;++e<n;)this.add(t[e])}Ks.prototype.add=Ks.prototype.push=Xs,Ks.prototype.has=Js;var Zs=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1};var Qs=Ks,to=Zs,eo=function(t,e){return t.has(e)};var no=function(t,e,n,r,a,i){var s=1&n,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var l=i.get(t),u=i.get(e);if(l&&u)return l==e&&u==t;var h=-1,f=!0,p=2&n?new Qs:void 0;for(i.set(t,e),i.set(e,t);++h<o;){var d=t[h],m=e[h];if(r)var g=s?r(m,d,h,e,t,i):r(d,m,h,t,e,i);if(void 0!==g){if(g)continue;f=!1;break}if(p){if(!to(e,(function(t,e){if(!eo(p,e)&&(d===t||a(d,t,n,r,i)))return p.push(e)}))){f=!1;break}}else if(d!==m&&!a(d,m,n,r,i)){f=!1;break}}return i.delete(t),i.delete(e),f};var ro=z.Uint8Array,ao=zi,io=no,so=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n},oo=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},co=q?q.prototype:void 0,lo=co?co.valueOf:void 0;var uo=function(t,e,n,r,a,i,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new ro(t),new ro(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ao(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var o=so;case"[object Set]":var c=1&r;if(o||(o=oo),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;r|=2,s.set(t,e);var u=io(o(t),o(e),r,a,i,s);return s.delete(t),u;case"[object Symbol]":if(lo)return lo.call(t)==lo.call(e)}return!1},ho=pi,fo=hn;var po=function(t,e,n){var r=e(t);return fo(t)?r:ho(r,n(t))};var mo=Qt,go=function(){return[]},vo=Object.prototype.propertyIsEnumerable,yo=Object.getOwnPropertySymbols,_o=yo?function(t){return null==t?[]:(t=Object(t),mo(yo(t),(function(e){return vo.call(t,e)})))}:go,bo=/^(?:0|[1-9]\d*)$/;var wo=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&bo.test(t))&&t>-1&&t%1==0&&t<e},xo=ne,Eo=un,So=hn,Co=dn,jo=wo,To=jn,Do=Object.prototype.hasOwnProperty;var Ao=function(t,e){var n=So(t),r=!n&&Eo(t),a=!n&&!r&&Co(t),i=!n&&!r&&!a&&To(t),s=n||r||a||i,o=s?xo(t.length,String):[],c=o.length;for(var l in t)!e&&!Do.call(t,l)||s&&("length"==l||a&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||jo(l,c))||o.push(l);return o},No=Re,Oo=se;var ko=function(t){return Oo(t)?Ao(t):No(t)},Mo=po,Ro=_o,Io=ko;var Po=function(t){return Mo(t,Io,Ro)},Lo=Object.prototype.hasOwnProperty;var $o=Ws,Ho=no,Uo=uo,Bo=function(t,e,n,r,a,i){var s=1&n,o=Po(t),c=o.length;if(c!=Po(e).length&&!s)return!1;for(var l=c;l--;){var u=o[l];if(!(s?u in e:Lo.call(e,u)))return!1}var h=i.get(t),f=i.get(e);if(h&&f)return h==e&&f==t;var p=!0;i.set(t,e),i.set(e,t);for(var d=s;++l<c;){var m=t[u=o[l]],g=e[u];if(r)var v=s?r(g,m,u,e,t,i):r(m,g,u,t,e,i);if(!(void 0===v?m===g||a(m,g,n,r,i):v)){p=!1;break}d||(d="constructor"==u)}if(p&&!d){var y=t.constructor,_=e.constructor;y==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(p=!1)}return i.delete(t),i.delete(e),p},Fo=en,zo=hn,qo=dn,Yo=jn,Vo="[object Arguments]",Wo="[object Array]",Go="[object Object]",Xo=Object.prototype.hasOwnProperty;var Jo=function(t,e,n,r,a,i){var s=zo(t),o=zo(e),c=s?Wo:Fo(t),l=o?Wo:Fo(e),u=(c=c==Vo?Go:c)==Go,h=(l=l==Vo?Go:l)==Go,f=c==l;if(f&&qo(t)){if(!qo(e))return!1;s=!0,u=!1}if(f&&!u)return i||(i=new $o),s||Yo(t)?Ho(t,e,n,r,a,i):Uo(t,e,c,n,r,a,i);if(!(1&n)){var p=u&&Xo.call(t,"__wrapped__"),d=h&&Xo.call(e,"__wrapped__");if(p||d){var m=p?t.value():t,g=d?e.value():e;return i||(i=new $o),a(m,g,n,r,i)}}return!!f&&(i||(i=new $o),Bo(t,e,n,r,a,i))},Ko=nt;var Zo=function t(e,n,r,a,i){return e===n||(null==e||null==n||!Ko(e)&&!Ko(n)?e!=e&&n!=n:Jo(e,n,r,a,t,i))},Qo=Ws,tc=Zo;var ec=yt;var nc=function(t){return t==t&&!ec(t)},rc=nc,ac=ko;var ic=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}},sc=function(t,e,n,r){var a=n.length,i=a,s=!r;if(null==t)return!i;for(t=Object(t);a--;){var o=n[a];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++a<i;){var c=(o=n[a])[0],l=t[c],u=o[1];if(s&&o[2]){if(void 0===l&&!(c in t))return!1}else{var h=new Qo;if(r)var f=r(l,u,c,t,e,h);if(!(void 0===f?tc(u,l,3,r,h):f))return!1}}return!0},oc=function(t){for(var e=ac(t),n=e.length;n--;){var r=e[n],a=t[r];e[n]=[r,a,rc(a)]}return e},cc=ic;var lc=Is;var uc=Ns,hc=un,fc=hn,pc=wo,dc=re,mc=ks;var gc=function(t,e){return null!=t&&e in Object(t)},vc=function(t,e,n){for(var r=-1,a=(e=uc(e,t)).length,i=!1;++r<a;){var s=mc(e[r]);if(!(i=null!=t&&n(t,s)))break;t=t[s]}return i||++r!=a?i:!!(a=null==t?0:t.length)&&dc(a)&&pc(s,a)&&(fc(t)||hc(t))};var yc=Zo,_c=function(t,e,n){var r=null==t?void 0:lc(t,e);return void 0===r?n:r},bc=function(t,e){return null!=t&&vc(t,e,gc)},wc=Si,xc=nc,Ec=ic,Sc=ks;var Cc=Is;var jc=ee,Tc=function(t){return function(e){return Cc(e,t)}},Dc=Si,Ac=ks;var Nc=function(t){var e=oc(t);return 1==e.length&&e[0][2]?cc(e[0][0],e[0][1]):function(n){return n===t||sc(n,t,e)}},Oc=function(t,e){return wc(t)&&xc(e)?Ec(Sc(t),e):function(n){var r=_c(n,t);return void 0===r&&r===e?bc(n,t):yc(e,r,3)}},kc=ct,Mc=hn,Rc=function(t){return Dc(t)?jc(Ac(t)):Tc(t)};var Ic=function(t){return"function"==typeof t?t:null==t?kc:"object"==typeof t?Mc(t)?Oc(t[0],t[1]):Nc(t):Rc(t)};var Pc=function(t){return function(e,n,r){for(var a=-1,i=Object(e),s=r(e),o=s.length;o--;){var c=s[t?o:++a];if(!1===n(i[c],c,i))break}return e}}(),Lc=ko;var $c=se;var Hc=function(t,e){return function(n,r){if(null==n)return n;if(!$c(n))return t(n,r);for(var a=n.length,i=e?a:-1,s=Object(n);(e?i--:++i<a)&&!1!==r(s[i],i,s););return n}}((function(t,e){return t&&Pc(t,e,Lc)})),Uc=se;var Bc=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t},Fc=it;var zc=function(t,e){if(t!==e){var n=void 0!==t,r=null===t,a=t==t,i=Fc(t),s=void 0!==e,o=null===e,c=e==e,l=Fc(e);if(!o&&!l&&!i&&t>e||i&&s&&c&&!o&&!l||r&&s&&c||!n&&c||!a)return 1;if(!r&&!i&&!l&&t<e||l&&n&&a&&!r&&!i||o&&n&&a||!s&&a||!c)return-1}return 0};var qc=te,Yc=Is,Vc=Ic,Wc=function(t,e){var n=-1,r=Uc(t)?Array(t.length):[];return Hc(t,(function(t,a,i){r[++n]=e(t,a,i)})),r},Gc=Bc,Xc=bn,Jc=function(t,e,n){for(var r=-1,a=t.criteria,i=e.criteria,s=a.length,o=n.length;++r<s;){var c=zc(a[r],i[r]);if(c)return r>=o?c:c*("desc"==n[r]?-1:1)}return t.index-e.index},Kc=ct,Zc=hn;var Qc=zi,tl=se,el=wo,nl=yt;var rl=_i,al=function(t,e,n){e=e.length?qc(e,(function(t){return Zc(t)?function(e){return Yc(e,1===t.length?t[0]:t)}:t})):[Kc];var r=-1;e=qc(e,Xc(Vc));var a=Wc(t,(function(t,n,a){return{criteria:qc(e,(function(e){return e(t)})),index:++r,value:t}}));return Gc(a,(function(t,e){return Jc(t,e,n)}))},il=function(t,e,n){if(!nl(n))return!1;var r=typeof e;return!!("number"==r?tl(n)&&el(e,n.length):"string"==r&&e in n)&&Qc(n[e],t)},sl=r(Zt((function(t,e){if(null==t)return[];var n=e.length;return n>1&&il(t,e[0],e[1])?e=[]:n>2&&il(e[0],e[1],e[2])&&(e=[e[0]]),al(t,rl(e,1),[])})));var ol=function(t,e,n){var r=-1,a=t.length;e<0&&(e=-e>a?0:a+e),(n=n>a?a:n)<0&&(n+=a),a=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(a);++r<a;)i[r]=t[r+e];return i},cl=ol,ll=nr;var ul=function(t,e,n){return t&&t.length?(e=n||void 0===e?1:ll(e),cl(t,0,e<0?0:e)):[]},hl=r(ul);const fl={backgroundColor:"rgb(241, 231, 119)",height:"4px"},pl={backgroundColor:"rgb(197, 213, 108)",height:"6px"},dl={backgroundColor:"rgb(159, 197, 99)",height:"8px"},ml={backgroundColor:"rgb(141, 184, 101)",height:"10px"},gl={backgroundColor:"rgb(107, 151, 117)",height:"12px"},vl=()=>m.createElement("div",{className:"heat-map-legend"},m.createElement("div",{className:"heat-map-legend-caption"},"Variation"),m.createElement("div",{className:"heat-map-legend-summary"},m.createElement("div",{className:"heat-map-legend-summary-min-caption"},"Low"),m.createElement("div",{className:"heat-map-legend-summary-graphics"},[fl,pl,dl,ml,gl].map(((t,e)=>m.createElement("div",{key:e,className:"heat-map-legend-bar",style:t})))),m.createElement("div",{className:"heat-map-legend-summary-max-caption"},"High")));class yl extends m.Component{constructor(t){super(t),this.state={isUpdate:0,isPending:!1,simhashData:null},this._clusters=[]}componentDidUpdate(){this.state.isUpdate<2&&(oi(),this.setState({isUpdate:this.state.isUpdate+1}))}render(){const{url:t,conf:e,loader:n}=this.props,{countCaptures:r,error:a,simhashData:i,timestamp:s}=this.state;if(a)return m.createElement(Bn,{url:t,code:a,timestamp:s||this.props.timestamp,conf:e,errorHandledCallback:this.errorHandled});if(i){const n=this.state.timestamp.substring(0,4);return m.createElement("div",{className:"sunburst-container"},this.state.isPending&&m.createElement("p",null,"The Simhash data for ",t," and year ",n," are still being generated. For more results please try again in a moment."),m.createElement("div",null,"This diagram illustrates the differences of ",m.createElement("a",{href:"/web/*/".concat(t)},t)," capture ",m.createElement("a",{href:e.snapshotsPrefix+s+"/"+t},Se(s))," compared to"," ",r," other captures of the same URL for ",n,"."),m.createElement(ui,{urlPrefix:e.urlPrefix,url:t,simhashData:i}),m.createElement("div",{style:{clear:"both"}},m.createElement(vl,null)))}const o=()=>C(n)?m.createElement(j,null):n;return s?this._fetchTimestampSimhashData():this._validateTimestamp(),m.createElement("div",{className:"loading"},m.createElement(o,null))}_validateTimestamp(){const{url:t,conf:e,timestamp:n}=this.props,r=new URL(e.cdxServer,window.location.origin);r.searchParams.append("url",t),r.searchParams.append("closest",n),r.searchParams.append("filter","!mimetype:warc/revisit"),r.searchParams.append("sort","closest"),r.searchParams.append("limit","1"),r.searchParams.append("fl","timestamp"),we(r).then(_e).then((t=>t.json())).then((r=>{const a=r.toString(),i=n!==a?a:n,s="".concat(e.diffgraphPrefix).concat(a,"/").concat(t);window.history.pushState({},"",s),this.setState({timestamp:i})})).catch((t=>{"Unexpected end of JSON input"===t.message?this.errorHandled("NO_CAPTURES"):this.errorHandled(t.message)}))}errorHandled(t){this.setState({error:t})}_fetchTimestampSimhashData(){const{url:t,conf:e}=this.props,{timestamp:n}=this.state;we(e.waybackDiscoverDiff+"/simhash?url="+encodeURIComponent(t)+"&timestamp="+n).then(_e).then((t=>t.json())).then((t=>{if(t.status)throw Error(t.message);this._fetchSimhashData(ci(t,n))})).catch((t=>{this.errorHandled(t.message)}))}_fetchSimhashData(t){const{url:e,conf:n}=this.props,{timestamp:r}=this.state;let a=n.waybackDiscoverDiff+"/simhash?url="+encodeURIComponent(e)+"&year="+r.substring(0,4);n.compressedSimhash&&(a+="&compress=1"),we(a).then(_e).then((t=>t.json())).then((e=>{this.setState({isPending:"PENDING"===e.status});const r=n.compressedSimhash?function(t){const e=[],n=t.captures[0][0];for(let r=1;r<t.captures[0].length;r++){const a=t.captures[0][r][0];for(let i=1;i<t.captures[0][r].length;i++){const s=t.captures[0][r][i][0];for(let o=1;o<t.captures[0][r][i].length;o++){const[c,l]=t.captures[0][r][i][o],u=t.hashes[l],h="".concat(n).concat(xe(a)).concat(xe(s)).concat(c);e.push([h,u])}}}return e}(e):ci(e),a=this._calcDistanceAndScales(r,t);Pn(a)||this._createLevels(a,t)})).catch((t=>{this.errorHandled(t.message)}))}_calcDistanceAndScales(t,e){const n=t.map((t=>{const n=ve(e[1],t[1]);return t[1]=100*n,0!==n?100*n:null})).filter(Boolean);if(0!==n.length){for(this.setState({countCaptures:n.length}),this._clusters=fi().domain(n).range([1,2,3,4,5]).clusters();this._clusters.length<5;)this._clusters.push(101);return t}this.errorHandled("NO_DIFFERENT_CAPTURES")}_createLevels(t,e){const{conf:n}=this.props;let r=[],a=[],i=[],s=[],o=[];const c=["#dddddd","#f1e777","#c5d56c","#8db865","#6b9775","#4d7a83"];for(let e=0;e<t.length;e++)0!==t[e][1]&&(t[e][1]<=this._clusters[0]?r.push({name:Se(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:c[1],children:[]}):t[e][1]<=this._clusters[1]?a.push({name:Se(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:c[2],children:[]}):t[e][1]<=this._clusters[2]?i.push({name:Se(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:c[3],children:[]}):t[e][1]<=this._clusters[3]?s.push({name:Se(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:c[4],children:[]}):t[e][1]<=this._clusters[4]&&o.push({name:Se(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:c[5],children:[]}));let l=4;for(;0===r.length&&l>0;)r=a,a=i,i=s,s=o,o=[],l-=1;for(l=3;0===a.length&&l>0;)a=i,i=s,s=o,o=[],l-=1;for(l=2;0===i.length&&l>0;)i=s,s=o,o=[],l-=1;function u(t,e){for(let n=0;n<e.length;n++){const r=n%t.length;t[r].children.push(e[n]),t[r].bigness=""}}0===s.length&&(s=o,o=[]),r=hl(sl(r,[function(t){return t.timestamp}]),n.maxSunburstLevelLength),a=hl(sl(a,[function(t){return t.timestamp}]),n.maxSunburstLevelLength),i=hl(sl(i,[function(t){return t.timestamp}]),n.maxSunburstLevelLength),s=hl(sl(s,[function(t){return t.timestamp}]),n.maxSunburstLevelLength),o=hl(sl(o,[function(t){return t.timestamp}]),n.maxSunburstLevelLength),u(s,o),u(i,s),u(a,i),u(r,a),this.setState({simhashData:{name:Se(e[0]),timestamp:e[0],clr:c[0],children:r,similarity:-1}})}}t(yl,"displayName","SunburstContainer"),t(yl,"propTypes",{timestamp:v.string.isRequired,url:v.string.isRequired,conf:v.object.isRequired,loader:v.element});export{Fn as DiffContainer,yl as SunburstContainer};
//# sourceMappingURL=app.js.map
