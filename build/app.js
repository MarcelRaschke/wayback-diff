function t(){return t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.apply(null,arguments)}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r,i,a,s={exports:{}},o={};function l(){if(i)return r;i=1;var t=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;return r=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(r,i){for(var a,s,o=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(r),l=1;l<arguments.length;l++){for(var u in a=Object(arguments[l]))e.call(a,u)&&(o[u]=a[u]);if(t){s=t(a);for(var c=0;c<s.length;c++)n.call(a,s[c])&&(o[s[c]]=a[s[c]])}}return o},r}
/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */s.exports=function(){if(a)return o;a=1;var t=l(),e=60103,n=60106;o.Fragment=60107,o.StrictMode=60108,o.Profiler=60114;var r=60109,i=60110,s=60112;o.Suspense=60113;var u=60115,c=60116;if("function"==typeof Symbol&&Symbol.for){var h=Symbol.for;e=h("react.element"),n=h("react.portal"),o.Fragment=h("react.fragment"),o.StrictMode=h("react.strict_mode"),o.Profiler=h("react.profiler"),r=h("react.provider"),i=h("react.context"),s=h("react.forward_ref"),o.Suspense=h("react.suspense"),u=h("react.memo"),c=h("react.lazy")}var f="function"==typeof Symbol&&Symbol.iterator;function p(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function g(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||d}function v(){}function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||d}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(p(85));this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=g.prototype;var _=y.prototype=new v;_.constructor=y,t(_,g.prototype),_.isPureReactComponent=!0;var b={current:null},w=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function E(t,n,r){var i,a={},s=null,o=null;if(null!=n)for(i in void 0!==n.ref&&(o=n.ref),void 0!==n.key&&(s=""+n.key),n)w.call(n,i)&&!x.hasOwnProperty(i)&&(a[i]=n[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:e,type:t,key:s,ref:o,props:a,_owner:b.current}}function S(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}var k=/\/+/g;function C(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function N(t,r,i,a,s){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var l=!1;if(null===t)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case e:case n:l=!0}}if(l)return s=s(l=t),t=""===a?"."+C(l,0):a,Array.isArray(s)?(i="",null!=t&&(i=t.replace(k,"$&/")+"/"),N(s,r,i,"",(function(t){return t}))):null!=s&&(S(s)&&(s=function(t,n){return{$$typeof:e,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+t)),r.push(s)),1;if(l=0,a=""===a?".":a+":",Array.isArray(t))for(var u=0;u<t.length;u++){var c=a+C(o=t[u],u);l+=N(o,r,i,c,s)}else if(c=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"==typeof c)for(t=c.call(t),u=0;!(o=t.next()).done;)l+=N(o=o.value,r,i,c=a+C(o,u++),s);else if("object"===o)throw r=""+t,Error(p(31,"[object Object]"===r?"object with keys {"+Object.keys(t).join(", ")+"}":r));return l}function A(t,e,n){if(null==t)return t;var r=[],i=0;return N(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function T(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var j={current:null};function D(){var t=j.current;if(null===t)throw Error(p(321));return t}var $={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:t};return o.Children={map:A,forEach:function(t,e,n){A(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!S(t))throw Error(p(143));return t}},o.Component=g,o.PureComponent=y,o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,o.cloneElement=function(n,r,i){if(null==n)throw Error(p(267,n));var a=t({},n.props),s=n.key,o=n.ref,l=n._owner;if(null!=r){if(void 0!==r.ref&&(o=r.ref,l=b.current),void 0!==r.key&&(s=""+r.key),n.type&&n.type.defaultProps)var u=n.type.defaultProps;for(c in r)w.call(r,c)&&!x.hasOwnProperty(c)&&(a[c]=void 0===r[c]&&void 0!==u?u[c]:r[c])}var c=arguments.length-2;if(1===c)a.children=i;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];a.children=u}return{$$typeof:e,type:n.type,key:s,ref:o,props:a,_owner:l}},o.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:i,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:r,_context:t},t.Consumer=t},o.createElement=E,o.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},o.createRef=function(){return{current:null}},o.forwardRef=function(t){return{$$typeof:s,render:t}},o.isValidElement=S,o.lazy=function(t){return{$$typeof:c,_payload:{_status:-1,_result:t},_init:T}},o.memo=function(t,e){return{$$typeof:u,type:t,compare:void 0===e?null:e}},o.useCallback=function(t,e){return D().useCallback(t,e)},o.useContext=function(t,e){return D().useContext(t,e)},o.useDebugValue=function(){},o.useEffect=function(t,e){return D().useEffect(t,e)},o.useImperativeHandle=function(t,e,n){return D().useImperativeHandle(t,e,n)},o.useLayoutEffect=function(t,e){return D().useLayoutEffect(t,e)},o.useMemo=function(t,e){return D().useMemo(t,e)},o.useReducer=function(t,e,n){return D().useReducer(t,e,n)},o.useRef=function(t){return D().useRef(t)},o.useState=function(t){return D().useState(t)},o.version="17.0.2",o}();var u,c,h,f,p=s.exports,d=n(p),m={exports:{}};m.exports=function(){if(f)return h;f=1;var t=c?u:(c=1,u="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");function e(){}function n(){}return n.resetWarningCache=e,h=function(){function r(e,n,r,i,a,s){if(s!==t){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function i(){return r}r.isRequired=r;var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:e};return a.PropTypes=a,a}}()();var g=n(m.exports);function v(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}v(".inline-render,.side-by-side-render{display:flex;flex:1 0 auto}.inline-render>iframe,.side-by-side-render>div,.side-by-side-render>iframe{border:1px solid #ccc;border-radius:2px;width:100%}.side-by-side-render>iframe:first-of-type{margin-right:.5em}.diff-view__alert.alert.alert-warning{text-align:center}.loading{align-items:center;background:#0000;display:flex;justify-content:center}");const y={genericType:"*/*",mediaType:"*/*",type:"*",subType:"*",equals(t){return!!t&&this.mediaType===t.mediaType}};_("text","html");function _(t,e){return t=t||"*",e=e||"*",Object.assign(Object.create(y),{genericType:`${t}/*`,mediaType:`${t}/${e||"*"}`,type:t,subtype:e})}_("application","pdf"),_("application","wsdl+xml"),_("application","xml"),_("text","*"),_("text","calendar"),_("text","plain"),_("application","rss+xml"),_("image","jpeg"),_("application","x-tgif"),_("application","msword"),_("application","zip"),_("application","atom+xml"),_("application","excel"),_("application","powerpoint"),_("image","gif"),_("application","rtf"),_("text","csv"),_("application","vnd.ms-excel"),_("application","vnd.openxmlformats-officedocument.spreadsheetml.sheet"),_("image","png"),_("application","vnd.openxmlformats-officedocument.wordprocessingml.document"),_("image","jpeg"),_("audio","mpeg"),_("application","postscript");const b={RAW_FROM_CONTENT:{description:"“From” Version"},RAW_TO_CONTENT:{description:"“To” Version"},RAW_SIDE_BY_SIDE:{description:"Side-by-side Content"},HIGHLIGHTED_TEXT:{description:"Highlighted Text",diffService:"html_text_dmp"},HIGHLIGHTED_SOURCE:{description:"Highlighted Source",diffService:"html_source_dmp"},HIGHLIGHTED_RENDERED:{description:"Highlighted Rendered",diffService:"html_token"},SIDE_BY_SIDE_RENDERED:{description:"Side-by-Side Rendered",diffService:"html_token",options:{include:"all"}},OUTGOING_LINKS:{description:"Outgoing Links",diffService:"links"},CHANGES_ONLY_TEXT:{description:"Changes Only Text",diffService:"html_text_dmp"},CHANGES_ONLY_SOURCE:{description:"Changes Only Source",diffService:"html_source_dmp"}};for(const t in b)b[t].value=t;class w extends d.Component{static propTypes=(()=>({data:g.object,onSelect:g.func}))();render(){const{data:t,onSelect:e}=this.props,n={};let r="unchanged";const[i,a]=t;return-1===i?(r="removed",n.background="#ffc0cb"):1===i&&(r="added",n.background="#90ee90"),d.createElement("span",{className:`diff item ${r}`,style:n,onClick:e},a)}}class x extends d.Component{static propTypes=(()=>({data:g.object,onSelectItem:g.func,className:g.string}))();render(){const{data:t,onSelectItem:e,className:n}=this.props,r=(t,e,n)=>()=>{t&&t(n,e)},i=t.map(((t,n)=>d.createElement(this.props.component,{data:t,key:n,index:n,onSelect:r(e,t,n)})));return d.createElement("div",{className:n},i)}}class E extends d.Component{static propTypes=(()=>({diffData:g.object,className:g.string}))();render(){return d.createElement(x,{data:this.props.diffData.diff,component:w,className:this.props.className})}}var S=n((function(t){return null==t}));class k extends d.Component{render(){return d.createElement("span",null,"Loading...")}}class C extends d.PureComponent{static propTypes=(()=>({loader:g.object}))();constructor(t){super(t),this.state={loaderStyle:null}}render(){const t=()=>S(this.props.loader)?d.createElement(k,null):this.props.loader;return d.createElement("div",{style:this.state.loaderStyle},this.state.loaderStyle&&d.createElement(t,null))}setLoaderStyle(t){this.setState({loaderStyle:t})}}class N extends d.PureComponent{static propTypes=(()=>({loader:g.object,html:g.string,transform:g.func,baseUrl:g.string}))();constructor(t){super(t),this.loaderRef=d.createRef(),this._frame=null}componentDidMount(){this._updateContent(),this.addLoaderImg()}componentDidUpdate(){this._updateContent()}render(){return d.createElement("div",null,d.createElement("iframe",{height:window.innerHeight,width:"100%",onLoad:()=>{this.handleHeight(),this.removeLoaderImg()},sandbox:"allow-same-origin allow-forms allow-scripts",ref:t=>{this._frame=t}}),d.createElement(C,{ref:this.loaderRef,loader:this.props.loader}))}_updateContent(){const t=function(t,e){let n=(new DOMParser).parseFromString(t,"text/html");return n=e(n),`<!doctype html>\n${n.documentElement.outerHTML}`}(this.props.html,(t=>(this.props.transform&&(t=this.props.transform(t)||t),function(t,e){if(e){const n=t.querySelector("base")||t.createElement("base");n.href=e;const r=t.querySelector("meta[charset]");let i=t.head.firstChild;r&&(i=r.nextSibling),i?i.parentNode.insertBefore(n,i):t.head.appendChild(n)}return t}(t,this.props.baseUrl))));this._frame.setAttribute("srcdoc",t)}handleHeight(){const t=this._frame.contentDocument.documentElement.scrollHeight;t>.1*this._frame.height?this._frame.height=t+.01*t:this._frame.height=.5*this._frame.height}removeLoaderImg(){this.loaderRef.current.setLoaderStyle(null)}addLoaderImg(){const t=this._frame.contentDocument.scrollingElement.offsetWidth,e=this._frame.offsetLeft+t/2;this.loaderRef.current.setLoaderStyle({position:"absolute",left:e+"px",top:"50%"})}}class A extends d.Component{static propTypes=(()=>({diffData:g.object,page:g.object}))();render(){const t=this.props.diffData.combined||this.props.diffData.diff;return d.createElement("div",{className:"inline-render"},d.createElement(N,{html:t,baseUrl:this.props.page.url}))}}const T=$.bind(null,"removals"),j=$.bind(null,"additions");class D extends d.Component{static propTypes=(()=>({diffData:g.object,page:g.object,loader:g.object}))();render(){let t=t=>t,e=t;return this.props.diffData.deletions||(t=T,e=j),d.createElement("div",{className:"side-by-side-render"},d.createElement(N,{loader:this.props.loader,html:this.props.diffData.deletions||this.props.diffData.diff,baseUrl:this.props.page.url,transform:t}),d.createElement(N,{loader:this.props.loader,html:this.props.diffData.insertions||this.props.diffData.diff,baseUrl:this.props.page.url,transform:e}))}}function $(t,e){if("additions"!==t){const t=e.getElementById("wm-diff-old-head").content,n=e.getElementById("wm-diff-style"),r=e.querySelector('meta[name="wm-diff-title"]');e.head.innerHTML="",e.head.appendChild(t),e.head.appendChild(n),e.head.appendChild(r)}return function(t,e){function n(t){if(0===t.size)return;const e=new Set;return t.forEach((t=>{t.parentNode&&0===t.childElementCount&&/^[\s\n\r]*$/.test(t.textContent)&&(e.add(t.parentNode),t.parentNode.removeChild(t))})),n(e)}const r=new Set;e.querySelectorAll(t).forEach((t=>{r.add(t.parentNode),t.parentNode.removeChild(t)})),n(r)}("additions"===t?"del":"ins",e),function(t,e){if("additions"===t)return;e.querySelectorAll(".wm-diff-inserted-active").forEach((t=>t.remove())),e.querySelectorAll(".wm-diff-deleted-inert").forEach((t=>{const e=t.content;t.parentNode.insertBefore(e,t),t.remove()}))}(t,e),e}const M=300;class O extends d.Component{static propTypes=(()=>({diffData:g.object,className:g.string}))();render(){const t=this.props.diffData.diff.reduce(R,[]);return d.createElement(x,{data:t,component:w,className:this.props.className})}}function R(t,e,n,r){const[i,a]=e;if(0!==i)return t.concat([e]);const s=a.split("\n"),o=1===s.length;if(!o&&s.length<=3)return t.concat([e]);const l=r[n-1]&&0!==r[n-1][0],u=r[n+1]&&0!==r[n+1][0];let c=o?M:3;if(l&&u&&(c*=2),(o?s[0]:s).length<=c)return t.concat([e]);const h=[];if(l){const t=[];if(o)t.push(s[0].slice(0,M));else{const e=s.slice(0,3).map((t=>t.length>M?t.slice(0,M)+"…":t));t.push(e.join("\n")+"\n")}h.push([i,t.join("")])}if(h.push([i,"…"]),u){const t=[];if(o)t.push(s[0].slice(-300));else{const e=s.slice(0,3).map(((t,e,n)=>t.length>M?null==n[e+1]?"…"+t.slice(-300):t.slice(0,M)+"…":t));t.push("\n"+e.join("\n"))}h.push([i,t.join("")])}return t.concat(h)}class I extends d.Component{static propTypes=(()=>({content:g.string,page:g.object,version:g.string}))();render(){return this.props.content&&/^[\s\n\r]*</.test(this.props.content)?d.createElement("div",{className:"inline-render"},d.createElement(N,{html:this.props.content,baseUrl:this.props.page.url})):d.createElement("div",{className:"inline-render"},d.createElement("iframe",{src:this.props.version}))}}class P extends d.Component{static propTypes=(()=>({page:g.object,diffData:g.object,a:g.string,b:g.string}))();render(){return d.createElement("div",{className:"side-by-side-render"},L(this.props.page,this.props.a,this.props.diffData.rawA),L(this.props.page,this.props.b,this.props.diffData.rawB))}}function L(t,e,n){return n&&/^[\s\n\r]*</.test(n)?d.createElement(N,{html:n,baseUrl:t.url}):d.createElement("iframe",{src:e})}var H="object"==typeof e&&e&&e.Object===Object&&e,U=H,B="object"==typeof self&&self&&self.Object===Object&&self,q=U||B||Function("return this")(),F=q.Symbol,Y=F,z=Object.prototype,V=z.hasOwnProperty,W=z.toString,X=Y?Y.toStringTag:void 0;var G=function(t){var e=V.call(t,X),n=t[X];try{t[X]=void 0;var r=!0}catch(t){}var i=W.call(t);return r&&(e?t[X]=n:delete t[X]),i},J=Object.prototype.toString;var K=G,Z=function(t){return J.call(t)},Q=F?F.toStringTag:void 0;var tt=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Q&&Q in Object(t)?K(t):Z(t)};var et=function(t){return null!=t&&"object"==typeof t},nt=tt,rt=et;var it=function(t){return"symbol"==typeof t||rt(t)&&"[object Symbol]"==nt(t)},at=it;var st=function(t,e,n){for(var r=-1,i=t.length;++r<i;){var a=t[r],s=e(a);if(null!=s&&(void 0===o?s==s&&!at(s):n(s,o)))var o=s,l=a}return l};var ot=function(t){return t},lt=st,ut=function(t,e){return t>e},ct=ot;var ht=function(t){return t&&t.length?lt(t,ct,ut):void 0},ft=n(ht);var pt=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},dt=Math.max;var mt=function(t,e,n){return e=dt(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,a=dt(r.length-e,0),s=Array(a);++i<a;)s[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=n(s),pt(t,this,o)}};var gt=function(t){return function(){return t}};var vt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},yt=tt,_t=vt;var bt,wt=function(t){if(!_t(t))return!1;var e=yt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},xt=q["__core-js_shared__"],Et=(bt=/[^.]+$/.exec(xt&&xt.keys&&xt.keys.IE_PROTO||""))?"Symbol(src)_1."+bt:"";var St=function(t){return!!Et&&Et in t},kt=Function.prototype.toString;var Ct=function(t){if(null!=t){try{return kt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Nt=wt,At=St,Tt=vt,jt=Ct,Dt=/^\[object .+?Constructor\]$/,$t=Function.prototype,Mt=Object.prototype,Ot=$t.toString,Rt=Mt.hasOwnProperty,It=RegExp("^"+Ot.call(Rt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Pt=function(t){return!(!Tt(t)||At(t))&&(Nt(t)?It:Dt).test(jt(t))},Lt=function(t,e){return null==t?void 0:t[e]};var Ht=function(t,e){var n=Lt(t,e);return Pt(n)?n:void 0},Ut=Ht,Bt=function(){try{var t=Ut(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),qt=gt,Ft=Bt,Yt=Ft?function(t,e){return Ft(t,"toString",{configurable:!0,enumerable:!1,value:qt(e),writable:!0})}:ot,zt=Date.now;var Vt=function(t){var e=0,n=0;return function(){var r=zt(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}},Wt=Vt(Yt),Xt=ot,Gt=mt,Jt=Wt;var Kt=function(t,e){return Jt(Gt(t,e,Xt),t+"")};var Zt=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,a=[];++n<r;){var s=t[n];e(s,n,t)&&(a[i++]=s)}return a};var Qt=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i};var te=function(t){return function(e){return null==e?void 0:e[t]}};var ee=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var ne=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},re=wt,ie=ne;var ae=function(t){return null!=t&&ie(t.length)&&!re(t)},se=ae,oe=et;var le=Zt,ue=Qt,ce=te,he=ee,fe=function(t){return oe(t)&&se(t)},pe=Math.max;var de=function(t){if(!t||!t.length)return[];var e=0;return t=le(t,(function(t){if(fe(t))return e=pe(t.length,e),!0})),he(e,(function(e){return ue(t,ce(e))}))},me=n(Kt(de));const ge=/[\w\.]{2,256}\.[a-z]{2,4}/gi;function ve(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLocaleLowerCase();return(t.startsWith("ftp://")||t.startsWith("http://")||t.startsWith("https://")||function(t){return!!t.match(ge)}(t))&&!t.includes(" ")&&!t.startsWith("site:")}function ye(t,e){if(Number.isInteger(t)&&Number.isInteger(e))return _e(t^e)/32;const n=8*atob(t).length,r=8*atob(e).length,i=ft([n,r]),a=function(t,e){return me(t,e).map((t=>{let[e,n]=t;return _e(e^n)})).reduce(((t,e)=>t+e),0)}(Ne(t),Ne(e));return a/i}function _e(t){let e=0;for(;0!==t;)e++,t&=t-1;return e}function be(t){if(t){if(!t.ok)throw Error(t.status);return t}}function we(t){if(t){if(!t.ok)throw Error(t.status);return t.json()}}function xe(t,e){return new Promise((function(n,r){setTimeout((function(){r(new Error("timeout"))}),45e3),fetch(t,e).then(n,r)}))}function Ee(t){return"string"==typeof t?t:t>9?""+t:"0"+t}function Se(t,e){return Object.keys(t).find((n=>t[n]===e))}function ke(t){const e=parseInt(t.substring(0,4),10),n=parseInt(t.substring(4,6),10)-1,r=parseInt(t.substring(6,8),10),i=parseInt(t.substring(8,10),10),a=parseInt(t.substring(10,12),10),s=parseInt(t.substring(12,14),10);return new Date(Date.UTC(e,n,r,i,a,s)).toUTCString()}function Ce(t){const e=parseInt(t.substring(0,4),10),n=parseInt(t.substring(4,6),10)-1,r=parseInt(t.substring(6,8),10);return new Date(Date.UTC(e,n,r)).toUTCString().split(" ").slice(0,4).join(" ")}function Ne(t){const e=atob(t);return Uint8Array.from(e,(t=>t.charCodeAt(0)))}class Ae extends d.Component{isMountedNow=!1;static propTypes=(()=>({a:g.object,b:g.object,diffType:g.string,loader:g.object,webMonitoringProcessingURL:g.string,errorHandledCallback:g.func,page:g.object}))();constructor(t){super(t),this._abortController=new window.AbortController,this.state={diffData:null}}componentDidMount(){this.isMountedNow=!0;const{props:t}=this;this._canFetch(t)&&this._loadDiffData(t.page,t.a,t.b,t.diffType)}componentWillUnmount(){this.isMountedNow=!1,this._abortController.abort()}componentDidUpdate(t){const{props:e}=this;this._canFetch(e)&&!this._propsSpecifySameDiff(e,t)&&this._loadDiffData(e.page,e.a,e.b,e.diffType)}render(){if(!this.state.diffData){const t=()=>S(this.props.loader)?d.createElement(k,null):this.props.loader;return d.createElement("div",{className:"loading"},d.createElement(t,null))}return d.createElement("div",{className:"diff-view"},this.renderNoChangeMessage()||this.renderUndiffableMessage(),this.renderDiff())}renderNoChangeMessage(){return 0===this.state.diffData.change_count?d.createElement("div",{className:"diff-view__alert alert alert-warning"},"There were ",d.createElement("strong",null,"no changes for this diff type"),". (Other diff types may show changes.)"):null}renderUndiffableMessage(){return this.state.diffData.raw?d.createElement("div",{className:"diff-view__alert alert alert-info"},"We can’t compare the selected versions of page; you are viewing the content without deletions and insertions highlighted."):null}renderDiff(){switch(this.props.diffType){case b.RAW_SIDE_BY_SIDE.value:return d.createElement(P,{page:this.props.page,a:this.props.a,b:this.props.b,diffData:this.state.diffData});case b.RAW_FROM_CONTENT.value:return d.createElement(I,{page:this.props.page,version:this.props.a,content:this.state.diffData.rawA});case b.RAW_TO_CONTENT.value:return d.createElement(I,{page:this.props.page,version:this.props.b,content:this.state.diffData.rawB});case b.HIGHLIGHTED_RENDERED.value:return d.createElement(A,{diffData:this.state.diffData,page:this.props.page});case b.SIDE_BY_SIDE_RENDERED.value:return d.createElement(D,{diffData:this.state.diffData,page:this.props.page,loader:this.props.loader});case b.OUTGOING_LINKS.value:return d.createElement(A,{diffData:this.state.diffData,page:this.props.page});case b.HIGHLIGHTED_TEXT.value:return d.createElement(E,{diffData:this.state.diffData,className:"diff-text-inline"});case b.HIGHLIGHTED_SOURCE.value:return d.createElement(E,{diffData:this.state.diffData,className:"diff-source-inline"});case b.CHANGES_ONLY_TEXT.value:return d.createElement(O,{diffData:this.state.diffData,className:"diff-text-inline"});case b.CHANGES_ONLY_SOURCE.value:return d.createElement(O,{diffData:this.state.diffData,className:"diff-source-inline"});default:return null}}_propsSpecifySameDiff(t,e){return(e=e||this.props).a===t.a&&e.b===t.b&&e.diffType===t.diffType}_canFetch(t){return t.diffType&&t.a&&t.b}_loadDiffData(t,e,n,r){if(this.setState({diffData:null}),!b[r].diffService)return Promise.all([xe(e.uri,{mode:"cors"}),xe(n.uri,{mode:"cors"})]).then((t=>{let[e,n]=t;return{raw:!0,rawA:e,rawB:n}})).catch((t=>t)).then((t=>this.setState({diffData:t})));const i=new URL(this.props.webMonitoringProcessingURL+"/"+b[r].diffService);i.searchParams.append("strict_urls","WBM"),i.searchParams.append("format","json"),i.searchParams.append("pass_headers","cookie"),i.searchParams.append("include","all"),i.searchParams.append("a",e),i.searchParams.append("b",n),xe(i,{credentials:"include"}).then(be).then((t=>t.json())).then((t=>{this.setState({diffData:t})})).catch((t=>{this._errorHandled(t.message)}))}_errorHandled(t){this.isMountedNow&&(this.props.errorHandledCallback(t),this.setState({showError:!0}))}}v("#diff-select{margin-bottom:.7em}.timestamp-container-view{align-items:center;display:flex;justify-content:space-between}#diff-footer{text-align:center}yellow-diff-footer{background-color:#f7f417}blue-diff-footer{background-color:#1d9efd}.align-items-center>.col-auto{margin-left:auto;margin-right:auto}#year-select-left,#year-select-right,.month-select,.timestamp-select{padding-left:1px;padding-right:1px;width:auto}#explanation-middle{text-align:center}#timestamp-left{display:inline-block;float:left;margin-left:17.8%}#timestamp-right{display:inline-block;float:right;margin-right:17.8%}.wayback-ymd-timestamp{display:flex}.wayback-timestamps>*{margin-left:10px;margin-right:10px}.wayback-timestamps{display:flex;flex-flow:row wrap;justify-content:center;width:42.86%}.wayback-ymd-buttons>*{display:block;margin-left:auto;margin-right:auto}.wayback-ymd-buttons{display:flex;flex-flow:row wrap;justify-content:center;width:14.28%}");var Te=Object.prototype;var je=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Te)};var De=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),$e=je,Me=De,Oe=Object.prototype.hasOwnProperty;var Re=function(t){if(!$e(t))return Me(t);var e=[];for(var n in Object(t))Oe.call(t,n)&&"constructor"!=n&&e.push(n);return e},Ie=Ht(q,"DataView"),Pe=Ht(q,"Map"),Le=Ie,He=Pe,Ue=Ht(q,"Promise"),Be=Ht(q,"Set"),qe=Ht(q,"WeakMap"),Fe=tt,Ye=Ct,ze="[object Map]",Ve="[object Promise]",We="[object Set]",Xe="[object WeakMap]",Ge="[object DataView]",Je=Ye(Le),Ke=Ye(He),Ze=Ye(Ue),Qe=Ye(Be),tn=Ye(qe),en=Fe;(Le&&en(new Le(new ArrayBuffer(1)))!=Ge||He&&en(new He)!=ze||Ue&&en(Ue.resolve())!=Ve||Be&&en(new Be)!=We||qe&&en(new qe)!=Xe)&&(en=function(t){var e=Fe(t),n="[object Object]"==e?t.constructor:void 0,r=n?Ye(n):"";if(r)switch(r){case Je:return Ge;case Ke:return ze;case Ze:return Ve;case Qe:return We;case tn:return Xe}return e});var nn=en,rn=tt,an=et;var sn=function(t){return an(t)&&"[object Arguments]"==rn(t)},on=et,ln=Object.prototype,un=ln.hasOwnProperty,cn=ln.propertyIsEnumerable,hn=sn(function(){return arguments}())?sn:function(t){return on(t)&&un.call(t,"callee")&&!cn.call(t,"callee")},fn=Array.isArray,pn={exports:{}};var dn=function(){return!1};!function(t,e){var n=q,r=dn,i=e&&!e.nodeType&&e,a=i&&t&&!t.nodeType&&t,s=a&&a.exports===i?n.Buffer:void 0,o=(s?s.isBuffer:void 0)||r;t.exports=o}(pn,pn.exports);var mn=pn.exports,gn=tt,vn=ne,yn=et,_n={};_n["[object Float32Array]"]=_n["[object Float64Array]"]=_n["[object Int8Array]"]=_n["[object Int16Array]"]=_n["[object Int32Array]"]=_n["[object Uint8Array]"]=_n["[object Uint8ClampedArray]"]=_n["[object Uint16Array]"]=_n["[object Uint32Array]"]=!0,_n["[object Arguments]"]=_n["[object Array]"]=_n["[object ArrayBuffer]"]=_n["[object Boolean]"]=_n["[object DataView]"]=_n["[object Date]"]=_n["[object Error]"]=_n["[object Function]"]=_n["[object Map]"]=_n["[object Number]"]=_n["[object Object]"]=_n["[object RegExp]"]=_n["[object Set]"]=_n["[object String]"]=_n["[object WeakMap]"]=!1;var bn=function(t){return yn(t)&&vn(t.length)&&!!_n[gn(t)]};var wn=function(t){return function(e){return t(e)}},xn={exports:{}};!function(t,e){var n=H,r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,a=i&&i.exports===r&&n.process,s=function(){try{var t=i&&i.require&&i.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}(xn,xn.exports);var En=xn.exports,Sn=bn,kn=wn,Cn=En&&En.isTypedArray,Nn=Cn?kn(Cn):Sn,An=Re,Tn=nn,jn=hn,Dn=fn,$n=ae,Mn=mn,On=je,Rn=Nn,In=Object.prototype.hasOwnProperty;var Pn=n((function(t){if(null==t)return!0;if($n(t)&&(Dn(t)||"string"==typeof t||"function"==typeof t.splice||Mn(t)||Rn(t)||jn(t)))return!t.length;var e=Tn(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(On(t))return!An(t).length;for(var n in t)if(In.call(t,n))return!1;return!0}));const Ln={1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"};class Hn extends d.Component{static propTypes=(()=>({loader:g.object,errorHandledCallback:g.func,getTimestampsCallback:g.func,timestampA:g.string,timestampB:g.string,conf:g.object,url:g.string}))();_leftMonthIndex=-1;_rightMonthIndex=-1;constructor(t){super(t);const{timestampA:e,timestampB:n}=this.props;this._abortController=new window.AbortController,this.timestampSelectLeft=d.createRef(),this.timestampSelectRight=d.createRef(),this.monthSelectLeft=d.createRef(),this.monthSelectRight=d.createRef(),this.state={timestampA:e,timestampB:n,leftYear:e?.substring(0,4)??"",rightYear:n?.substring(0,4)??"",showDiffBtn:!1,shouldValidateTimestamp:!0},this._handleLeftTimestampChange=this._handleLeftTimestampChange.bind(this),this._handleRightTimestampChange=this._handleRightTimestampChange.bind(this),this._showDiffs=this._showDiffs.bind(this),this._errorHandled=this._errorHandled.bind(this),this._showMonths=this._showMonths.bind(this),this._handleYearChange=this._handleYearChange.bind(this),this._handleMonthChange=this._handleMonthChange.bind(this)}componentDidMount(){this.state.showError||(this.state.leftSnaps||this.state.rightSnaps?this._areRequestedTimestampsSelected():this._fetchCDXData())}componentDidUpdate(){this.state.sparkline||this.state.showLoader||this._fetchSparklineData(),(this.state.leftSnaps||this.state.rightSnaps)&&(this.state.shouldValidateTimestamp&&this._checkTimestamps(),this.state.showLoader||(this._selectValues(),!this.state.sparkline||this.state.leftMonthOptions||this.state.rightMonthOptions||-1===this._leftMonthIndex&&-1===this._rightMonthIndex||this._showMonths(this.state.leftYear,this.state.rightYear)))}componentWillUnmount(){this._abortController.abort()}_handleRightTimestampChange(t){if(this.setState({timestampB:t.target.value}),!Pn(this.state.leftSnaps)){const t=this.state.rightSnaps[this.timestampSelectRight.current.selectedIndex-1][1],e=this.state.leftSnaps.filter((e=>e[1]!==t));this.setState({showDiffBtn:!0,leftSnaps:e})}}_handleLeftTimestampChange(t){if(this.setState({timestampA:t.target.value}),!Pn(this.state.rightSnaps)){const t=this.state.leftSnaps[this.timestampSelectLeft.current.selectedIndex-1][1],e=this.state.rightSnaps.filter((e=>e[1]!==t));this.setState({showDiffBtn:!0,rightSnaps:e})}}render(){const t=()=>S(this.props.loader)?d.createElement(k,null):this.props.loader;return this.state.showLoader&&!this.state.showError?d.createElement("div",{className:"loading"},d.createElement(t,null)):this.state.showError?void 0:this.state.yearOptions||this.state.leftSnaps||this.state.rightSnaps?d.createElement("div",{className:"timestamp-header-view"},d.createElement("div",null,this.state.headerInfo,d.createElement("div",{id:"timestamp-left"},"Please select a capture"),d.createElement("div",{id:"timestamp-right"},"Please select a capture"),d.createElement("br",null)),d.createElement("div",{className:"wayback-ymd-timestamp"},d.createElement("div",{className:"wayback-timestamps"},d.createElement("select",{className:"form-control input-sm mr-sm-1",id:"year-select-left",onChange:this._handleYearChange,title:"Years and available captures",value:this.state.leftYear},d.createElement("option",{value:"",disabled:!0},"Year"),this.state.yearOptions),d.createElement("select",{className:"form-control input-sm mr-sm-1 month-select",ref:this.monthSelectLeft,onChange:this._handleMonthChange,title:"Months and available captures",defaultValue:""},d.createElement("option",{value:"",disabled:!0},"Month"),this.state.leftMonthOptions),!Pn(this.state.leftSnaps)&&d.createElement("select",{className:"form-control input-sm mr-sm-1 timestamp-select",ref:this.timestampSelectLeft,onChange:this._handleLeftTimestampChange,defaultValue:""},d.createElement("option",{value:"",disabled:!0},"Available captures"),this.state.leftSnaps.map(((t,e)=>d.createElement("option",{key:e,value:t[0]},ke(t[0])))))),d.createElement("div",{className:"wayback-ymd-buttons"},this.state.showDiffBtn&&d.createElement("button",{className:"btn btn-default btn-sm",onClick:this._showDiffs},"Show differences")),d.createElement("div",{className:"wayback-timestamps"},!Pn(this.state.rightSnaps)&&d.createElement("select",{className:"form-control input-sm mr-sm-1 timestamp-select",ref:this.timestampSelectRight,onChange:this._handleRightTimestampChange,defaultValue:""},d.createElement("option",{value:"",disabled:!0},"Available captures"),this.state.rightSnaps.map(((t,e)=>d.createElement("option",{key:e,value:t[0]},ke(t[0]))))),d.createElement("select",{className:"form-control input-sm mr-sm-1 month-select",ref:this.monthSelectRight,onChange:this._handleMonthChange,title:"Months and available captures",defaultValue:""},d.createElement("option",{value:"",disabled:!0},"Month"),this.state.rightMonthOptions),d.createElement("select",{className:"form-control input-sm mr-sm-1",id:"year-select-right",onChange:this._handleYearChange,title:"Years and available captures",value:this.state.rightYear},d.createElement("option",{value:"",disabled:!0},"Year"),this.state.yearOptions))),d.createElement("div",null,this.state.timestampA&&d.createElement("a",{href:this.props.conf.snapshotsPrefix+this.state.timestampA+"/"+this.props.url,id:"timestamp-left",target:"_blank",rel:"noopener noreferrer"}," Open in new window"),this.state.timestampB&&d.createElement("a",{href:this.props.conf.snapshotsPrefix+this.state.timestampB+"/"+this.props.url,id:"timestamp-right",target:"_blank",rel:"noopener noreferrer"},"Open in new window"),d.createElement("br",null))):d.createElement(t,null)}_areRequestedTimestampsSelected(){if(this.state.finishedValidating){if(!isNaN(this.state.timestampA)){const t=this.state.leftSnaps.slice(-1)[0];this.state.timestampA>t&&this.setState({leftSnaps:[...this.state.leftSnaps,[this.state.timestampA,"0"]],finishedValidating:!1})}if(!isNaN(this.state.timestampB)){const t=this.state.rightSnaps.slice(-1)[0];this.state.timestampB>t&&this.setState({rightSnaps:[...this.state.rightSnaps,[this.state.timestampB,"1"]],finishedValidating:!1})}}}_checkTimestamps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const{timestampA:e,timestampB:n}=this.state;"left"===t&&S(e)?this.setState({leftSnaps:null}):"right"===t&&S(n)&&this.setState({rightSnaps:null}),this.setState({finishedValidating:!0,showLoader:!1,shouldValidateTimestamp:!1})}createCDXRequest(t){const e=new URL(this.props.conf.cdxServer,window.location.origin);return e.searchParams.append("url",this.props.url),e.searchParams.append("fl","timestamp,digest"),e.searchParams.append("output","json"),e.searchParams.append("from",t),e.searchParams.append("to",t),e.searchParams.append("limit",this.props.conf.limit),xe(e,{signal:this._abortController.signal}).then(we)}fetchYearMonthCaptures(t,e){const{conf:n,url:r}=this.props,i=new URL(n.calendarURL,window.location.origin);return i.searchParams.append("url",r),i.searchParams.append("date",t+e),i.searchParams.append("digest",1),xe(i,{signal:this._abortController.signal}).then(we).then((t=>t.items)).then((n=>n.map((n=>{return[t+e+(r=n[0],7==(r=r.toString()).length?"0"+r:r),n[2]];var r})))).catch((t=>{this._errorHandled(t.message)}))}_fetchCDXData(){if(this.setState({showLoader:!0}),-1!==this._leftMonthIndex){const t=this.monthSelectLeft.current.value;this._leftMonthIndex=parseInt(Se(Ln,t))}else this.state.timestampA&&(this._leftMonthIndex=parseInt(this.state.timestampA.substring(4,6)));if(-1!==this._rightMonthIndex){const t=this.monthSelectRight.current.value;this._rightMonthIndex=parseInt(Se(Ln,t))}else this.state.timestampB&&(this._rightMonthIndex=parseInt(this.state.timestampB.substring(4,6)));let t,e;-1!==this._leftMonthIndex&&(t=this.fetchYearMonthCaptures(this.state.leftYear,Ee(this._leftMonthIndex))),-1!==this._rightMonthIndex&&(e=this.fetchYearMonthCaptures(this.state.rightYear,Ee(this._rightMonthIndex))),t?t.then((t=>{if(t&&t.length>0)if(e){const n=t;e.then((t=>{t&&t.length>0?this._prepareCDXData(n,t):this._checkTimestamps("right")}))}else this._prepareCDXData(t,null);else this._checkTimestamps("left")})).catch((t=>{this._errorHandled(t.message)})):e&&e.then((t=>{t&&t.length>0?this._prepareCDXData(null,t):this._checkTimestamps("right")}))}_errorHandled(t){this.props.errorHandledCallback(t),this.setState({showError:!0})}_prepareCDXData(t,e){this.props.getTimestampsCallback(this.state.timestampA,this.state.timestampB),this.setState({leftSnaps:t,rightSnaps:e,showLoader:!1})}_showOptions(t){const e=parseInt(this.props.conf.limit);return t&&t.slice(0).reverse().map(((t,n)=>{const r=Math.min(t[1],e);return d.createElement("option",{key:n,value:t[0]},`${t[0]} (${r})`)}))}_showDiffs(){const t=this.timestampSelectLeft.current.value,e=this.timestampSelectRight.current.value;this.props.getTimestampsCallback(t,e),this.setState({timestampA:t,timestampB:e})}_selectValues(){const{timestampA:t,timestampB:e,leftSnaps:n,rightSnaps:r}=this.state;!Pn(n)&&t&&(this.timestampSelectLeft.current.value=t),!Pn(r)&&e&&(this.timestampSelectRight.current.value=e);const i=this.monthSelectLeft.current,a=this.monthSelectRight.current;Array.from(i.options).some((t=>t.value===Ln[this._leftMonthIndex]))?i.value=Ln[this._leftMonthIndex]:i.selectedIndex=0,Array.from(a.options).some((t=>t.value===Ln[this._rightMonthIndex]))?a.value=Ln[this._rightMonthIndex]:a.selectedIndex=0}_getHeaderInfo(t,e,n){const r=Ce(t),i=Ce(e);return d.createElement("p",{id:"explanation-middle"},"Compare any two captures of ",this.props.url," from our collection of ",n.toLocaleString()," dating from ",r," to ",i,".")}_fetchSparklineData(){this.setState({showLoader:!0});const t=new URL(this.props.conf.sparklineURL,window.location.origin);t.searchParams.append("url",this.props.url),t.searchParams.append("collection","web"),t.searchParams.append("output","json"),xe(t,{signal:this._abortController.signal}).then(we).then((t=>{t?this._prepareSparklineData(t):this._errorHandled("404")})).catch((t=>{this._errorHandled(t.message)}))}_prepareSparklineData(t){const e=t.years,n=new Array(e.length);let r=0,i=0;for(const t in e){n[r]=[t,0];for(let a=0;a<e[t].length;a++)n[r][1]=n[r][1]+e[t][a],i+=e[t][a];r++}this.setState({showLoader:!1,sparkline:e,yearOptions:this._showOptions(n),headerInfo:this._getHeaderInfo(t.first_ts,t.last_ts,i)})}_showMonths(t,e){if(!S(t)){const e=this.state.sparkline[t].filter((t=>t>0)).map(((t,e)=>[Ln[e+1],t]));this.setState({leftMonthOptions:this._showOptions(e)})}if(!S(e)){const t=this.state.sparkline[e].filter((t=>t>0)).map(((t,e)=>[Ln[e+1],t]));this.setState({rightMonthOptions:this._showOptions(t)})}}_handleMonthChange(t){this._fetchCDXData(),this.setState({showDiffBtn:!0,timestampA:null,timestampB:null})}_handleYearChange(t){"year-select-left"===t.target.id?(this._leftMonthIndex=0,this.setState({leftYear:t.target.value,leftSnaps:null,showDiffBtn:!1}),this._showMonths(t.target.value,null)):(this._rightMonthIndex=0,this.setState({rightYear:t.target.value,rightSnaps:null,showDiffBtn:!1}),this._showMonths(null,t.target.value))}}function Un(){return d.createElement("p",{id:"diff-footer"},d.createElement("yellow-diff-footer",null,"Yellow")," indicates content deletion. ",d.createElement("blue-diff-footer",null,"Blue")," indicates content addition.")}class Bn extends d.Component{render(){return d.createElement("h1",null,"No capture is selected, please pick one from the list.")}}const qn=t=>{let{code:e,url:n,timestamp:r,conf:i,errorHandledCallback:a}=t,s="We are sorry but there is a problem comparing these captures. Please try two different ones.",o=!1,l=r?r.substring(0,4):"";const u=p.useCallback((()=>{xe(`${i.waybackDiscoverDiff}/calculate-simhash?url=${encodeURIComponent(n)}&year=${r.substring(0,4)}`).then(be).then((()=>{setTimeout((function(){window.location.reload(!0)}),1e4)})).catch((t=>{a(t.message)}))}),[i,n,r]);switch(e){case"404":s=`The Wayback Machine has not archived ${n}.`,o=!1;break;case"422":s=`The captures of ${n} cannot be compared. Note that we support only HTML capture comparison.`,o=!1;break;case"CAPTURE_NOT_FOUND":s=`There are no data available for ${n} at ${r}.`,o=!0;break;case"NOT_CAPTURED":s=`The Wayback Machine has no similarity data for ${n} and year ${l}.`,o=!0;break;case"NO_CAPTURES":s=`The Wayback Machine has not archived ${n} for year ${l}.`,o=!1;break;case"NO_DIFFERENT_CAPTURES":s=`There aren't any different captures for ${n} for year ${l} to display their similarity.`,o=!1;break;case"_this4.errorHandled is not a function":case"NetworkError when attempting to fetch resource.":case"Load failed":s=`The capture of ${n} at ${r} cannot be used for comparisons. Its possible it is a redirect.`,o=!1}return d.createElement(d.Fragment,null,d.createElement("div",{className:"alert alert-warning",role:"alert"},s),o&&d.createElement("button",{className:"btn btn-sm",id:"calcButton",onClick:u},"Calculate now"),d.createElement("button",{className:"btn btn-sm",onClick:()=>window.history.back()},"« Go back"))};qn.propTypes={code:g.string,url:g.string,timestamp:g.string,conf:g.object,errorHandledCallback:g.func};class Fn extends d.Component{constructor(t){super(t),this.state={showDiff:!1,timestampA:this.props.timestampA,timestampB:this.props.timestampB},this._oneFrame=null,this.errorHandled=this.errorHandled.bind(this),this.getTimestamps=this.getTimestamps.bind(this),this.prepareDiffView=this.prepareDiffView.bind(this)}getTimestamps(t,e){if((void 0!==t||void 0!==e)&&(this.setState({fetchedRaw:null,error:null,showDiff:!0,timestampA:t||"",timestampB:e||""}),t!==this.state.timestampA||e!==this.state.timestampB)){const n=this.props.conf.urlPrefix+(t||"")+"/"+(e||"")+"/"+this.props.url;window.history.pushState({},"",n)}}errorHandled=t=>{this.setState({error:t})};render(){const{url:e,noTimestamps:n,conf:r,loader:i}=this.props;return ve(e)?this.state.error?d.createElement(qn,{url:e,timestamp:this.state.timestampA,code:this.state.error}):this.state.timestampA||this.state.timestampB?this.state.timestampA&&this.state.timestampB?d.createElement("div",{className:"diffcontainer-view"},d.createElement(Hn,t({},this.props,{getTimestampsCallback:this.getTimestamps,errorHandledCallback:this.errorHandled})),this.state.showDiff&&this.prepareDiffView(),d.createElement(Un,null)):this.state.timestampA?d.createElement("div",{className:"diffcontainer-view"},d.createElement(Hn,t({},this.props,{getTimestampsCallback:this.getTimestamps,errorHandledCallback:this.errorHandled})),this.state.showDiff&&this._showOneSnapshot(!0,this.state.timestampA)):this.state.timestampB?d.createElement("div",{className:"diffcontainer-view"},d.createElement(Hn,t({},this.props,{errorHandledCallback:this.errorHandled,getTimestampsCallback:this.getTimestamps})),this.state.showDiff&&this._showOneSnapshot(!1,this.state.timestampB)):void 0:d.createElement("div",{className:"diffcontainer-view"},d.createElement(Hn,t({},this.props,{getTimestampsCallback:this.getTimestamps,errorHandledCallback:this.errorHandled})),n&&this._showNoTimestamps()):this._invalidURL()}_showNoTimestamps(){return d.createElement("div",{className:"side-by-side-render"},d.createElement(Bn,null),d.createElement(Bn,null))}_showOneSnapshot(t,e){if(this.state.fetchedRaw){const e={height:window.innerHeight,onLoad:()=>{this._handleHeight()},srcDoc:this.state.fetchedRaw,ref:t=>{this._oneFrame=t}};return d.createElement("div",{className:"side-by-side-render"},t?d.createElement("iframe",e):d.createElement(Bn,null),t?d.createElement(Bn,null):d.createElement("iframe",e))}const n=new URL(this.props.conf.snapshotsPrefix+e+"/"+encodeURIComponent(this.props.url),window.location.origin);this._handleSnapshotFetch(xe(n.toString()));const r=()=>S(this.props.loader)?d.createElement(k,null):this.props.loader;return d.createElement("div",{className:"loading"},d.createElement(r,null))}_handleSnapshotFetch(t){t.then(be).then((t=>{const e=t.headers.get("content-type");return e&&e.includes("text/html")?t.text():"<iframe src="+t.url+' style="width: 98%; position: absolute; height: 98%;" />'})).then((t=>{this.setState({fetchedRaw:t})})).catch((t=>{this.errorHandled(t.message)}))}prepareDiffView(){if(!this.state.error){const t=new URL(this.props.conf.snapshotsPrefix+this.state.timestampA+"/"+encodeURIComponent(this.props.url),window.location.origin),e=new URL(this.props.conf.snapshotsPrefix+this.state.timestampB+"/"+encodeURIComponent(this.props.url),window.location.origin),n=new URL(this.props.conf.webMonitoringProcessingURL,window.location.origin);return d.createElement(Ae,{webMonitoringProcessingURL:n.toString(),page:{url:encodeURIComponent(this.props.url)},diffType:"SIDE_BY_SIDE_RENDERED",a:t,b:e,loader:this.props.loader,errorHandledCallback:this.errorHandled})}}_handleHeight(){const t=this._oneFrame.contentDocument.documentElement.scrollHeight,e=this._oneFrame.contentDocument.documentElement.scrollWidth;t>.1*this._oneFrame.height?this._oneFrame.height=t+.01*t:this._oneFrame.height=.5*this._oneFrame.height,e>this._oneFrame.clientWidth&&(this._oneFrame.width=e)}_invalidURL(){return d.createElement("div",{className:"alert alert-danger",role:"alert"},d.createElement("b",null,"Oh snap!")," Invalid URL ",this.props.url)}}Fn.propTypes={url:g.string.isRequired,timestampA:g.string,timestampB:g.string,conf:g.object.isRequired,loader:g.element,noTimestamps:(t,e,n)=>t.noTimestamps&&"boolean"!=typeof t.noTimestamps?new Error(`noTimestamps specified in '${n} should be boolean'.`):t.noTimestamps||t.timestampA||t.timestampB?void 0:new Error(`At least one of props 'timestampA' or 'timestampB' or noTimestamps must be specified in '${n}'.`)};var Yn={value:()=>{}};function zn(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Vn(r)}function Vn(t){this._=t}function Wn(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Xn(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Yn,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Vn.prototype=zn.prototype={constructor:Vn,on:function(t,e){var n,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),s=-1,o=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(n=(t=a[s]).type)i[n]=Xn(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Xn(i[n],t.name,null);return this}for(;++s<o;)if((n=(t=a[s]).type)&&(n=Wn(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Vn(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var Gn="http://www.w3.org/1999/xhtml",Jn={svg:"http://www.w3.org/2000/svg",xhtml:Gn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Kn(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Jn.hasOwnProperty(e)?{space:Jn[e],local:t}:t}function Zn(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Gn&&e.documentElement.namespaceURI===Gn?e.createElement(t):e.createElementNS(n,t)}}function Qn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function tr(t){var e=Kn(t);return(e.local?Qn:Zn)(e)}function er(){}function nr(t){return null==t?er:function(){return this.querySelector(t)}}function rr(){return[]}function ir(t){return null==t?rr:function(){return this.querySelectorAll(t)}}function ar(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}function sr(t){return function(){return this.matches(t)}}function or(t){return function(e){return e.matches(t)}}var lr=Array.prototype.find;function ur(){return this.firstElementChild}var cr=Array.prototype.filter;function hr(){return Array.from(this.children)}function fr(t){return new Array(t.length)}function pr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function dr(t,e,n,r,i,a){for(var s,o=0,l=e.length,u=a.length;o<u;++o)(s=e[o])?(s.__data__=a[o],r[o]=s):n[o]=new pr(t,a[o]);for(;o<l;++o)(s=e[o])&&(i[o]=s)}function mr(t,e,n,r,i,a,s){var o,l,u,c=new Map,h=e.length,f=a.length,p=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(p[o]=u=s.call(l,l.__data__,o,e)+"",c.has(u)?i[o]=l:c.set(u,l));for(o=0;o<f;++o)u=s.call(t,a[o],o,a)+"",(l=c.get(u))?(r[o]=l,l.__data__=a[o],c.delete(u)):n[o]=new pr(t,a[o]);for(o=0;o<h;++o)(l=e[o])&&c.get(p[o])===l&&(i[o]=l)}function gr(t){return t.__data__}function vr(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function yr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function _r(t){return function(){this.removeAttribute(t)}}function br(t){return function(){this.removeAttributeNS(t.space,t.local)}}function wr(t,e){return function(){this.setAttribute(t,e)}}function xr(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Er(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Sr(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function kr(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Cr(t){return function(){this.style.removeProperty(t)}}function Nr(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ar(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Tr(t,e){return t.style.getPropertyValue(e)||kr(t).getComputedStyle(t,null).getPropertyValue(e)}function jr(t){return function(){delete this[t]}}function Dr(t,e){return function(){this[t]=e}}function $r(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Mr(t){return t.trim().split(/^|\s+/)}function Or(t){return t.classList||new Rr(t)}function Rr(t){this._node=t,this._names=Mr(t.getAttribute("class")||"")}function Ir(t,e){for(var n=Or(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Pr(t,e){for(var n=Or(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Lr(t){return function(){Ir(this,t)}}function Hr(t){return function(){Pr(this,t)}}function Ur(t,e){return function(){(e.apply(this,arguments)?Ir:Pr)(this,t)}}function Br(){this.textContent=""}function qr(t){return function(){this.textContent=t}}function Fr(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Yr(){this.innerHTML=""}function zr(t){return function(){this.innerHTML=t}}function Vr(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Wr(){this.nextSibling&&this.parentNode.appendChild(this)}function Xr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Gr(){return null}function Jr(){var t=this.parentNode;t&&t.removeChild(this)}function Kr(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Zr(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Qr(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function ti(t,e,n){return function(){var r,i=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var s=0,o=i.length;s<o;++s)if((r=i[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=e);this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function ei(t,e,n){var r=kr(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ni(t,e){return function(){return ei(this,t,e)}}function ri(t,e){return function(){return ei(this,t,e.apply(this,arguments))}}pr.prototype={constructor:pr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Rr.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ii=[null];function ai(t,e){this._groups=t,this._parents=e}function si(){return new ai([[document.documentElement]],ii)}function oi(t){return"string"==typeof t?new ai([[document.querySelector(t)]],[document.documentElement]):new ai([[t]],ii)}function li(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ui(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ci(){}ai.prototype=si.prototype={constructor:ai,select:function(t){"function"!=typeof t&&(t=nr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,s,o=e[i],l=o.length,u=r[i]=new Array(l),c=0;c<l;++c)(a=o[c])&&(s=t.call(a,a.__data__,c,o))&&("__data__"in a&&(s.__data__=a.__data__),u[c]=s);return new ai(r,this._parents)},selectAll:function(t){t="function"==typeof t?ar(t):ir(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s,o=e[a],l=o.length,u=0;u<l;++u)(s=o[u])&&(r.push(t.call(s,s.__data__,u,o)),i.push(s));return new ai(r,i)},selectChild:function(t){return this.select(null==t?ur:function(t){return function(){return lr.call(this.children,t)}}("function"==typeof t?t:or(t)))},selectChildren:function(t){return this.selectAll(null==t?hr:function(t){return function(){return cr.call(this.children,t)}}("function"==typeof t?t:or(t)))},filter:function(t){"function"!=typeof t&&(t=sr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,s=e[i],o=s.length,l=r[i]=[],u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new ai(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,gr);var n,r=e?mr:dr,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=a.length,o=new Array(s),l=new Array(s),u=new Array(s),c=0;c<s;++c){var h=i[c],f=a[c],p=f.length,d=vr(t.call(h,h&&h.__data__,c,i)),m=d.length,g=l[c]=new Array(m),v=o[c]=new Array(m);r(h,f,g,v,u[c]=new Array(p),d,e);for(var y,_,b=0,w=0;b<m;++b)if(y=g[b]){for(b>=w&&(w=b+1);!(_=v[w])&&++w<m;);y._next=_||null}}return(o=new ai(o,i))._enter=l,o._exit=u,o},enter:function(){return new ai(this._enter||this._groups.map(fr),this._parents)},exit:function(){return new ai(this._exit||this._groups.map(fr),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,s=Math.min(i,a),o=new Array(i),l=0;l<s;++l)for(var u,c=n[l],h=r[l],f=c.length,p=o[l]=new Array(f),d=0;d<f;++d)(u=c[d]||h[d])&&(p[d]=u);for(;l<i;++l)o[l]=n[l];return new ai(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,s=i[a];--a>=0;)(r=i[a])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=yr);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s,o=n[a],l=o.length,u=i[a]=new Array(l),c=0;c<l;++c)(s=o[c])&&(u[c]=s);u.sort(e)}return new ai(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],s=0,o=a.length;s<o;++s)(i=a[s])&&t.call(i,i.__data__,s,a);return this},attr:function(t,e){var n=Kn(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?br:_r:"function"==typeof e?n.local?Sr:Er:n.local?xr:wr)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Cr:"function"==typeof e?Ar:Nr)(t,e,null==n?"":n)):Tr(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?jr:"function"==typeof e?$r:Dr)(t,e)):this.node()[t]},classed:function(t,e){var n=Mr(t+"");if(arguments.length<2){for(var r=Or(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Ur:e?Lr:Hr)(n,e))},text:function(t){return arguments.length?this.each(null==t?Br:("function"==typeof t?Fr:qr)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Yr:("function"==typeof t?Vr:zr)(t)):this.node().innerHTML},raise:function(){return this.each(Wr)},lower:function(){return this.each(Xr)},append:function(t){var e="function"==typeof t?t:tr(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:tr(t),r=null==e?Gr:"function"==typeof e?e:nr(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Jr)},clone:function(t){return this.select(t?Zr:Kr)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),s=a.length;if(!(arguments.length<2)){for(o=e?ti:Qr,r=0;r<s;++r)this.each(o(a[r],e,n));return this}var o=this.node().__on;if(o)for(var l,u=0,c=o.length;u<c;++u)for(r=0,l=o[u];r<s;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ri:ni)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],a=0,s=i.length;a<s;++a)(r=i[a])&&(yield r)}};var hi=.7,fi=1/hi,pi="\\s*([+-]?\\d+)\\s*",di="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gi=/^#([0-9a-f]{3,8})$/,vi=new RegExp(`^rgb\\(${pi},${pi},${pi}\\)$`),yi=new RegExp(`^rgb\\(${mi},${mi},${mi}\\)$`),_i=new RegExp(`^rgba\\(${pi},${pi},${pi},${di}\\)$`),bi=new RegExp(`^rgba\\(${mi},${mi},${mi},${di}\\)$`),wi=new RegExp(`^hsl\\(${di},${mi},${mi}\\)$`),xi=new RegExp(`^hsla\\(${di},${mi},${mi},${di}\\)$`),Ei={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Si(){return this.rgb().formatHex()}function ki(){return this.rgb().formatRgb()}function Ci(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=gi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ni(e):3===n?new ji(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ai(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ai(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=vi.exec(t))?new ji(e[1],e[2],e[3],1):(e=yi.exec(t))?new ji(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=_i.exec(t))?Ai(e[1],e[2],e[3],e[4]):(e=bi.exec(t))?Ai(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=wi.exec(t))?Ii(e[1],e[2]/100,e[3]/100,1):(e=xi.exec(t))?Ii(e[1],e[2]/100,e[3]/100,e[4]):Ei.hasOwnProperty(t)?Ni(Ei[t]):"transparent"===t?new ji(NaN,NaN,NaN,0):null}function Ni(t){return new ji(t>>16&255,t>>8&255,255&t,1)}function Ai(t,e,n,r){return r<=0&&(t=e=n=NaN),new ji(t,e,n,r)}function Ti(t,e,n,r){return 1===arguments.length?((i=t)instanceof ci||(i=Ci(i)),i?new ji((i=i.rgb()).r,i.g,i.b,i.opacity):new ji):new ji(t,e,n,null==r?1:r);var i}function ji(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Di(){return`#${Ri(this.r)}${Ri(this.g)}${Ri(this.b)}`}function $i(){const t=Mi(this.opacity);return`${1===t?"rgb(":"rgba("}${Oi(this.r)}, ${Oi(this.g)}, ${Oi(this.b)}${1===t?")":`, ${t})`}`}function Mi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Oi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ri(t){return((t=Oi(t))<16?"0":"")+t.toString(16)}function Ii(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Li(t,e,n,r)}function Pi(t){if(t instanceof Li)return new Li(t.h,t.s,t.l,t.opacity);if(t instanceof ci||(t=Ci(t)),!t)return new Li;if(t instanceof Li)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,o=a-i,l=(a+i)/2;return o?(s=e===a?(n-r)/o+6*(n<r):n===a?(r-e)/o+2:(e-n)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new Li(s,o,l,t.opacity)}function Li(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Hi(t){return(t=(t||0)%360)<0?t+360:t}function Ui(t){return Math.max(0,Math.min(1,t||0))}function Bi(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}li(ci,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Si,formatHex:Si,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Pi(this).formatHsl()},formatRgb:ki,toString:ki}),li(ji,Ti,ui(ci,{brighter(t){return t=null==t?fi:Math.pow(fi,t),new ji(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?hi:Math.pow(hi,t),new ji(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ji(Oi(this.r),Oi(this.g),Oi(this.b),Mi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Di,formatHex:Di,formatHex8:function(){return`#${Ri(this.r)}${Ri(this.g)}${Ri(this.b)}${Ri(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:$i,toString:$i})),li(Li,(function(t,e,n,r){return 1===arguments.length?Pi(t):new Li(t,e,n,null==r?1:r)}),ui(ci,{brighter(t){return t=null==t?fi:Math.pow(fi,t),new Li(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?hi:Math.pow(hi,t),new Li(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ji(Bi(t>=240?t-240:t+120,i,r),Bi(t,i,r),Bi(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Li(Hi(this.h),Ui(this.s),Ui(this.l),Mi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Mi(this.opacity);return`${1===t?"hsl(":"hsla("}${Hi(this.h)}, ${100*Ui(this.s)}%, ${100*Ui(this.l)}%${1===t?")":`, ${t})`}`}}));var qi=t=>()=>t;function Fi(t){return 1==(t=+t)?Yi:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):qi(isNaN(e)?n:e)}}function Yi(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):qi(isNaN(t)?e:t)}var zi=function t(e){var n=Fi(e);function r(t,e){var r=n((t=Ti(t)).r,(e=Ti(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),s=Yi(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function Vi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Wi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xi=new RegExp(Wi.source,"g");function Gi(t,e){var n,r,i,a=Wi.lastIndex=Xi.lastIndex=0,s=-1,o=[],l=[];for(t+="",e+="";(n=Wi.exec(t))&&(r=Xi.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(r=r[0])?o[s]?o[s]+=r:o[++s]=r:(o[++s]=null,l.push({i:s,x:Vi(n,r)})),a=Xi.lastIndex;return a<e.length&&(i=e.slice(a),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)o[(n=l[r]).i]=n.x(t);return o.join("")})}var Ji,Ki=180/Math.PI,Zi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Qi(t,e,n,r,i,a){var s,o,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Ki,skewX:Math.atan(l)*Ki,scaleX:s,scaleY:o}}function ta(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,s){var o=[],l=[];return a=t(a),s=t(s),function(t,r,i,a,s,o){if(t!==i||r!==a){var l=s.push("translate(",null,e,null,n);o.push({i:l-4,x:Vi(t,i)},{i:l-2,x:Vi(r,a)})}else(i||a)&&s.push("translate("+i+e+a+n)}(a.translateX,a.translateY,s.translateX,s.translateY,o,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Vi(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,s.rotate,o,l),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Vi(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,s.skewX,o,l),function(t,e,n,r,a,s){if(t!==n||e!==r){var o=a.push(i(a)+"scale(",null,",",null,")");s.push({i:o-4,x:Vi(t,n)},{i:o-2,x:Vi(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,s.scaleX,s.scaleY,o,l),a=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)o[(e=l[n]).i]=e.x(t);return o.join("")}}}var ea,na,ra=ta((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Zi:Qi(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ia=ta((function(t){return null==t?Zi:(Ji||(Ji=document.createElementNS("http://www.w3.org/2000/svg","g")),Ji.setAttribute("transform",t),(t=Ji.transform.baseVal.consolidate())?Qi((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Zi)}),", ",")",")"),aa=0,sa=0,oa=0,la=1e3,ua=0,ca=0,ha=0,fa="object"==typeof performance&&performance.now?performance:Date,pa="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function da(){return ca||(pa(ma),ca=fa.now()+ha)}function ma(){ca=0}function ga(){this._call=this._time=this._next=null}function va(t,e,n){var r=new ga;return r.restart(t,e,n),r}function ya(){ca=(ua=fa.now())+ha,aa=sa=0;try{!function(){da(),++aa;for(var t,e=ea;e;)(t=ca-e._time)>=0&&e._call.call(void 0,t),e=e._next;--aa}()}finally{aa=0,function(){var t,e,n=ea,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:ea=e);na=t,ba(r)}(),ca=0}}function _a(){var t=fa.now(),e=t-ua;e>la&&(ha-=e,ua=t)}function ba(t){aa||(sa&&(sa=clearTimeout(sa)),t-ca>24?(t<1/0&&(sa=setTimeout(ya,t-fa.now()-ha)),oa&&(oa=clearInterval(oa))):(oa||(ua=fa.now(),oa=setInterval(_a,la)),aa=1,pa(ya)))}function wa(t,e,n){var r=new ga;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}ga.prototype=va.prototype={constructor:ga,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?da():+n)+(null==e?0:+e),this._next||na===this||(na?na._next=this:ea=this,na=this),this._call=t,this._time=n,ba()},stop:function(){this._call&&(this._call=null,this._time=1/0,ba())}};var xa=zn("start","end","cancel","interrupt"),Ea=[],Sa=0,ka=1,Ca=2,Na=3,Aa=4,Ta=5,ja=6;function Da(t,e,n,r,i,a){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(t){n.state=ka,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}function s(a){var u,c,h,f;if(n.state!==ka)return l();for(u in i)if((f=i[u]).name===n.name){if(f.state===Na)return wa(s);f.state===Aa?(f.state=ja,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=ja,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[u])}if(wa((function(){n.state===Na&&(n.state=Aa,n.timer.restart(o,n.delay,n.time),o(a))})),n.state=Ca,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Ca){for(n.state=Na,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=Ta,1),a=-1,s=r.length;++a<s;)r[a].call(t,i);n.state===Ta&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=ja,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=va(a,0,n.time)}(t,n,{name:e,index:r,group:i,on:xa,tween:Ea,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Sa})}function $a(t,e){var n=Oa(t,e);if(n.state>Sa)throw new Error("too late; already scheduled");return n}function Ma(t,e){var n=Oa(t,e);if(n.state>Na)throw new Error("too late; already running");return n}function Oa(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ra(t,e){var n,r;return function(){var i=Ma(this,t),a=i.tween;if(a!==n)for(var s=0,o=(r=n=a).length;s<o;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function Ia(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=Ma(this,t),s=a.tween;if(s!==r){i=(r=s).slice();for(var o={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=o;break}l===u&&i.push(o)}a.tween=i}}function Pa(t,e,n){var r=t._id;return t.each((function(){var t=Ma(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Oa(t,r).value[e]}}function La(t,e){var n;return("number"==typeof e?Vi:e instanceof Ci?zi:(n=Ci(e))?(e=n,zi):Gi)(t,e)}function Ha(t){return function(){this.removeAttribute(t)}}function Ua(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ba(t,e,n){var r,i,a=n+"";return function(){var s=this.getAttribute(t);return s===a?null:s===r?i:i=e(r=s,n)}}function qa(t,e,n){var r,i,a=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===a?null:s===r?i:i=e(r=s,n)}}function Fa(t,e,n){var r,i,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(o=l+"")?null:s===r&&o===i?a:(i=o,a=e(r=s,l));this.removeAttribute(t)}}function Ya(t,e,n){var r,i,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(o=l+"")?null:s===r&&o===i?a:(i=o,a=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function za(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function Va(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function Wa(t,e){return function(){$a(this,t).delay=+e.apply(this,arguments)}}function Xa(t,e){return e=+e,function(){$a(this,t).delay=e}}function Ga(t,e){return function(){Ma(this,t).duration=+e.apply(this,arguments)}}function Ja(t,e){return e=+e,function(){Ma(this,t).duration=e}}var Ka=si.prototype.constructor;function Za(t){return function(){this.style.removeProperty(t)}}var Qa=0;function ts(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function es(){return++Qa}var ns=si.prototype;ts.prototype={constructor:ts,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=nr(t));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var o,l,u=r[s],c=u.length,h=a[s]=new Array(c),f=0;f<c;++f)(o=u[f])&&(l=t.call(o,o.__data__,f,u))&&("__data__"in o&&(l.__data__=o.__data__),h[f]=l,Da(h[f],e,n,f,h,Oa(o,n)));return new ts(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ir(t));for(var r=this._groups,i=r.length,a=[],s=[],o=0;o<i;++o)for(var l,u=r[o],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var f,p=t.call(l,l.__data__,h,u),d=Oa(l,n),m=0,g=p.length;m<g;++m)(f=p[m])&&Da(f,e,n,m,p,d);a.push(p),s.push(l)}return new ts(a,s,e,n)},selectChild:ns.selectChild,selectChildren:ns.selectChildren,filter:function(t){"function"!=typeof t&&(t=sr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,s=e[i],o=s.length,l=r[i]=[],u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new ts(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var l,u=e[o],c=n[o],h=u.length,f=s[o]=new Array(h),p=0;p<h;++p)(l=u[p]||c[p])&&(f[p]=l);for(;o<r;++o)s[o]=e[o];return new ts(s,this._parents,this._name,this._id)},selection:function(){return new Ka(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=es(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s,o=r[a],l=o.length,u=0;u<l;++u)if(s=o[u]){var c=Oa(s,e);Da(s,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ts(r,this._parents,t,n)},call:ns.call,nodes:ns.nodes,node:ns.node,size:ns.size,empty:ns.empty,each:ns.each,on:function(t,e){var n=this._id;return arguments.length<2?Oa(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?$a:Ma;return function(){var s=a(this,t),o=s.on;o!==r&&(i=(r=o).copy()).on(e,n),s.on=i}}(n,t,e))},attr:function(t,e){var n=Kn(t),r="transform"===n?ia:La;return this.attrTween(t,"function"==typeof e?(n.local?Ya:Fa)(n,r,Pa(this,"attr."+t,e)):null==e?(n.local?Ua:Ha)(n):(n.local?qa:Ba)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Kn(t);return this.tween(n,(r.local?za:Va)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?ra:La;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=Tr(this,t),s=(this.style.removeProperty(t),Tr(this,t));return a===s?null:a===n&&s===r?i:i=e(n=a,r=s)}}(t,r)).on("end.style."+t,Za(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var s=Tr(this,t),o=n(this),l=o+"";return null==o&&(this.style.removeProperty(t),l=o=Tr(this,t)),s===l?null:s===r&&l===i?a:(i=l,a=e(r=s,o))}}(t,r,Pa(this,"style."+t,e))).each(function(t,e){var n,r,i,a,s="style."+e,o="end."+s;return function(){var l=Ma(this,t),u=l.on,c=null==l.value[s]?a||(a=Za(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(o,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var s=Tr(this,t);return s===a?null:s===r?i:i=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,a,n)),r}return a._value=e,a}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Pa(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Oa(this.node(),n).tween,a=0,s=i.length;a<s;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?Ra:Ia)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Wa:Xa)(e,t)):Oa(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ga:Ja)(e,t)):Oa(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Ma(this,t).ease=e}}(e,t)):Oa(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Ma(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(a,s){var o={value:s},l={value:function(){0==--i&&a()}};n.each((function(){var n=Ma(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),n.on=e})),0===i&&a()}))},[Symbol.iterator]:ns[Symbol.iterator]};var rs={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function is(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}si.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,a=t.__transition,s=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>Ca&&n.state<Ta,n.state=ja,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):s=!1;s&&delete t.__transition}}(this,t)}))},si.prototype.transition=function(t){var e,n;t instanceof ts?(e=t._id,t=t._name):(e=es(),(n=rs).time=da(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s,o=r[a],l=o.length,u=0;u<l;++u)(s=o[u])&&Da(s,t,e,u,o,n||is(s,e));return new ts(r,this._parents,t,e)};const as=Math.PI,ss=2*as,os=1e-6,ls=ss-os;function us(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class cs{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?us:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return us;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,i,a){this._append`C${+t},${+e},${+n},${+r},${this._x1=+i},${this._y1=+a}`}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let a=this._x1,s=this._y1,o=n-t,l=r-e,u=a-t,c=s-e,h=u*u+c*c;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>os)if(Math.abs(c*o-l*u)>os&&i){let f=n-a,p=r-s,d=o*o+l*l,m=f*f+p*p,g=Math.sqrt(d),v=Math.sqrt(h),y=i*Math.tan((as-Math.acos((d+h-m)/(2*g*v)))/2),_=y/v,b=y/g;Math.abs(_-1)>os&&this._append`L${t+_*u},${e+_*c}`,this._append`A${i},${i},0,0,${+(c*f>u*p)},${this._x1=t+b*o},${this._y1=e+b*l}`}else this._append`L${this._x1=t},${this._y1=e}`;else;}arc(t,e,n,r,i,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(r),o=n*Math.sin(r),l=t+s,u=e+o,c=1^a,h=a?r-i:i-r;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>os||Math.abs(this._y1-u)>os)&&this._append`L${l},${u}`,n&&(h<0&&(h=h%ss+ss),h>ls?this._append`A${n},${n},0,1,${c},${t-s},${e-o}A${n},${n},0,1,${c},${this._x1=l},${this._y1=u}`:h>os&&this._append`A${n},${n},0,${+(h>=as)},${c},${this._x1=t+n*Math.cos(i)},${this._y1=e+n*Math.sin(i)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function hs(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function fs(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=ds)):void 0===e&&(e=ps);for(var n,r,i,a,s,o=new vs(t),l=[o];n=l.pop();)if((i=e(n.data))&&(s=(i=Array.from(i)).length))for(n.children=i,a=s-1;a>=0;--a)l.push(r=i[a]=new vs(i[a])),r.parent=n,r.depth=n.depth+1;return o.eachBefore(gs)}function ps(t){return t.children}function ds(t){return Array.isArray(t)?t[1]:null}function ms(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function gs(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function vs(t){this.data=t,this.depth=this.height=0,this.parent=null}function ys(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function _s(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&function(t,e,n,r,i){for(var a,s=t.children,o=-1,l=s.length,u=t.value&&(r-e)/t.value;++o<l;)(a=s[o]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*u}(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,s=r.x1-n,o=r.y1-n;s<i&&(i=s=(i+s)/2),o<a&&(a=o=(a+o)/2),r.x0=i,r.y0=a,r.x1=s,r.y1=o}}(e,a)),r&&i.eachBefore(ys),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i}function bs(t){return function(){return t}}vs.prototype=fs.prototype={constructor:vs,count:function(){return this.eachAfter(hs)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,a=this,s=[a],o=[],l=-1;a=s.pop();)if(o.push(a),n=a.children)for(r=0,i=n.length;r<i;++r)s.push(n[r]);for(;a=o.pop();)t.call(e,a,++l,this);return this},eachBefore:function(t,e){for(var n,r,i=this,a=[i],s=-1;i=a.pop();)if(t.call(e,i,++s,this),n=i.children)for(r=n.length-1;r>=0;--r)a.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return fs(this).eachBefore(ms)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,a=[i];do{for(t=a.reverse(),a=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n])}while(a.length)}};const ws=Math.abs,xs=Math.atan2,Es=Math.cos,Ss=Math.max,ks=Math.min,Cs=Math.sin,Ns=Math.sqrt,As=1e-12,Ts=Math.PI,js=Ts/2,Ds=2*Ts;function $s(t){return t>=1?js:t<=-1?-js:Math.asin(t)}function Ms(t){return t.innerRadius}function Os(t){return t.outerRadius}function Rs(t){return t.startAngle}function Is(t){return t.endAngle}function Ps(t){return t&&t.padAngle}function Ls(t,e,n,r,i,a,s){var o=t-n,l=e-r,u=(s?a:-a)/Ns(o*o+l*l),c=u*l,h=-u*o,f=t+c,p=e+h,d=n+c,m=r+h,g=(f+d)/2,v=(p+m)/2,y=d-f,_=m-p,b=y*y+_*_,w=i-a,x=f*m-d*p,E=(_<0?-1:1)*Ns(Ss(0,w*w*b-x*x)),S=(x*_-y*E)/b,k=(-x*y-_*E)/b,C=(x*_+y*E)/b,N=(-x*y+_*E)/b,A=S-g,T=k-v,j=C-g,D=N-v;return A*A+T*T>j*j+D*D&&(S=C,k=N),{cx:S,cy:k,x01:-c,y01:-h,x11:S*(i/w-1),y11:k*(i/w-1)}}function Hs(){var t=Ms,e=Os,n=bs(0),r=null,i=Rs,a=Is,s=Ps,o=null,l=function(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new cs(e)}(u);function u(){var u,c,h,f=+t.apply(this,arguments),p=+e.apply(this,arguments),d=i.apply(this,arguments)-js,m=a.apply(this,arguments)-js,g=ws(m-d),v=m>d;if(o||(o=u=l()),p<f&&(c=p,p=f,f=c),p>As)if(g>Ds-As)o.moveTo(p*Es(d),p*Cs(d)),o.arc(0,0,p,d,m,!v),f>As&&(o.moveTo(f*Es(m),f*Cs(m)),o.arc(0,0,f,m,d,v));else{var y,_,b=d,w=m,x=d,E=m,S=g,k=g,C=s.apply(this,arguments)/2,N=C>As&&(r?+r.apply(this,arguments):Ns(f*f+p*p)),A=ks(ws(p-f)/2,+n.apply(this,arguments)),T=A,j=A;if(N>As){var D=$s(N/f*Cs(C)),$=$s(N/p*Cs(C));(S-=2*D)>As?(x+=D*=v?1:-1,E-=D):(S=0,x=E=(d+m)/2),(k-=2*$)>As?(b+=$*=v?1:-1,w-=$):(k=0,b=w=(d+m)/2)}var M=p*Es(b),O=p*Cs(b),R=f*Es(E),I=f*Cs(E);if(A>As){var P,L=p*Es(w),H=p*Cs(w),U=f*Es(x),B=f*Cs(x);if(g<Ts)if(P=function(t,e,n,r,i,a,s,o){var l=n-t,u=r-e,c=s-i,h=o-a,f=h*l-c*u;if(!(f*f<As))return[t+(f=(c*(e-a)-h*(t-i))/f)*l,e+f*u]}(M,O,U,B,L,H,R,I)){var q=M-P[0],F=O-P[1],Y=L-P[0],z=H-P[1],V=1/Cs(((h=(q*Y+F*z)/(Ns(q*q+F*F)*Ns(Y*Y+z*z)))>1?0:h<-1?Ts:Math.acos(h))/2),W=Ns(P[0]*P[0]+P[1]*P[1]);T=ks(A,(f-W)/(V-1)),j=ks(A,(p-W)/(V+1))}else T=j=0}k>As?j>As?(y=Ls(U,B,M,O,p,j,v),_=Ls(L,H,R,I,p,j,v),o.moveTo(y.cx+y.x01,y.cy+y.y01),j<A?o.arc(y.cx,y.cy,j,xs(y.y01,y.x01),xs(_.y01,_.x01),!v):(o.arc(y.cx,y.cy,j,xs(y.y01,y.x01),xs(y.y11,y.x11),!v),o.arc(0,0,p,xs(y.cy+y.y11,y.cx+y.x11),xs(_.cy+_.y11,_.cx+_.x11),!v),o.arc(_.cx,_.cy,j,xs(_.y11,_.x11),xs(_.y01,_.x01),!v))):(o.moveTo(M,O),o.arc(0,0,p,b,w,!v)):o.moveTo(M,O),f>As&&S>As?T>As?(y=Ls(R,I,L,H,f,-T,v),_=Ls(M,O,U,B,f,-T,v),o.lineTo(y.cx+y.x01,y.cy+y.y01),T<A?o.arc(y.cx,y.cy,T,xs(y.y01,y.x01),xs(_.y01,_.x01),!v):(o.arc(y.cx,y.cy,T,xs(y.y01,y.x01),xs(y.y11,y.x11),!v),o.arc(0,0,f,xs(y.cy+y.y11,y.cx+y.x11),xs(_.cy+_.y11,_.cx+_.x11),v),o.arc(_.cx,_.cy,T,xs(_.y11,_.x11),xs(_.y01,_.x01),!v))):o.arc(0,0,f,E,x,v):o.lineTo(R,I)}else o.moveTo(0,0);if(o.closePath(),u)return o=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Ts/2;return[Es(r)*n,Cs(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:bs(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:bs(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:bs(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:bs(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:bs(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:bs(+t),u):a},u.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:bs(+t),u):s},u.context=function(t){return arguments.length?(o=null==t?null:t,u):o},u}function Us(t,e,n){this.k=t,this.x=e,this.y=n}Us.prototype={constructor:Us,scale:function(t){return 1===t?this:new Us(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Us(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Us.prototype;var Bs=/\s/;var qs=function(t){for(var e=t.length;e--&&Bs.test(t.charAt(e)););return e},Fs=/^\s+/;var Ys=function(t){return t?t.slice(0,qs(t)+1).replace(Fs,""):t},zs=vt,Vs=it,Ws=/^[-+]0x[0-9a-f]+$/i,Xs=/^0b[01]+$/i,Gs=/^0o[0-7]+$/i,Js=parseInt;var Ks=function(t){if("number"==typeof t)return t;if(Vs(t))return NaN;if(zs(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=zs(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ys(t);var n=Xs.test(t);return n||Gs.test(t)?Js(t.slice(2),n?2:8):Ws.test(t)?NaN:+t},Zs=Ks,Qs=1/0;var to=function(t){return t?(t=Zs(t))===Qs||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var eo=function(t){var e=to(t),n=e%1;return e==e?n?e-n:e:0},no=Qt,ro=fn,io=it,ao=F?F.prototype:void 0,so=ao?ao.toString:void 0;var oo=function t(e){if("string"==typeof e)return e;if(ro(e))return no(e,t)+"";if(io(e))return so?so.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n},lo=oo;var uo=function(t){return null==t?"":lo(t)},co=eo,ho=Ks,fo=uo,po=q.isFinite,mo=Math.min;var go=n(function(t){var e=Math[t];return function(t,n){if(t=ho(t),(n=null==n?0:mo(co(n),292))&&po(t)){var r=(fo(t)+"e").split("e"),i=e(r[0]+"e"+(+r[1]+n));return+((r=(fo(i)+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round"));function vo(){const t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let n;return n=e<t?.45*e:.45*t,function(t){const e=document.getElementById("root-cell-tooltip");e&&e.setAttribute("style",`top:${.4*t}px; width:${.4*t}px; height:${.22*t}px; font-size: ${.004*t}em;`)}(n),n}function yo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.captures?t.captures:[e,t.simhash]}function _o(t){if(-1!==t.similarity)return`${t.name} - Differences: ${go(t.similarity,2)}%`}class bo extends d.Component{static propTypes=(()=>({simhashData:g.object,url:g.string,urlPrefix:g.string}))();state={hint:""};constructor(t){super(t),this.chartRef=d.createRef()}componentDidMount(){const{simhashData:t,urlPrefix:e,url:n}=this.props,r=vo(),i=vo(),a=Math.min(r,i)/2,s=oi(this.chartRef.current).attr("width",r).attr("height",i).append("g").attr("transform","translate("+r/2+","+i/2+")"),o=_s().size([2*Math.PI,a]),l=fs(t).sum((function(t){return 5}));o(l);const u=Hs().startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})).innerRadius((function(t){return t.y0})).outerRadius((function(t){return t.y1}));s.selectAll("path").data(l.descendants()).enter().append("path").attr("display",(function(t){return t.depth?null:"none"})).attr("d",u).style("stroke","#fff").style("fill",(function(t){return t.data.clr})).on("mouseover",(function(t,e){oi(this).style("cursor","pointer").style("stroke","black"),component.setState({hint:_o(e.data)})})).on("mouseleave",(function(t,e){oi(this).style("cursor","default").style("stroke",""),component.setState({hint:""})})).on("click",(function(n,r){if(r.data.timestamp!==t.timestamp){const n=e+r.data.timestamp+"/"+t.timestamp+"/"+n;window.open(n,"_blank")}}))}render(){return d.createElement(d.Fragment,null,d.createElement("p",{className:"text-center",style:{marginTop:"10px"}},this.state.hint,"  "),d.createElement("div",{className:"text-center"},d.createElement("svg",{ref:this.chartRef})))}}var wo={exports:{}};wo.exports=function(){function t(t){return t.slice().sort((function(t,e){return t-e}))}function e(t){for(var e,n=0,r=0;r<t.length;r++)0!==r&&t[r]===e||(e=t[r],n++);return n}function n(t,e){for(var n=[],r=0;r<t;r++){for(var i=[],a=0;a<e;a++)i.push(0);n.push(i)}return n}function r(t,e,n,r){var i;if(t>0){var a=(n[e]-n[t-1])/(e-t+1);i=r[e]-r[t-1]-(e-t+1)*a*a}else i=r[e]-n[e]*n[e]/(e+1);return i<0?0:i}function i(t,e,n,a,s,o,l){if(!(t>e)){var u=Math.floor((t+e)/2);a[n][u]=a[n-1][u-1],s[n][u]=u;var c=n;t>n&&(c=Math.max(c,s[n][t-1]||0)),c=Math.max(c,s[n-1][u]||0);var h,f,p,d=u-1;e<a.length-1&&(d=Math.min(d,s[n][e+1]||0));for(var m=d;m>=c&&!((h=r(m,u,o,l))+a[n-1][c-1]>=a[n][u]);--m)(f=r(c,u,o,l)+a[n-1][c-1])<a[n][u]&&(a[n][u]=f,s[n][u]=c),c++,(p=h+a[n-1][m-1])<a[n][u]&&(a[n][u]=p,s[n][u]=m);i(t,u-1,n,a,s,o,l),i(u+1,e,n,a,s,o,l)}}function a(t,e,n){for(var a=e[0].length,s=new Array(a),o=new Array(a),l=t[Math.floor(a/2)],u=0;u<a;++u)0===u?(s[0]=t[0]-l,o[0]=(t[0]-l)*(t[0]-l)):(s[u]=s[u-1]+t[u]-l,o[u]=o[u-1]+(t[u]-l)*(t[u]-l)),e[0][u]=r(0,u,s,o),n[0][u]=0;for(var c=1;c<e.length;++c)i(c<e.length-1?c:a-1,a-1,c,e,n,s,o)}function s(r,i){if(i>r.length)throw new Error("Cannot generate more classes than there are data values");var s=r.length,o=t(r),l=e(o);if(1===l)return[o];var u=n(i=Math.min(l,i),s),c=n(i,s);a(o,u,c);for(var h=[],f=c[0].length-1,p=c.length-1;p>=0;p--){var d=c[p][f];h[p]=o[d],p>0&&(f=d-1)}return h}var o=s;function l(){var t=!1,e=[],n=[],r=[],i=function(e){if(t){for(var i=r.length-1;i>=0;i--)if(e>=r[i])return n[i];return n[0]}};function a(){if(!(n.length<=2)){var i=o(e,Math.min(e.length,n.length));t=0!==i.length,r=[];for(var a=0;a<i.length;a++)r.push(i[a])}}return i.domain=function(){return arguments.length?(e=arguments[0],a(),i):e},i.range=function(){if(arguments.length){var t=arguments[0],e=t.length!==n.length;return n=t,e&&a(),i}return n},i.invertExtent=function(t){for(var e=NaN,i=NaN,a=0;a<n.length;a++)if(n[a]===t){e=r[a],i=a+1<n.length?r[a+1]:NaN;break}return[e,i]},i.clusters=function(){return r.slice(1)},i.export=function(){return{isReady:t,domain:e,range:n,breakpoints:r}},i.import=function(a){if(!a)throw new Error("Import requires parameters");return t=a.isReady,e=a.domain,n=a.range,r=a.breakpoints,i},i.copy=function(){return l().domain(e).range(n)},i}return"object"==typeof d3&&(d3.scaleCluster=l),l}();var xo=n(wo.exports);v(".heat-map-legend-bar{margin:0 1px;transition:height .2s;width:10px}.heat-map-legend-summary{align-items:center;display:flex;height:20px}.heat-map-legend{align-items:baseline;align-self:flex-end;display:flex;float:right;font-size:12px}.heat-map-legend-summary-min-caption{text-align:right;width:32px}.heat-map-legend-caption{margin:0 8px}.heat-map-legend-summary-graphics{display:flex;height:20px;margin:0 8px}.sunburst-container{margin:auto;width:50%}.rv-sunburst{margin:0 auto}#calcButton{display:block;margin-left:auto;margin-right:auto}.rv-sunburst__series--radial__arc,.rv-xy-plot__series,.rv-xy-plot__series--arc-path{cursor:pointer}#root-cell-tooltip{display:inline-block;left:0;margin:auto;position:absolute;right:0;text-align:center;z-index:10}.rv-hint{z-index:10}");var Eo=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t},So=hn,ko=fn,Co=F?F.isConcatSpreadable:void 0;var No=Eo,Ao=function(t){return ko(t)||So(t)||!!(Co&&t&&t[Co])};var To=function t(e,n,r,i,a){var s=-1,o=e.length;for(r||(r=Ao),a||(a=[]);++s<o;){var l=e[s];n>0&&r(l)?n>1?t(l,n-1,r,i,a):No(a,l):i||(a[a.length]=l)}return a},jo=fn,Do=it,$o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mo=/^\w*$/;var Oo=function(t,e){if(jo(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Do(t))||(Mo.test(t)||!$o.test(t)||null!=e&&t in Object(e))},Ro=Ht(Object,"create"),Io=Ro;var Po=function(){this.__data__=Io?Io(null):{},this.size=0};var Lo=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Ho=Ro,Uo=Object.prototype.hasOwnProperty;var Bo=function(t){var e=this.__data__;if(Ho){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Uo.call(e,t)?e[t]:void 0},qo=Ro,Fo=Object.prototype.hasOwnProperty;var Yo=Ro;var zo=Po,Vo=Lo,Wo=Bo,Xo=function(t){var e=this.__data__;return qo?void 0!==e[t]:Fo.call(e,t)},Go=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Yo&&void 0===e?"__lodash_hash_undefined__":e,this};function Jo(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Jo.prototype.clear=zo,Jo.prototype.delete=Vo,Jo.prototype.get=Wo,Jo.prototype.has=Xo,Jo.prototype.set=Go;var Ko=Jo;var Zo=function(){this.__data__=[],this.size=0};var Qo=function(t,e){return t===e||t!=t&&e!=e},tl=Qo;var el=function(t,e){for(var n=t.length;n--;)if(tl(t[n][0],e))return n;return-1},nl=el,rl=Array.prototype.splice;var il=el;var al=el;var sl=el;var ol=Zo,ll=function(t){var e=this.__data__,n=nl(e,t);return!(n<0)&&(n==e.length-1?e.pop():rl.call(e,n,1),--this.size,!0)},ul=function(t){var e=this.__data__,n=il(e,t);return n<0?void 0:e[n][1]},cl=function(t){return al(this.__data__,t)>-1},hl=function(t,e){var n=this.__data__,r=sl(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function fl(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}fl.prototype.clear=ol,fl.prototype.delete=ll,fl.prototype.get=ul,fl.prototype.has=cl,fl.prototype.set=hl;var pl=fl,dl=Ko,ml=pl,gl=Pe;var vl=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var yl=function(t,e){var n=t.__data__;return vl(e)?n["string"==typeof e?"string":"hash"]:n.map},_l=yl;var bl=yl;var wl=yl;var xl=yl;var El=function(){this.size=0,this.__data__={hash:new dl,map:new(gl||ml),string:new dl}},Sl=function(t){var e=_l(this,t).delete(t);return this.size-=e?1:0,e},kl=function(t){return bl(this,t).get(t)},Cl=function(t){return wl(this,t).has(t)},Nl=function(t,e){var n=xl(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function Al(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Al.prototype.clear=El,Al.prototype.delete=Sl,Al.prototype.get=kl,Al.prototype.has=Cl,Al.prototype.set=Nl;var Tl=Al,jl=Tl;function Dl(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var s=t.apply(this,r);return n.cache=a.set(i,s)||a,s};return n.cache=new(Dl.Cache||jl),n}Dl.Cache=jl;var $l=Dl;var Ml=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ol=/\\(\\)?/g,Rl=function(t){var e=$l(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Ml,(function(t,n,r,i){e.push(r?i.replace(Ol,"$1"):n||t)})),e})),Il=fn,Pl=Oo,Ll=Rl,Hl=uo;var Ul=function(t,e){return Il(t)?t:Pl(t,e)?[t]:Ll(Hl(t))},Bl=it;var ql=function(t){if("string"==typeof t||Bl(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},Fl=Ul,Yl=ql;var zl=function(t,e){for(var n=0,r=(e=Fl(e,t)).length;null!=t&&n<r;)t=t[Yl(e[n++])];return n&&n==r?t:void 0},Vl=pl;var Wl=pl,Xl=Pe,Gl=Tl;var Jl=pl,Kl=function(){this.__data__=new Vl,this.size=0},Zl=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Ql=function(t){return this.__data__.get(t)},tu=function(t){return this.__data__.has(t)},eu=function(t,e){var n=this.__data__;if(n instanceof Wl){var r=n.__data__;if(!Xl||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Gl(r)}return n.set(t,e),this.size=n.size,this};function nu(t){var e=this.__data__=new Jl(t);this.size=e.size}nu.prototype.clear=Kl,nu.prototype.delete=Zl,nu.prototype.get=Ql,nu.prototype.has=tu,nu.prototype.set=eu;var ru=nu;var iu=Tl,au=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},su=function(t){return this.__data__.has(t)};function ou(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new iu;++e<n;)this.add(t[e])}ou.prototype.add=ou.prototype.push=au,ou.prototype.has=su;var lu=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1};var uu=ou,cu=lu,hu=function(t,e){return t.has(e)};var fu=function(t,e,n,r,i,a){var s=1&n,o=t.length,l=e.length;if(o!=l&&!(s&&l>o))return!1;var u=a.get(t),c=a.get(e);if(u&&c)return u==e&&c==t;var h=-1,f=!0,p=2&n?new uu:void 0;for(a.set(t,e),a.set(e,t);++h<o;){var d=t[h],m=e[h];if(r)var g=s?r(m,d,h,e,t,a):r(d,m,h,t,e,a);if(void 0!==g){if(g)continue;f=!1;break}if(p){if(!cu(e,(function(t,e){if(!hu(p,e)&&(d===t||i(d,t,n,r,a)))return p.push(e)}))){f=!1;break}}else if(d!==m&&!i(d,m,n,r,a)){f=!1;break}}return a.delete(t),a.delete(e),f};var pu=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},du=q.Uint8Array,mu=Qo,gu=fu,vu=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n},yu=pu,_u=F?F.prototype:void 0,bu=_u?_u.valueOf:void 0;var wu=function(t,e,n,r,i,a,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new du(t),new du(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return mu(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var o=vu;case"[object Set]":var l=1&r;if(o||(o=yu),t.size!=e.size&&!l)return!1;var u=s.get(t);if(u)return u==e;r|=2,s.set(t,e);var c=gu(o(t),o(e),r,i,a,s);return s.delete(t),c;case"[object Symbol]":if(bu)return bu.call(t)==bu.call(e)}return!1},xu=Eo,Eu=fn;var Su=function(t,e,n){var r=e(t);return Eu(t)?r:xu(r,n(t))};var ku=Zt,Cu=function(){return[]},Nu=Object.prototype.propertyIsEnumerable,Au=Object.getOwnPropertySymbols,Tu=Au?function(t){return null==t?[]:(t=Object(t),ku(Au(t),(function(e){return Nu.call(t,e)})))}:Cu,ju=/^(?:0|[1-9]\d*)$/;var Du=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&ju.test(t))&&t>-1&&t%1==0&&t<e},$u=ee,Mu=hn,Ou=fn,Ru=mn,Iu=Du,Pu=Nn,Lu=Object.prototype.hasOwnProperty;var Hu=function(t,e){var n=Ou(t),r=!n&&Mu(t),i=!n&&!r&&Ru(t),a=!n&&!r&&!i&&Pu(t),s=n||r||i||a,o=s?$u(t.length,String):[],l=o.length;for(var u in t)!e&&!Lu.call(t,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Iu(u,l))||o.push(u);return o},Uu=Re,Bu=ae;var qu=function(t){return Bu(t)?Hu(t):Uu(t)},Fu=Su,Yu=Tu,zu=qu;var Vu=function(t){return Fu(t,zu,Yu)},Wu=Object.prototype.hasOwnProperty;var Xu=ru,Gu=fu,Ju=wu,Ku=function(t,e,n,r,i,a){var s=1&n,o=Vu(t),l=o.length;if(l!=Vu(e).length&&!s)return!1;for(var u=l;u--;){var c=o[u];if(!(s?c in e:Wu.call(e,c)))return!1}var h=a.get(t),f=a.get(e);if(h&&f)return h==e&&f==t;var p=!0;a.set(t,e),a.set(e,t);for(var d=s;++u<l;){var m=t[c=o[u]],g=e[c];if(r)var v=s?r(g,m,c,e,t,a):r(m,g,c,t,e,a);if(!(void 0===v?m===g||i(m,g,n,r,a):v)){p=!1;break}d||(d="constructor"==c)}if(p&&!d){var y=t.constructor,_=e.constructor;y==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(p=!1)}return a.delete(t),a.delete(e),p},Zu=nn,Qu=fn,tc=mn,ec=Nn,nc="[object Arguments]",rc="[object Array]",ic="[object Object]",ac=Object.prototype.hasOwnProperty;var sc=function(t,e,n,r,i,a){var s=Qu(t),o=Qu(e),l=s?rc:Zu(t),u=o?rc:Zu(e),c=(l=l==nc?ic:l)==ic,h=(u=u==nc?ic:u)==ic,f=l==u;if(f&&tc(t)){if(!tc(e))return!1;s=!0,c=!1}if(f&&!c)return a||(a=new Xu),s||ec(t)?Gu(t,e,n,r,i,a):Ju(t,e,l,n,r,i,a);if(!(1&n)){var p=c&&ac.call(t,"__wrapped__"),d=h&&ac.call(e,"__wrapped__");if(p||d){var m=p?t.value():t,g=d?e.value():e;return a||(a=new Xu),i(m,g,n,r,a)}}return!!f&&(a||(a=new Xu),Ku(t,e,n,r,i,a))},oc=et;var lc=function t(e,n,r,i,a){return e===n||(null==e||null==n||!oc(e)&&!oc(n)?e!=e&&n!=n:sc(e,n,r,i,t,a))},uc=ru,cc=lc;var hc=vt;var fc=function(t){return t==t&&!hc(t)},pc=fc,dc=qu;var mc=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}},gc=function(t,e,n,r){var i=n.length,a=i,s=!r;if(null==t)return!a;for(t=Object(t);i--;){var o=n[i];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<a;){var l=(o=n[i])[0],u=t[l],c=o[1];if(s&&o[2]){if(void 0===u&&!(l in t))return!1}else{var h=new uc;if(r)var f=r(u,c,l,t,e,h);if(!(void 0===f?cc(c,u,3,r,h):f))return!1}}return!0},vc=function(t){for(var e=dc(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,pc(i)]}return e},yc=mc;var _c=zl;var bc=Ul,wc=hn,xc=fn,Ec=Du,Sc=ne,kc=ql;var Cc=function(t,e){return null!=t&&e in Object(t)},Nc=function(t,e,n){for(var r=-1,i=(e=bc(e,t)).length,a=!1;++r<i;){var s=kc(e[r]);if(!(a=null!=t&&n(t,s)))break;t=t[s]}return a||++r!=i?a:!!(i=null==t?0:t.length)&&Sc(i)&&Ec(s,i)&&(xc(t)||wc(t))};var Ac=lc,Tc=function(t,e,n){var r=null==t?void 0:_c(t,e);return void 0===r?n:r},jc=function(t,e){return null!=t&&Nc(t,e,Cc)},Dc=Oo,$c=fc,Mc=mc,Oc=ql;var Rc=zl;var Ic=te,Pc=function(t){return function(e){return Rc(e,t)}},Lc=Oo,Hc=ql;var Uc=function(t){var e=vc(t);return 1==e.length&&e[0][2]?yc(e[0][0],e[0][1]):function(n){return n===t||gc(n,t,e)}},Bc=function(t,e){return Dc(t)&&$c(e)?Mc(Oc(t),e):function(n){var r=Tc(n,t);return void 0===r&&r===e?jc(n,t):Ac(e,r,3)}},qc=ot,Fc=fn,Yc=function(t){return Lc(t)?Ic(Hc(t)):Pc(t)};var zc=function(t){return"function"==typeof t?t:null==t?qc:"object"==typeof t?Fc(t)?Bc(t[0],t[1]):Uc(t):Yc(t)};var Vc=function(t){return function(e,n,r){for(var i=-1,a=Object(e),s=r(e),o=s.length;o--;){var l=s[t?o:++i];if(!1===n(a[l],l,a))break}return e}}(),Wc=qu;var Xc=ae;var Gc=function(t,e){return function(n,r){if(null==n)return n;if(!Xc(n))return t(n,r);for(var i=n.length,a=e?i:-1,s=Object(n);(e?a--:++a<i)&&!1!==r(s[a],a,s););return n}}((function(t,e){return t&&Vc(t,e,Wc)})),Jc=ae;var Kc=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t},Zc=it;var Qc=function(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t==t,a=Zc(t),s=void 0!==e,o=null===e,l=e==e,u=Zc(e);if(!o&&!u&&!a&&t>e||a&&s&&l&&!o&&!u||r&&s&&l||!n&&l||!i)return 1;if(!r&&!a&&!u&&t<e||u&&n&&i&&!r&&!a||o&&n&&i||!s&&i||!l)return-1}return 0};var th=Qt,eh=zl,nh=zc,rh=function(t,e){var n=-1,r=Jc(t)?Array(t.length):[];return Gc(t,(function(t,i,a){r[++n]=e(t,i,a)})),r},ih=Kc,ah=wn,sh=function(t,e,n){for(var r=-1,i=t.criteria,a=e.criteria,s=i.length,o=n.length;++r<s;){var l=Qc(i[r],a[r]);if(l)return r>=o?l:l*("desc"==n[r]?-1:1)}return t.index-e.index},oh=ot,lh=fn;var uh=Qo,ch=ae,hh=Du,fh=vt;var ph=To,dh=function(t,e,n){e=e.length?th(e,(function(t){return lh(t)?function(e){return eh(e,1===t.length?t[0]:t)}:t})):[oh];var r=-1;e=th(e,ah(nh));var i=rh(t,(function(t,n,i){return{criteria:th(e,(function(e){return e(t)})),index:++r,value:t}}));return ih(i,(function(t,e){return sh(t,e,n)}))},mh=function(t,e,n){if(!fh(n))return!1;var r=typeof e;return!!("number"==r?ch(n)&&hh(e,n.length):"string"==r&&e in n)&&uh(n[e],t)},gh=n(Kt((function(t,e){if(null==t)return[];var n=e.length;return n>1&&mh(t,e[0],e[1])?e=[]:n>2&&mh(e[0],e[1],e[2])&&(e=[e[0]]),dh(t,ph(e,1),[])})));const vh={backgroundColor:"rgb(241, 231, 119)",height:"4px"},yh={backgroundColor:"rgb(197, 213, 108)",height:"6px"},_h={backgroundColor:"rgb(159, 197, 99)",height:"8px"},bh={backgroundColor:"rgb(141, 184, 101)",height:"10px"},wh={backgroundColor:"rgb(107, 151, 117)",height:"12px"};class xh extends d.Component{static displayName="SunburstContainer";static propTypes=(()=>({timestamp:g.string.isRequired,url:g.string.isRequired,conf:g.object.isRequired,loader:g.element}))();constructor(t){super(t),this.state={isUpdate:0,isPending:!1,simhashData:null},this._clusters=[]}componentDidUpdate(){this.state.isUpdate<2&&(vo(),this.setState({isUpdate:this.state.isUpdate+1}))}render(){const{url:t,conf:e}=this.props;if(this.state.error)return d.createElement(qn,{url:t,code:this.state.error,timestamp:this.state.timestamp?this.state.timestamp:this.props.timestamp,conf:e,errorHandledCallback:this.errorHandled});if(this.state.simhashData)return d.createElement("div",{className:"sunburst-container"},this.state.isPending&&d.createElement("p",null,"The Simhash data for ",t," and year ",this.state.timestamp.substring(0,4)," are still being generated. For more results please try again in a moment."),d.createElement("div",null,"This diagram illustrates the differences of ",d.createElement("a",{href:`/web/*/${t}`},t)," capture ",d.createElement("a",{href:e.snapshotsPrefix+this.state.timestamp+"/"+t},ke(this.state.timestamp))," compared to"," ",this.state.countCaptures," other captures of the same URL for ",this.state.timestamp.substring(0,4),"."),d.createElement(bo,{urlPrefix:e.urlPrefix,url:t,simhashData:this.state.simhashData}),d.createElement("div",{style:{clear:"both"}},d.createElement("div",{className:"heat-map-legend"},d.createElement("div",{className:"heat-map-legend-caption"},"Variation"),d.createElement("div",{className:"heat-map-legend-summary"},d.createElement("div",{className:"heat-map-legend-summary-min-caption"},"Low"),d.createElement("div",{className:"heat-map-legend-summary-graphics"},d.createElement("div",{className:"heat-map-legend-bar",style:vh}),d.createElement("div",{className:"heat-map-legend-bar",style:yh}),d.createElement("div",{className:"heat-map-legend-bar",style:_h}),d.createElement("div",{className:"heat-map-legend-bar",style:bh}),d.createElement("div",{className:"heat-map-legend-bar",style:wh})),d.createElement("div",{className:"heat-map-legend-summary-max-caption"},"High")))));const n=()=>S(this.props.loader)?d.createElement(k,null):this.props.loader;return this.state.timestamp?this._fetchTimestampSimhashData():this._validateTimestamp(),d.createElement("div",{className:"loading"},d.createElement(n,null))}_validateTimestamp(){const{url:t,conf:e,timestamp:n}=this.props,r=new URL(e.cdxServer,window.location.origin);r.searchParams.append("url",t),r.searchParams.append("closest",n),r.searchParams.append("filter","!mimetype:warc/revisit"),r.searchParams.append("sort","closest"),r.searchParams.append("limit","1"),r.searchParams.append("fl","timestamp"),xe(r).then(be).then((t=>t.json())).then((r=>{const i=r.toString(),a=n!==i?i:n,s=`${e.diffgraphPrefix}${i}/${t}`;window.history.pushState({},"",s),this.setState({timestamp:a})})).catch((t=>{"Unexpected end of JSON input"===t.message?this.errorHandled("NO_CAPTURES"):this.errorHandled(t.message)}))}errorHandled(t){this.setState({error:t})}_fetchTimestampSimhashData(){const{url:t,conf:e}=this.props;xe(e.waybackDiscoverDiff+"/simhash?url="+encodeURIComponent(t)+"&timestamp="+this.state.timestamp).then(be).then((t=>t.json())).then((t=>{if(t.status)throw Error(t.message);this._fetchSimhashData(yo(t,this.state.timestamp))})).catch((t=>{this.errorHandled(t.message)}))}_fetchSimhashData(t){const{url:e,conf:n}=this.props;let r=n.waybackDiscoverDiff+"/simhash?url="+encodeURIComponent(e)+"&year="+this.state.timestamp.substring(0,4);n.compressedSimhash&&(r+="&compress=1"),xe(r).then(be).then((t=>t.json())).then((e=>{this.setState({isPending:"PENDING"===e.status});const r=n.compressedSimhash?function(t){const e=[],n=t.captures[0][0];for(let r=1;r<t.captures[0].length;r++){const i=t.captures[0][r][0];for(let a=1;a<t.captures[0][r].length;a++){const s=t.captures[0][r][a][0];for(let o=1;o<t.captures[0][r][a].length;o++){const[l,u]=t.captures[0][r][a][o],c=t.hashes[u],h=`${n}${Ee(i)}${Ee(s)}${l}`;e.push([h,c])}}}return e}(e):yo(e),i=this._calcDistanceAndScales(r,t);Pn(i)||this._createLevels(i,t)})).catch((t=>{this.errorHandled(t.message)}))}_calcDistanceAndScales(t,e){const n=t.map((t=>{const n=ye(e[1],t[1]);return t[1]=100*n,0!==n?100*n:null})).filter(Boolean);if(0!==n.length){for(this.setState({countCaptures:n.length}),this._clusters=xo().domain(n).range([1,2,3,4,5]).clusters();this._clusters.length<5;)this._clusters.push(101);return t}this.errorHandled("NO_DIFFERENT_CAPTURES")}_createLevels(t,e){let n=[],r=[],i=[],a=[],s=[];const o=["#dddddd","#f1e777","#c5d56c","#8db865","#6b9775","#4d7a83"];for(let e=0;e<t.length;e++)0!==t[e][1]&&(t[e][1]<=this._clusters[0]?n.push({name:ke(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:o[1],children:[]}):t[e][1]<=this._clusters[1]?r.push({name:ke(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:o[2],children:[]}):t[e][1]<=this._clusters[2]?i.push({name:ke(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:o[3],children:[]}):t[e][1]<=this._clusters[3]?a.push({name:ke(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:o[4],children:[]}):t[e][1]<=this._clusters[4]&&s.push({name:ke(t[e][0]),timestamp:t[e][0],similarity:t[e][1],clr:o[5],children:[]}));let l=4;for(;0===n.length&&l>0;)n=r,r=i,i=a,a=s,s=[],l-=1;for(l=3;0===r.length&&l>0;)r=i,i=a,a=s,s=[],l-=1;for(l=2;0===i.length&&l>0;)i=a,a=s,s=[],l-=1;0===a.length&&(a=s,s=[]),n=gh(n,[function(t){return t.timestamp}]),r=gh(r,[function(t){return t.timestamp}]),i=gh(i,[function(t){return t.timestamp}]),a=gh(a,[function(t){return t.timestamp}]),s=gh(s,[function(t){return t.timestamp}]),n.length>this.props.conf.maxSunburstLevelLength&&(n.length=this.props.conf.maxSunburstLevelLength),r.length>this.props.conf.maxSunburstLevelLength&&(r.length=this.props.conf.maxSunburstLevelLength),i.length>this.props.conf.maxSunburstLevelLength&&(i.length=this.props.conf.maxSunburstLevelLength),a.length>this.props.conf.maxSunburstLevelLength&&(a.length=this.props.conf.maxSunburstLevelLength),s.length>this.props.conf.maxSunburstLevelLength&&(s.length=this.props.conf.maxSunburstLevelLength);for(let t=0;t<s.length;t++){const e=t%a.length;a[e].children.push(s[t]),a[e].bigness=""}for(let t=0;t<a.length;t++){const e=t%i.length;i[e].children.push(a[t]),i[e].bigness=""}for(let t=0;t<i.length;t++){const e=t%r.length;r[e].children.push(i[t]),r[e].bigness=""}for(let t=0;t<r.length;t++){const e=t%n.length;n[e].children.push(r[t]),n[e].bigness=""}this.setState({simhashData:{name:ke(e[0]),timestamp:e[0],clr:o[0],children:n,similarity:-1}})}}export{Fn as DiffContainer,xh as SunburstContainer};
//# sourceMappingURL=app.js.map
